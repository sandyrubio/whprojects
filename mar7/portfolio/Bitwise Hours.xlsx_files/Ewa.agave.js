/*! Version=16.0.9213.5051 */
Type.registerNamespace("Common.App.AppsForOffice");Common.App.AppsForOffice.n=function(){};Common.App.AppsForOffice.n.registerInterface("Common.App.AppsForOffice.n");Common.App.AppsForOffice.o=function(){};Common.App.AppsForOffice.o.registerInterface("Common.App.AppsForOffice.o");Common.App.AppsForOffice.m=function(){};Common.App.AppsForOffice.q=function(){};Common.App.AppsForOffice.p=function(){};Common.App.AppsForOffice.p.registerInterface("Common.App.AppsForOffice.p");Common.App.AppsForOffice.c=function(n,t,i){this.e=n;this.b=t;this.d=i;this.c=OfficeExt.CommandInvokeMode.Default};Common.App.AppsForOffice.c.prototype={e:0,b:null,d:null,c:0,a:function(n,t,i){i=i||{};i.commandMode=this.c;var r=this;t.a(this.b,this.d,i,function(t,i){n.a(r.e,r.b,t,i)})}};Common.App.AppsForOffice.g=function(){};Common.App.AppsForOffice.g.prototype={b:function(n,t){var i=null;switch(n){case 1:i=new Common.App.AppsForOffice.h(t,this.a().getNativeActionName(n));break;case 2:i=new Common.App.AppsForOffice.c(2,t,this.a().getNativeActionName(n));break;case 3:i=new Common.App.AppsForOffice.c(3,t,this.a().getNativeActionName(n))}return i},a:function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}};Common.App.AppsForOffice.h=function(n,t){Common.App.AppsForOffice.h.initializeBase(this,[1,n,t]);this.c=OfficeExt.CommandInvokeMode.ExclusiveForNew};Common.App.AppsForOffice.b=function(){};Common.App.AppsForOffice.b.b=function(){return Common.App.AppsForOffice.b.a||(Common.App.AppsForOffice.b.a=new Common.App.AppsForOffice.b),Common.App.AppsForOffice.b.a};Common.App.AppsForOffice.b.prototype={a:function(n,t,i,r){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(n,t,i,r)}};Common.App.AppsForOffice.i=function(n,t,i){this.K=new Common.K;this.Q=new Common.App.AppsForOffice.g;Common.App.AppsForOffice.i.initializeBase(this);this.g(5);this.c=i;this.e=n;this.d=t};Common.App.AppsForOffice.i.prototype={b:null,bf:"WACDialogTitleText",Z:"0",X:"15px",Y:"0px",R:"calc(100% - 30px)",S:"100%",e:0,d:0,c:null,P:0,bg:function(n){this.K.o("OnDialogClosedEventKey",n)},v:function(){CommonUI.b.prototype.v.call(this);this.u.style.width="100%";this.u.style.height=this.bl?this.R:this.S;this.u.style.marginTop=this.bl?this.X:this.Y;this.u.style.padding=this.Z},w:function(){CommonUI.b.prototype.w.call(this);this.f.style.width=String.format("{0}px",this.e*window.innerWidth/100);this.f.style.height=String.format("{0}px",this.d*window.innerHeight/100);this.f.style.minWidth="0px";this.b=document.getElementById(this.h+this.bf);this.b.style.position="absolute";this.b.style.whiteSpace="nowrap";this.b.style.textOverflow="ellipsis";Common.a.f?(this.b.style.right="14px",this.b.style.left="44px"):(this.b.style.right="44px",this.b.style.left="14px")},B:function(n){CommonUI.b.prototype.B.call(this,n);this.b&&this.b.setAttribute("title",n)},cH:function(){this.f.style.width=String.format("{0}px",this.e*window.innerWidth/100);this.f.style.height=String.format("{0}px",this.d*window.innerHeight/100);this.f.style.overflowY="hidden";this.f.style.overflowX="hidden";this.f.style.marginTop="";this.f.style.top="";Common.c.d()&&Common.a.f?(this.f.style.right="",this.f.style.marginRight=""):(this.f.style.left="",this.f.style.marginLeft="")},i:function(){var t=this.Q.b(3,this.c),n;t.a(this,Common.App.AppsForOffice.b.b(),{});n=this;this.P=window.setTimeout(function(){n.K.m("OnDialogClosedEventKey",n.c,null);CommonUI.c.prototype.i.call(n)},500)},a:function(n){n===3&&(window.clearTimeout(this.P),this.K.m("OnDialogClosedEventKey",this.c,null),CommonUI.c.prototype.i.call(this))}};Common.App.AppsForOffice.AppsForOfficeDialogManager=function(n){this.g=Function.createDelegate(this,this.j);this.f=new Common.K;this.e=n};Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance=function(n){return Common.App.AppsForOffice.AppsForOfficeDialogManager.b||(Common.App.AppsForOffice.AppsForOfficeDialogManager.b=new Common.App.AppsForOffice.AppsForOfficeDialogManager(n)),Common.App.AppsForOffice.AppsForOfficeDialogManager.b};Common.App.AppsForOffice.AppsForOfficeDialogManager.prototype={e:null,a:function(n){this.f.o("OnMessageParentEventKey",n)},d:function(n,t,i,r){var f,h,u,o,e;if(Common.App.AppsForOffice.AppsForOfficeDialogManager.a.b(t)){Diag.a.a(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}try{if(f=JSON.parse(n),h=f.url,!this.e.getOsfControl(t).checkAppDomains(h)){Diag.a.a(19940611,344,10,"ShowDialog: dialog url not in app domains list.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains);return}u=new Common.App.AppsForOffice.l;u.e=f.width;u.c=f.height;u.d=h;u.g=f.displayInIframe;u.f=f.hideTitle;u.a=t;u.b=Common.V.a().a;Diag.a.a(18371103,344,50,"ShowDialog: asset id {0}, url hash code {1}",this.e.getOsfControl(t).getMarketplaceID(),Common.d.d(u.d));o=new Common.App.AppsForOffice.d;o.b=u.b;var c=this.e.getOsfControl(u.a).getManifest().getDefaultDisplayName(),l=this.e.getOsfControl(u.a).getStoreType().toLowerCase(),s=null;s=Common.a.a().a().c()===4&&l==="hardcodedpreinstall"&&u.f?this.createAndShowAppsForOfficeDialog(u.e,u.c,u.b,!0,c):this.createAndShowAppsForOfficeDialog(u.e,u.c,u.b,!1,c);e=this.i(this.e.getOsfControl(u.a).getManifest(),u.b,u.d);e.agaveName=c;e.div=s.u;this.e.insertDialogControl(e);s.bg(this.g);o.a=s;Common.App.AppsForOffice.AppsForOfficeDialogManager.a.c(u.a,o);r&&r(e);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(a){Diag.a.a(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",a.message);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},c:function(n,t){try{var i=this.h(n);i&&this.f.m("OnMessageParentEventKey",new Common.App.AppsForOffice.e(i,OSF.DialogMessageType.DialogMessageReceived,t),null)}catch(r){return Diag.a.a(18371105,344,10,"MessageParent: action failed. Exception message: {0}",r.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},b:function(n,t){if(!Common.App.AppsForOffice.AppsForOfficeDialogManager.a.b(n)){Diag.a.a(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control.");t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}try{var i=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.a(n);i.a&&i.a.i();this.e.purgeDialogControl(i.b);Common.App.AppsForOffice.AppsForOfficeDialogManager.a.d(n);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(r){Diag.a.a(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",r.message);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},h:function(n){for(var i=null,r=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.$$ge(),t;r.$$mn();)if(t=r.$$cu(),t.a.b===n){i=t.b;break}return i},j:function(n,t){var i=this.h(t);i&&(this.e.purgeDialogControl(t),Common.App.AppsForOffice.AppsForOfficeDialogManager.a.d(i),this.f.m("OnMessageParentEventKey",new Common.App.AppsForOffice.e(i,OSF.DialogMessageType.DialogClosed,null),null))},createAndShowAppsForOfficeDialog:function(n,t,i,r,u){var f=new Common.App.AppsForOffice.i(n,t,i),e=r?"":String.format($a.eL,u);return r&&(f.bl=!1,f.D=!1),f.t(e,null,null),f.bn=null,f},i:function(n,t,i){var r={};return r.id=t,r.marketplaceID=t,r.marketplaceVersion=n.getMarketplaceVersion(),r.appDomains=n.getAppDomains(),r.store="developer",r.storeType=OSF.StoreType.InMemory,r.dialogUrl=i,r.osfControlType=OSF.OsfControlTarget.TaskPane,r}};Common.App.AppsForOffice.j=function(){Common.App.AppsForOffice.j.initializeBase(this);this.g(5)};Common.App.AppsForOffice.j.prototype={a:null,Q:"WACDialogBodyPanel",K:"695px",c:"calc(100% - 30px)",d:"15px",e:"0",R:"WACDialogPanel",b:695,S:462,P:"80%",v:function(){CommonUI.b.prototype.v.call(this);this.a=document.getElementById(this.Q);this.a.style.width=this.K;this.a.style.height=this.c;this.a.style.marginTop=this.d;this.a.style.padding=this.e},bM:function(){this.a.style.width=this.K;this.a.style.height=this.c;this.a.style.marginTop=this.d;this.a.style.padding=this.e;this.b>window.document.documentElement.clientWidth?(this.f.style.width=String.format("{0}px",window.document.documentElement.clientWidth),this.f.style.overflowX="scroll",this.f.style.left="0"):(this.f.style.width=String.format("{0}px",this.b),this.f.style.overflowX="hidden");this.f.offsetHeight>window.document.documentElement.clientHeight||this.S+50>window.document.documentElement.clientHeight?(this.f.style.height=String.format("{0}px",window.document.documentElement.clientHeight),this.f.style.overflowY="scroll",this.f.style.top="0",this.f.style.left="0",this.f.style.marginTop="-50px"):(this.f.style.overflowY="hidden",this.f.style.top="10%",this.f.style.height=this.P);this.bX()},bX:function(){var t,n;if(!this.f){Diag.a.a(19976784,306,10,"_divMessageBox is null in CenterDialog()");return}t=this.f.style.zIndex;this.f.style.zIndex=-9999;this.b>window.document.documentElement.clientWidth?Common.c.d()&&Common.a.f?this.f.style.marginRight="0":this.f.style.marginLeft="0":(n=String.format("{0}px",Math.floor(-this.f.offsetWidth/2)),Common.c.d()&&Common.a.f?this.f.style.marginRight=n:this.f.style.marginLeft=n,Common.c.d()&&Common.a.f?this.f.style.right="50%":this.f.style.left="50%");this.f.style.zIndex=t},w:function(){CommonUI.b.prototype.w.call(this);var n=document.getElementById(this.h+this.R);n.style.width=String.format("{0}px",this.b);n.style.height=this.P}};Common.App.AppsForOffice.a=function(n,t){this.f=Function.createDelegate(this,this.j);this.c=new($$sc.s.$$(DiagUse.a));this.b=n;this.e=t;this.e.d("PostAccessToken");this.e.c("PostAccessToken",this.f);this.d=Common.a.a().c()};Common.App.AppsForOffice.a.c=function(n,t){return Common.App.AppsForOffice.a.b||(Common.App.AppsForOffice.a.b=new Common.App.AppsForOffice.a(n,t)),Common.App.AppsForOffice.a.b};Common.App.AppsForOffice.a.prototype={b:null,e:null,d:null,a:function(n,t,i,r,u){var e,y,c,l,o,f,s,b,k,p;if(Common.App.AppsForOffice.a.a.b(n)){Diag.a.a(22402394,344,100,"GetAccessToken: addinCallbackMap already has the callback info for this addin.");r(OSF.DDA.ErrorCodeManager.errorCodes.ooeAddinIsAlreadyRequestingToken,null);return}try{var h=this.b.getOsfControl(n),w=Common.l.f(h.getManifest().getDefaultSourceLocation(OSF.FormFactor.Default)),a=h.getManifest().isSSOAddin(),v=this.h(n,w);if(a||v)t?(e=n+"Consent",this.d&&(y=this.d.a("ComponentAttach",e),this.c.c(e,y)),c=this,l=function(t){var f=c.c.a(e);f&&(f.a(),f=null,c.c.d(e));t===OSF.ConsentResultCode.Success?c.g(n,i,r,u):t===OSF.ConsentResultCode.Cancelled?r(OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted,null):r(OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant,null)},h.isUILessAddInCommands()?(o=new CommonUI.d,o.g(5),f=document.createElement("iframe"),f.id="WACDialogSeePermissionsIframe",f.className="WACDialogSeePermissionsIframe",Sys.UI.DomElement.addCssClass(f,"ObjectInDialog"),f.frameBorder="0",f.src=this.b.getOmexIframeNotificationUrl(n,OSF.NotificationType.ConsentWhiteDialog),s=null,b=this,s=function(n){var i,t;try{i=n.rawEvent;i.source===f.contentWindow&&(t=JSON.parse(i.data),t[OSF.OmexMessageKeys.MessageType]===OSF.OmexMessageType.ConsentResult&&(l(t[OSF.OmexMessageKeys.MessageValue]),o.i(),$removeHandler(window,"message",s)),t[OSF.OmexMessageKeys.MessageType]===OSF.OmexMessageType.ButtonClick&&o.cc())}catch(r){Diag.a.a(23455899,344,10,"Exception in messageHandler: {0}",r.message)}},k=this,p=function(){l(OSF.ConsentResultCode.Cancelled);$removeHandler(window,"message",s)},o.c($a.eu,null,3,p,f),$addHandler(window,"message",s)):h.showConsentError(l)):this.g(n,i,r,u);else if(a){if(!v){Diag.a.a(36292511,344,10,"GetAccessToken: current Addin is not a first party Addin.");r(OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied,null);return}}else{Diag.a.a(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin.");r(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null);return}}catch(d){Diag.a.a(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",d.message);r(OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null)}},g:function(n,t,i,r){var o=r?r:this.b.getOsfControl(n).getManifest().getWebApplicationResource(),s=this.b.getOsfControl(n).getManifest().getDefaultSourceLocation(OSF.FormFactor.Default),h=Common.l.i(o),c=Common.l.i(s),a=Common.l.f(s),f=this.h(n,a),u,e,l;if(h.toLowerCase()===c.toLowerCase()||f)Common.App.AppsForOffice.a.a.c(n,i),u={},u.AddinControlId=n,u.AddinApplicationResource=o,u.AddinSSOAuthChallenge=t,u.AddinIsFirstParty=f,this.d&&(e=n+"GetAccessToken",l=this.d.a("ComponentAttach",e),this.c.c(e,l)),this.e.a("GetAccessToken",u);else{if(h.toLowerCase()!==c.toLowerCase()){Diag.a.a(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null);return}if(!f){Diag.a.a(36292512,344,10,"GetAccessToken: current Addin is not a first party Addin.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied,null);return}}},j:function(n){var u,e;try{var i=n.Values.AddinControlId,t=n.Values.AccessToken,f=i+"GetAccessToken",r=this.c.a(f);r&&(r.a(),r=null,this.c.d(f));u=0;t&&typeof t!="undefined"&&t.length||(u=this.i(n));e=Common.App.AppsForOffice.a.a.a(i);Common.App.AppsForOffice.a.a.d(i);e(u,t)}catch(o){Diag.a.a(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",o.message)}},i:function(n){var r=n.Values.HostApplicationType,t=n.Values.AddinSSOError,i;if(Diag.a.a(23859717,344,10,"MapErrorMessageToErrorCode: host application type: {0}, error message: {1}",r,t),i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,r==="SharepointOnline"||r==="ExchangeOnline")if(t.indexOf("AADSTS50058")>-1||t.indexOf("Popup Window is null")>-1||t.indexOf("Popup Window closed")>-1){i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;var u=n.Values.AddinControlId,f=this.b.getOsfControl(u).getManifest().getDefaultDisplayName(),e=this.b.getOsfControl(u).getManifest().getDefaultSourceLocation(OSF.FormFactor.Default),o=Common.l.i(e);this.k(f,o)}else t.indexOf("AADSTS50001")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:t.indexOf("13002")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:(t.indexOf("AADSTS70011")>-1||t.indexOf("AADSTS65001")>-1)&&(i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant);return i},k:function(n,t){var u=new CommonUI.d,r,f,i;u.w=!1;u.g(0);r=document.createElement("div");f=document.createElement("span");f.innerText=String.format($a.dn,t);i=document.createElement("a");i.href="https://blogs.msdn.microsoft.com/ieinternals/2011/03/10/beware-cookie-sharing-in-cross-zone-scenarios/";i.id="MoreDetailLinkForSSOCrossZone";i.innerText="https://blogs.msdn.microsoft.com/ieinternals/2011/03/10/beware-cookie-sharing-in-cross-zone-scenarios/";i.target="_blank";r.appendChild(f);r.appendChild(i);u.c(n,null,2,null,r)},h:function(n,t){var u;if(Diag.a.a(33924163,344,15,"IsFirstPartyAddin: This is a temporary method until we develop a secure implement."),this.b.getOsfControl(n).isFirstParty())return!0;for(var r=["https://nleditor.osi.office.net"],f=r.length,i=0;i<f;++i)if(u=r[i],u===t)return!0;return!1}};Common.App.AppsForOffice.d=function(){};Common.App.AppsForOffice.d.prototype={b:null,a:null};Common.App.AppsForOffice.l=function(){};Common.App.AppsForOffice.l.prototype={e:0,c:0,d:null,a:null,b:null,g:!1,f:!1};Common.App.AppsForOffice.e=function(n,t,i){Common.App.AppsForOffice.e.initializeBase(this);this.a=n;this.b=t;this.c=i};Common.App.AppsForOffice.e.prototype={a:null,b:0,c:null};Common.App.AppsForOffice.k=function(n,t){this.c=n;this.b=t};Common.App.AppsForOffice.k.prototype={c:null,b:null,tryAuthenticate:function(n,t){var i=this;this.a("identitytoken",function(){n()},t)},tryAuthorize:function(n,t){this.a("authcode",n,t)},getSignInUrl:function(n,t){this.a("signinurl",n,t)},signOut:function(n,t){this.a("signout",n,t)},a:function(n,t,i){var u=new Common.bu("AuthenticationProxyHandler.aspx"),f,r;u.a("responseType",n);f=String.format("{0}{1}&{2}",this.c,u.toString(),this.b);r=document.createElement("iframe");r.setAttribute("id","privateCatalogIframe");r.setAttribute("name","privateCatalogIframe");r.setAttribute("style","display: none");Common.App.AppsForOffice.k.a.a(r,t,i);r.setAttribute("src",f);document.body.appendChild(r)}};Common.App.AppsForOffice.k.a=function(n,t,i){this.b=Function.createDelegate(this,this.e);this.a=n;this.d=t;this.c=i;$addHandler(window,"message",this.b)};Common.App.AppsForOffice.k.a.a=function(n,t,i){new Common.App.AppsForOffice.k.a(n,t,i)};Common.App.AppsForOffice.k.a.prototype={d:null,c:null,a:null,e:function(n){try{var t=JSON.parse(n.rawEvent.data);t&&t.statusCode===200?(Diag.a.a(23705827,344,100,"Received resposne from authentication proxy."),this.d(t.authorizationCode?t.authorizationCode:t.signInUrl)):(Diag.a.a(23707648,344,100,"Authentication proxy returned a result but the operation failed."),this.c());$removeHandler(window,"message",this.b);this.a?document.body.contains(this.a)?document.body.removeChild(this.a):Diag.a.a(24978499,344,15,"The iframe is not a child of Body."):Diag.a.a(24978500,344,15,"The iframe is null.")}catch(i){Diag.a.a(23707649,344,10,"Exception in authentication proxy message handler: {0}.",i.message)}}};Common.App.AppsForOffice.f=function(){};Common.App.AppsForOffice.f.prototype={getUserId:function(n,t){var i,r=(i=new($$sc.r.$$($$sc.d)),i.b(new $$sc.d("corr",n)),i);this.a("getUserId",r,1,t)},getLastStoreUpdate:function(n,t,i){var r,u=(r=new($$sc.r.$$($$sc.d)),r.b(new $$sc.d("lc",n)),r.b(new $$sc.d("corr",t)),r);this.a("laststoreupdate",u,1,i)},getEntitlement:function(n,t,i,r){var u,f=(u=new($$sc.r.$$($$sc.d)),u.b(new $$sc.d("av",t)),u.b(new $$sc.d("corr",i)),u);this.a("getEntitlements",f,1,r)},getEToken:function(n,t,i,r,u,f){var e,o=(e=new($$sc.r.$$($$sc.d)),e.b(new $$sc.d("cmu",n)),e.b(new $$sc.d("cmf",t)),e.b(new $$sc.d("assetid",i)),e.b(new $$sc.d("expver",r)),e.b(new $$sc.d("corr",u)),e);this.a("getEToken",o,1,f)},getManifest:function(n,t,i,r){var u,f=(u=new($$sc.r.$$($$sc.d)),u.b(new $$sc.d("cmu",n)),u.b(new $$sc.d("assetid",t)),u.b(new $$sc.d("corr",i)),u);this.a("getManifest",f,1,r)},getAppState:function(n,t,i){var r,u=(r=new($$sc.r.$$($$sc.d)),r.b(new $$sc.d("ma",n)),r.b(new $$sc.d("corr",t)),r);this.a("getAppState",u,1,i)},getKilledApps:function(n,t){var i,r=(i=new($$sc.r.$$($$sc.d)),i.b(new $$sc.d("corr",n)),i);this.a("getRemovedAddins",r,1,t)},getAppDetails:function(n,t,i,r){var u,f=(u=new($$sc.r.$$($$sc.d)),u.b(new $$sc.d("cmo",n)),u.b(new $$sc.d("corr",i)),u);this.b("getAppDetails",f,t,2,r)},removeApps:function(n,t,i){var r,u=(r=new($$sc.r.$$($$sc.d)),r.b(new $$sc.d("corr",t)),r);this.b("removeAddin",u,n,2,i)},getLastPrivateCatalogUpdate:function(n,t,i,r,u,f){var e,o=(e=new($$sc.r.$$($$sc.d)),e.b(new $$sc.d("catalog","privatecatalog")),e.b(new $$sc.d("clientCode",n)),e.b(new $$sc.d("clientVersion",t)),e.b(new $$sc.d("corr",u)),e),s=String.format("authorizationCode={0}&refreshToken={1}",i?Common.d.a(i):"",r?Common.d.a(r):"");this.b("getLastPrivateCatalogUpdate",o,s,2,f)},getPrivateCatalogAddIns:function(n,t,i,r,u,f){var e,o=(e=new($$sc.r.$$($$sc.d)),e.b(new $$sc.d("catalog","privatecatalog")),e.b(new $$sc.d("clientCode",n)),e.b(new $$sc.d("clientVersion",t)),e.b(new $$sc.d("corr",u)),e),s=String.format("authorizationCode={0}&refreshToken={1}",i?Common.d.a(i):"",r?Common.d.a(r):"");this.b("getAddIns",o,s,2,f)},getPrivateCatalogManifests:function(n,t,i,r,u){var f,e=(f=new($$sc.r.$$($$sc.d)),f.b(new $$sc.d("catalog","privatecatalog")),f.b(new $$sc.d("corr",r)),f),o=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Common.d.a(n),t?Common.d.a(t):"",i?Common.d.a(i):"");this.b("getAppManifests",e,o,2,u)},isStoreDisabled:function(n,t){var i,r=(i=new($$sc.r.$$($$sc.d)),i.b(new $$sc.d("corr",n)),i);this.a("isStoreDisabled",r,2,t)},a:function(n,t,i,r){this.b(n,t,null,i,r)},b:function(n,t,i,r,u){var f=new Common.bu("AddinServiceHandler.ashx"),e,o;for(f.a("action",n),f.a("app",Common.bW.toString(Common.a.a().a().c())),e=t.$$ge();e.$$mn();)o=e.$$cu(),f.a(o.b,o.a);var s=Common.a.a().a().f(),h=String.format("{0}{1}&{2}",s,f.toString(),Common.a.h),c=Common.a.d,l=this,a=this;c.a(h,r,i,null,!1,2,function(n){var t=null;n&&n.b&&(t=n.b.b);u(n.b.c,t)},function(n){u(n.b.c,null);Diag.a.a(18392345,220,50,"S2S web request failed with {0}.",n.b.c)},null,null,!1,null,null,null,null,!1)}};Common.App.AppsForOffice.c.registerClass("Common.App.AppsForOffice.c");Common.App.AppsForOffice.h.registerClass("Common.App.AppsForOffice.h",Common.App.AppsForOffice.c);Common.App.AppsForOffice.i.registerClass("Common.App.AppsForOffice.i",CommonUI.b,Common.App.AppsForOffice.o);Common.App.AppsForOffice.AppsForOfficeDialogManager.registerClass("Common.App.AppsForOffice.AppsForOfficeDialogManager");Common.App.AppsForOffice.j.registerClass("Common.App.AppsForOffice.j",CommonUI.b);Common.App.AppsForOffice.d.registerClass("Common.App.AppsForOffice.d");Common.App.AppsForOffice.e.registerClass("Common.App.AppsForOffice.e",Sys.EventArgs);Common.App.AppsForOffice.k.registerClass("Common.App.AppsForOffice.k");Common.App.AppsForOffice.f.registerClass("Common.App.AppsForOffice.f");Common.App.AppsForOffice.b.a=null;Common.App.AppsForOffice.AppsForOfficeDialogManager.b=null;Common.App.AppsForOffice.AppsForOfficeDialogManager.a=new($$sc.s.$$(Common.App.AppsForOffice.d));Common.App.AppsForOffice.a.a=new($$sc.s.$$(Function));Common.App.AppsForOffice.a.b=null;Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.s=function(){};Common.App.AppsForOfficeCommon.p=function(){};Common.App.AppsForOfficeCommon.h=function(){this.Ver=1};Common.App.AppsForOfficeCommon.b=function(){};Common.App.AppsForOfficeCommon.b.b=function(){return Common.App.AppsForOfficeCommon.b.a||(Common.App.AppsForOfficeCommon.b.a=new Common.App.AppsForOfficeCommon.b),Common.App.AppsForOfficeCommon.b.a};Common.App.AppsForOfficeCommon.b.prototype={b:function(n){var t=this.e();if(!t)return null;try{return t.getItem(n)}catch(i){return null}},c:function(n,t){var i=this.e();if(i)try{i.setItem(n,t)}catch(r){}},a:function(n){var t=this.e();if(t)try{t.removeItem(n)}catch(i){}},d:!1,e:function(){var n=null;if(!this.d)try{localStorage&&(n=localStorage)}catch(t){this.d=!0}return n}};Common.App.AppsForOfficeCommon.g=function(n){this.d=n};Common.App.AppsForOfficeCommon.g.prototype={d:null,e:function(n){var t=new Date;return Math.abs(t.getTime()-n.CreatedOn)<864e5*n.RR},a:function(n,t){var r=this.d.b(n),i;if(r){i=new Common.App.AppsForOfficeCommon.h;try{i=Sys.Serialization.JavaScriptSerializer.deserialize(r,!0)}catch(u){return this.d.a(n),null}return t?this.e(i)?i.Data:(this.d.a(n),null):i.Data}return null},c:function(n,t,i){var r=new Common.App.AppsForOfficeCommon.h;r.Data=t;r.RR=i;r.CreatedOn=(new Date).getTime();this.d.c(n,Sys.Serialization.JavaScriptSerializer.serialize(r))},b:function(n){this.d.a(n)}};Common.App.AppsForOfficeCommon.h.registerClass("Common.App.AppsForOfficeCommon.h");Common.App.AppsForOfficeCommon.b.a=null;Type.registerNamespace("CommandUI.AddInCommands");CommandUI.AddInCommands.Y=function(){};CommandUI.AddInCommands.bh=function(){};CommandUI.AddInCommands.K=function(){};CommandUI.AddInCommands.K.registerInterface("CommandUI.AddInCommands.K");CommandUI.AddInCommands.ba=function(){};CommandUI.AddInCommands.o=function(){};CommandUI.AddInCommands.o.registerInterface("CommandUI.AddInCommands.o");CommandUI.AddInCommands.M=function(){};CommandUI.AddInCommands.M.registerInterface("CommandUI.AddInCommands.M");CommandUI.AddInCommands.h=function(){};CommandUI.AddInCommands.h.registerInterface("CommandUI.AddInCommands.h");CommandUI.AddInCommands.L=function(){};CommandUI.AddInCommands.L.registerInterface("CommandUI.AddInCommands.L");CommandUI.AddInCommands.bi=function(){};CommandUI.AddInCommands.bi.registerInterface("CommandUI.AddInCommands.bi");CommandUI.AddInCommands.bf=function(){};CommandUI.AddInCommands.bd=function(){};CommandUI.AddInCommands.bk=function(){};CommandUI.AddInCommands.bk.registerInterface("CommandUI.AddInCommands.bk");CommandUI.AddInCommands.Z=function(){};CommandUI.AddInCommands.bb=function(){};CommandUI.AddInCommands.bc=function(){};CommandUI.AddInCommands.be=function(){};CommandUI.AddInCommands.bg=function(){};CommandUI.AddInCommands.bj=function(){};CommandUI.AddInCommands.bj.registerInterface("CommandUI.AddInCommands.bj");CommandUI.AddInCommands.bn=function(){};CommandUI.AddInCommands.bm=function(){};CommandUI.AddInCommands.bl=function(){};CommandUI.AddInCommands.bq=function(){};CommandUI.AddInCommands.bq.registerInterface("CommandUI.AddInCommands.bq");CommandUI.AddInCommands.bp=function(){};CommandUI.AddInCommands.bo=function(){};CommandUI.AddInCommands.br=function(){};CommandUI.AddInCommands.s=function(){};CommandUI.AddInCommands.s.prototype={d:null,e:null,a:function(){return this.d||(this.d=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},b:function(){return this.e||(this.e=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())},c:function(n,t,i,r,u,f,e){var h,o,s;if(Diag.a.a(17138449,220,50,"Control id: {0}.",n),h=r,o=t.h(u.ownerAddinInfo.storeType,u.ownerAddinInfo.assetId),o&&o.a)if(s=null,o.a.getNotificationParams().length>0&&(s=this.f(o.a.getNotificationParams()[0])),o.a.getStatus()!==OSF.OsfControlStatus.Activated&&(o.a.getStatus()!==OSF.OsfControlStatus.NotActivated||s&&s.d===OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE))s&&this.g(o.a,s,e);else try{i.setOwnerAddinEToken(o.a.getEToken());u.action(i,h.a());f&&f()}catch(c){Diag.a.a(17425949,220,10,String.format("HandleAddinCommandsAction error message : {0}.",c.message));CommandUI.AddInCommands.a.c($a.p+" "+$a.q,null)}},g:function(n,t,i){if(n.getNotificationParams().length===1||t.h){var r=t.b,u=this,e=function(){if(n.removeFirstNotification(),n.getNotificationParams().length>0){var t=u.f(n.getNotificationParams()[0]);u.g(n,t,null)}r&&r()},f=t.c,s=this,o=function(){f&&f();i&&i()};t.b=e;t.c=o;CommandUI.AddInCommands.a.i(t)}},f:function(n){var t=new CommandUI.AddInCommands.y;return t.f=n.infoType,t.i=n.id,t.a=n.title,t.e=n.description,t.g=n.buttonTxt,t.b=n.buttonCallback,t.h=n.highPriority,t.c=n.dismissCallback,t.d=n.errorCode,t}};CommandUI.AddInCommands.l=function(){};CommandUI.AddInCommands.l.a=function(n){var t=new CommandUI.AddInCommands.B;return t.a=n.a,t.b=t.a?!0:!1,t};CommandUI.AddInCommands.l.b=function(n,t,i,r,u){var f=document.getElementById(i);if(!f){Diag.a.a(17662423,220,100,String.format("{0} element is not availiable",i));return}n.a===$a.e&&CommandUI.AddInCommands.a.j(t,Common.f.a(document.getElementById(i)),r,u)};CommandUI.AddInCommands.O=function(n,t,i,r,u,f,e){this.n=new Common.K;this.e=n;this.i=t;this.g=i;this.h=r;this.d=u;this.m=f;this.f=e};CommandUI.AddInCommands.O.prototype={e:null,i:null,g:null,h:null,d:null,m:null,f:null,a:function(n){this.n.o("ack7",n)},b:function(n,t,i){var u=i.ack2,r=isUndefined(i.ack0)?0:i.ack0;if(!u||!r){Diag.a.a(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.e.a()));this.k(new CommandUI.AddInCommands.O.a(r,null,null,n,t,null,!0));return}if(u.e.length<=0&&r!==4){this.l(new CommandUI.AddInCommands.O.a(r,null,null,n,t,null,!0));return}var e=u.e.length,o=new CommandUI.AddInCommands.O.b(new CommandUI.AddInCommands.U(n)),c=isUndefined(i.ack1)?-1:i.ack1,l=new CommandUI.AddInCommands.j(r,this.g,this.e,o,this.i,this.d,this.f),f=this,a=function(n){return f.h.c(n.assetId,f.f,f.e)},v=this,y=function(n){return v.h.a(n.assetId)},s=this,p=function(i,u,f,h){e--;var c=new CommandUI.AddInCommands.O.a(r,u,o,n,t,h,e<=0);i&&u?s.l(c):s.k(c)},h=this,w=function(){h.j(null);u.e.length<=0&&r===4&&h.d.g()};l.k(u,a,y,c,p,w)},c:function(n,t,i){var u=i.ack2,r=isUndefined(i.ack0)?0:i.ack0;if(!u||!r){Diag.a.a(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.e.a()));this.k(new CommandUI.AddInCommands.O.a(r,null,null,null,t,null,!0));return}if(u.e.length<=0&&r!==4){this.l(new CommandUI.AddInCommands.O.a(r,null,null,null,t,null,!0));return}var e=u.e.length,o=new CommandUI.AddInCommands.O.b(new CommandUI.AddInCommands.R),c=isUndefined(i.ack1)?-1:i.ack1,l=new CommandUI.AddInCommands.j(r,this.g,this.e,o,this.i,this.d,this.f),f=this,a=function(t){return f.h.b(t.assetId,f.f,f.e,n)},v=this,y=function(n){return v.h.a(n.assetId)},s=this,p=function(n,i,u,f){e--;var h=new CommandUI.AddInCommands.O.a(r,i,o,null,t,f,e<=0);n&&i?s.l(h):s.k(h)},h=this,w=function(){h.j(null);u.e.length<=0&&r===4&&h.d.g()};l.k(u,a,y,c,p,w)},k:function(n){this.j(null);this.o(!1,n)},l:function(n){var t=n.a,i;this.j(t);t&&(CommandUI.AddInCommands.c.b().a(CommandUI.AddInCommands.g.b(t.currentStoreType.toLowerCase()),!0),t.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog&&(i=this.m.a(t.currentStoreType.toLowerCase(),this.g),i&&i.localCacheAddinCommands(this.g.a(),t.id,t.appVersion,t.storeId)),this.p(n.b.c,t.currentStoreType,n.c,n.d));this.o(!0,n)},o:function(n,t){var i,r;n?t.c!==3?t.e&&this.d.g():t.b&&t.b.c&&(i=$$as(CommandUI.g,t.d),i&&t.a.currentStoreType!==OSF.StoreType.HardCodedPreinstall&&CommandUI.AddInCommands.a.l(i,t.g,t.f,t.b.c)):t.c===3?t.a&&t.a.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog?(r=this.f.b(t.a.assetId),CommandUI.AddInCommands.a.c(r?r:$a.p+" "+$a.q,null)):this.d.o(!0):t.e&&this.d.g()},j:function(n){var t=new CommandUI.AddInCommands.N;t.a=n;this.n.m("ack7",t,null)},p:function(n,t,i,r){var u=$$as(CommandUI.g,r),e,f;n&&u&&(e=n.b().a(0),f=e.a().Id,i===3&&t!==OSF.StoreType.HardCodedPreinstall&&u.E(f,!1),u.ft(f)&&u.fz())}};CommandUI.AddInCommands.O.a=function(n,t,i,r,u,f,e){this.c=n;this.a=t;this.b=i;this.d=r;this.g=u;this.f=f;this.e=e};CommandUI.AddInCommands.O.a.prototype={c:0,a:null,b:null,d:null,g:null,f:null,e:!1};CommandUI.AddInCommands.O.b=function(n){this.d=n};CommandUI.AddInCommands.O.b.prototype={d:null,c:null,a:function(n){this.d.a(n);this.c=n},b:function(n){this.d.b(n)}};CommandUI.AddInCommands.N=function(){CommandUI.AddInCommands.N.initializeBase(this)};CommandUI.AddInCommands.N.prototype={a:null};CommandUI.AddInCommands.w=function(){};CommandUI.AddInCommands.w.prototype={a:null,setErrorMessageForAddin:function(n,t){this.a||(this.a={});this.a[n]=t},b:function(n){return this.a&&n in this.a?this.a[n]:null}};CommandUI.AddInCommands.y=function(){};CommandUI.AddInCommands.y.prototype={f:0,i:null,a:null,e:null,g:null,b:null,d:0,h:!1,c:null};CommandUI.AddInCommands.k=function(){};CommandUI.AddInCommands.k.prototype={a:null,c:null,b:null,d:null,e:function(n,t){return this.a.getStoreType().toLowerCase()===n.toLowerCase()&&this.a.getMarketplaceID().toLowerCase()===t.toLowerCase()}};CommandUI.AddInCommands.AddinCommandsUILessDialog=function(){this.b=this.i;this.c=this.initializeAndShowWithTitle;CommandUI.AddInCommands.AddinCommandsUILessDialog.initializeBase(this);this.g(5);this.e=String.format("{0}px",this.P);this.d=String.format("{0}px",this.K);this.D=!1;this.bG=!1;this.v()};CommandUI.AddInCommands.AddinCommandsUILessDialog.prototype={R:"WACDialogTitleText",Q:"0",e:null,d:null,P:380,K:190,v:function(){CommonUI.b.prototype.v.call(this);this.u.style.width=this.e;this.u.style.height=this.d;this.u.style.padding=this.Q},B:function(n){this.w();var t=document.getElementById(this.h+this.R);t.innerText=n},w:function(){CommonUI.b.prototype.w.call(this);this.f.style.width=String.format("{0}px",this.P);this.f.style.height=String.format("{0}px",this.K);this.f.removeAttribute("role");this.f.removeAttribute("aria-labelledby")},i:function(){this.cc()},a:function(){return this.u},initializeAndShowWithTitle:function(){this.t($a.dm,null,null)}};CommandUI.AddInCommands.A=function(){};CommandUI.AddInCommands.A.a=function(n){var t={};return t.id=n.assetId,t.assetId=n.assetId,t.appVersion=n.appVersion,t.currentStoreType=n.storeType,t.storeId=n.storeId,t.assetStoreId=n.storeType,t.targetType=n.targetType,t.isAddinCommands=!0,t};CommandUI.AddInCommands.B=function(){};CommandUI.AddInCommands.B.prototype={a:null,b:!1};CommandUI.AddInCommands.g=function(){};CommandUI.AddInCommands.g.a=function(n){var t=null;switch(n){case 0:t=OSF.StoreType.OMEX;break;case 1:t=OSF.StoreType.SPCatalog;break;case 2:t=OSF.StoreType.SPApp;break;case 3:t=OSF.StoreType.FileSystem;break;case 4:t=OSF.StoreType.Exchange;break;case 6:t=OSF.StoreType.Registry;break;case 7:t=OSF.StoreType.InMemory;break;case 8:t=OSF.StoreType.UploadFileDevCatalog;break;case 9:t=OSF.StoreType.HardCodedPreinstall;break;case 10:t=OSF.StoreType.PrivateCatalog}return t};CommandUI.AddInCommands.g.b=function(n){var t=-1;switch(n.toLowerCase()){case"omex":t=0;break;case"spcatalog":t=1;break;case"spapp":t=2;break;case"filesystem":t=3;break;case"exchange":t=4;break;case"registry":t=6;break;case"inmemory":t=7;break;case"uploadfiledevcatalog":t=8;break;case"hardcodedpreinstall":t=9;break;case"excatalog":t=10}return t};CommandUI.AddInCommands.b=function(){};CommandUI.AddInCommands.b.e=function(n){var i=new($$sc.r.$$(String)),e,t,s;if(CommandUI.AddInCommands.b.a)for(var f=CommandUI.AddInCommands.b.a,h=f.length,r=0;r<h;++r)e=f[r],i.b(e);t=null;switch(n){case"Workbook":t=CommandUI.AddInCommands.b.d;break;case"Document":t=CommandUI.AddInCommands.b.b;break;case"Presentation":t=CommandUI.AddInCommands.b.c}if(t)for(var o=t,c=o.length,u=0;u<c;++u)s=o[u],i.b(s);return i};CommandUI.AddInCommands.r=function(n){this.b=n;this.a().Id=this.b};CommandUI.AddInCommands.r.prototype={b:null,h:null,f:null,g:null,c:!1,e:null,d:null,a:function(){return this.h||(this.h={})},i:function(){return this.f||(this.f=new($$sc.r.$$(CommandUI.AddInCommands.n)))},j:function(){return this.g||(this.g=new($$sc.r.$$(CommandUI.AddInCommands.i)))},l:function(){for(var t=new($$sc.r.$$(String)),i=new($$sc.r.$$(String)),r=this.j().$$lge(),u,n,f,e,o;r.$$mn();)u=r.$$cu(),t.b(u.d());for(n=this.i().$$lge();n.$$mn();)f=n.$$cu(),i.b(f.h());return e=this.k("Groups",this.d,i.f()),o=this.k("Scaling",this.e,t.f()),Common.r.e("Tab",this.a(),o,e)},k:function(n,t,i){var r={};return r.Id=t,Common.r.e.apply(null,[n,r].concat(i))}};CommandUI.AddInCommands.n=function(n){if(CommandUI.a.a(n)){Diag.a.a(9041811,220,10,"GroupDefinition id should not be null or undefined.");throw Error.create("GroupDefinition id should not be null or undefined");}this.e=n;this.a().Id=this.e};CommandUI.AddInCommands.n.prototype={e:null,f:null,d:null,c:null,g:function(n){return this.f=n,this.a().Template=this.f,n},a:function(){return this.d||(this.d={})},b:function(){return this.c||(this.c=new($$sc.r.$$(CommandUI.AddInCommands.o)))},h:function(){for(var n=new($$sc.r.$$(String)),t=this.b().$$lge(),i,r;t.$$mn();)i=t.$$cu(),n.b(i.c());return r=Common.r.e.apply(null,["Controls",null].concat(n.f())),Common.r.e("Group",this.a(),r)}};CommandUI.AddInCommands.i=function(n){if(CommandUI.a.a(n)){Diag.a.a(9041813,220,10,"ScalingDefinition type should not be null or undefined.");throw Error.create("ScalingDefinition type should not be null or undefined");}this.c=n};CommandUI.AddInCommands.i.prototype={c:null,b:null,a:function(){return this.b||(this.b={})},d:function(){return Common.r.m(this.c,null,this.a())}};CommandUI.AddInCommands.e=function(n,t){if(CommandUI.a.a(n)||CommandUI.a.a(t)){Diag.a.a(9175312,220,10,"ControlDefinition id or type should not be null or undefined.");throw Error.create("ControlDefinition id or type should not be null or undefined");}this.f=t;this.g=n;this.a().Id=this.g};CommandUI.AddInCommands.e.prototype={g:null,f:null,e:null,d:null,a:function(){return this.e||(this.e={})},b:function(){return this.d||(this.d=new($$sc.r.$$(CommandUI.AddInCommands.M)))},c:function(){return Common.r.m(this.f,this.h(),this.a())},h:function(){var n=null,t,i;if(this.d){for(n=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>'),t=this.d.$$lge();t.$$mn();)i=t.$$cu(),n.append(i.b());n.append("<\/Controls><\/MenuSection><\/Menu>")}return n?n.toString():""}};CommandUI.AddInCommands.p=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175313,220,10,"MenuItemDefinition id should not be null or undefined.");throw Error.create("MenuItemDefinition id should not be null or undefined");}this.d=n;this.a().Id=this.d};CommandUI.AddInCommands.p.prototype={d:null,c:null,a:function(){return this.c||(this.c={})},b:function(){return Common.r.m("Button",null,this.c)}};CommandUI.AddInCommands.q=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined.");throw Error.create("OfficeMenuDefinition id should not be null or undefined");}this.d=n};CommandUI.AddInCommands.q.prototype={d:null,c:null,b:function(){return this.d},a:function(){return this.c||(this.c=new($$sc.r.$$(CommandUI.AddInCommands.o)))}};CommandUI.AddInCommands.C=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175315,220,10,"The agave key should not be null or undefined.");throw Error.create("The agave key should not be null or undefined");}this.c=n};CommandUI.AddInCommands.C.prototype={c:null,d:null,b:function(){return this.d||(this.d=new($$sc.r.$$(CommandUI.AddInCommands.h)))},a:function(){return this.c}};CommandUI.AddInCommands.P=function(n,t,i){this.c=n;this.a=t;this.b=i};CommandUI.AddInCommands.P.prototype={c:null,a:null,b:null};CommandUI.AddInCommands.S=function(n,t,i,r){if(CommandUI.a.a(n)&&CommandUI.a.a(t)){Diag.a.a(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");throw Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");}this.f=n;this.g=t;this.i=i;this.h=r};CommandUI.AddInCommands.S.prototype={g:null,f:null,i:null,h:null,b:function(){return this.f},d:function(){return this.g},a:function(){return this.i},c:function(){for(var n=new Sys.StringBuilder,t=this.f.$$lge(),i;t.$$mn();)i=t.$$cu(),n.append(i.l());return this.j(n.toString())},e:function(){return this.h},j:function(n){var t=new Sys.StringBuilder;return t.append("<Ribbon><Tabs>"),t.append(n),t.append("<\/Tabs><\/Ribbon>"),t.toString()}};CommandUI.AddInCommands.D=function(){this.d=new($$sc.r.$$(CommandUI.AddInCommands.L))};CommandUI.AddInCommands.D.prototype={d:null,a:function(n){var t,i,f,r,u;for(Diag.a.a(17306645,220,50,"Context menu id: {0}",n),t=new($$sc.r.$$(CommandUI.AddInCommands.h)),i=this.d.$$lge();i.$$mn();)for(f=i.$$cu(),r=f.b().$$lge();r.$$mn();)u=r.$$cu(),u.b()===n&&t.b(u);return t},b:function(n){this.d.b(n)},c:function(n){for(var i=this.d.$$lge(),t;i.$$mn();)if(t=i.$$cu(),t.a()===n.a()){this.d.d(t);break}}};CommandUI.AddInCommands.R=function(){};CommandUI.AddInCommands.R.prototype={a:function(n){var t=this.c(n);t&&ribbonAddins.addInApi.dispatchActionsToInstallAddIn(t)},b:function(n){var t=this.c(n);t&&ribbonAddins.addInApi.dispatchActionsToRemoveAddIn(t)},c:function(n){var i=n.d(),t;return i?(t=new Common.AddInDataTransferObject,t.tabs=i.c.f(),t.id=i.a,t.title=i.b,t):null}};CommandUI.AddInCommands.U=function(n){this.c=new CommandUI.bJ(n)};CommandUI.AddInCommands.U.prototype={c:null,a:function(n){var t=n.c();this.c.c(t,n.e())},b:function(n){var t=n.c();this.c.f(t)}};CommandUI.AddInCommands.c=function(){this.b=new Common.App.AppsForOfficeCommon.g(Common.App.AppsForOfficeCommon.b.b())};CommandUI.AddInCommands.c.b=function(){return CommandUI.AddInCommands.c.a||(CommandUI.AddInCommands.c.a=new CommandUI.AddInCommands.c),CommandUI.AddInCommands.c.a};CommandUI.AddInCommands.c.prototype={b:null,a:function(n,t){var i=Common.dx.a()+n;Common.App.AppsForOfficeCommon.b.b().c(i,t.toString())}};CommandUI.AddInCommands.x=function(n,t,i){this.e=new Common.K;this.a=new CommandUI.AddInCommands.x.b;this.b=n;this.d=t;this.c=i};CommandUI.AddInCommands.x.prototype={b:null,d:null,c:null,g:function(n){this.e.o("ack4",n)},i:function(n){var t,i;null!==n&&(this.a.a=n.ack1,this.a.d=n.ack0,this.a.f=this.a.e=0,t="ak0"in n?n.ak0:0,this.a.a!==-1&&this.a.d&&t>0&&(this.a.b=new CommandUI.B,this.a.c=this.d.a(CommandUI.AddInCommands.g.a(this.a.a),this.b),this.a.c?(i=this,this.a.c.getEntitlementsAsync(this.b.a(),!0,t,function(n){i.h(n)})):Diag.a.a(17638145,220,10,"Create AddinDataProvider fails for {0}",this.a.a)))},h:function(n){var r=n,u,t,i,f;if(r&&r.length>0)for(this.a.f=r.length,u=0;u<r.length;u++)t=r[u],t&&(t.targetType===OSF.OsfControlTarget.TaskPane||t.targetType===OSF.OsfControlTarget.Undefined)?(i={},i.marketplaceId=t.assetId,i.marketplaceVersion=t.appVersion,i.storeType=t.storeType,i.storeId=t.storeId,i.targetData=t,f=this,this.b.c(i,function(n,t,i){n?t&&f.a.b.e(i.targetData):Diag.a.a(17638146,220,10,"Checking AddinCommands fails for {0} from {1}",i.targetData.id,i.targetData.currentStoreType);f.f()})):this.f();else this.f()},f:function(){var t,i,r,n;if(this.a.e++,this.a.e>=this.a.f){if(this.c.a(this.a.a,!1),t=new($$sc.r.$$(Object)),this.a.b)for(i=this.a.b.getEnumerator();i.moveNext();)r=i.get_current(),t.b(CommandUI.AddInCommands.A.a(r));n={ack2:t};n.ack1=this.a.a;n.ack0=this.a.d;this.e.m("ack4",new CommandUI.AddInCommands.x.a(n),this)}}};CommandUI.AddInCommands.x.a=function(n){CommandUI.AddInCommands.x.a.initializeBase(this);this.a=n};CommandUI.AddInCommands.x.a.prototype={a:null};CommandUI.AddInCommands.x.b=function(){};CommandUI.AddInCommands.x.b.prototype={a:0,d:0,c:null,f:0,e:0,b:null};CommandUI.AddInCommands.j=function(n,t,i,r,u,f,e){this.h=new($$sc.s.$$(DiagUse.a));this.b=n;this.j=t;this.a=i;this.f=r;this.e=u;this.c=f;this.d=e;this.g=Common.a.a().c()};CommandUI.AddInCommands.j.prototype={j:null,a:null,f:null,e:null,c:null,b:0,d:null,g:null,k:function(n,t,i,r,u,f){var h=this,c=function(n,t,i,r){u(n,t,i,r);var e=Common.bC.toString(h.b)+t.assetId,f=h.h.a(e);f&&(f.a(),f=null,h.h.d(e))},o=n,l,v,e,a,y,s,p;if(this.b&&o)for(Diag.a.a(17326351,220,50,"Addin count {0}.",o.e.length),this.b===4&&(Diag.a.a(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",r)),this.l(o,r),f()),l=o.$$lge();l.$$mn();)if(v=l.$$cu(),e=v,Diag.a.a(17638144,220,50,String.format("{0}: Install addin {1}",this.a.a(),e.assetId)),this.p(e))try{this.g&&(a=Common.bC.toString(this.b)+e.assetId,y=this.g.a("ComponentAttach",a),this.h.c(a,y));s=this.c.h(e.currentStoreType,e.id);s&&(this.i(s),s.a.purge(!1));p=this.j.b(this.o(e,t,i,c))}catch(w){Diag.a.a(17388185,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.a.a(),e.assetId,e.appVersion,e.currentStoreType,e.storeId,w.message));c(!1,e,null,null)}else c(!1,e,null,null)},n:function(n,t,i,r,u,f){if(f)if(f._isAddinCommandsManifest(this.a.a())){var e=!0;try{this.m(n,t,i,u,f)}catch(o){e=!1;Diag.a.a(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.a.a(),n.assetId,n.appVersion,n.currentStoreType,n.storeId,o.message))}r(e,n,f,f.getDefaultDisplayName())}else Diag.a.a(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.a.a(),n.assetId,n.appVersion,n.currentStoreType,n.storeId)),r(!1,n,null,null);else Diag.a.a(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.a.a(),n.assetId,n.appVersion,n.currentStoreType,n.storeId)),r(!1,n,null,null)},o:function(n,t,i,r){var f=this,o=function(u,e){var o=f.c.h(n.currentStoreType,n.id);o&&f.i(o);f.n(n,t,i,r,u,e)},u={},e=document.createElement("div");return e.setAttribute("visible",!1),u.div=e,u.id=n.id,u.marketplaceID=n.id,u.marketplaceVersion=n.appVersion,u.store=n.storeId,u.storeType=n.currentStoreType,u.osfControlType=n.targetType,u.isvirtualOsfControl=!0,u.virtualOsfControlActivationCallback=o,u.reason=this.b===3?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,u},m:function(n,t,i,r,u){var f={},l,o,s;f.storeType=r.getStoreType();f.storeId=r.getStoreLocator();f.assetId=r.getMarketplaceID();f.appVersion=r.getMarketplaceVersion();f.targetType=r.getOsfControlType();var a=new OfficeExt.Parser.AddinCommandsManifestParser(this.a.a(),this.a.c()),v=a.parseExtensions(f,u,this.d),h=CommandUI.AddInCommands.b.e(this.a.a());if(h&&h.e.length>0){for(var y=t(n),p=i(n),e=new CommandUI.AddInCommands.t(y,null,p),c=h.$$lge();c.$$mn();)l=c.$$cu(),e.commandSurface=l,v.apply(e,this.d);o=e.f(n.id,u.getDefaultDisplayName());s=e.d(null);o&&this.f.a(o);s&&this.e.b(s);this.c.k(r,o,s,u.getDefaultDisplayName());Diag.a.a(17326353,220,100,"Add-in name: {0}.",u.getDefaultDisplayName())}},i:function(n){n.c&&this.f.b(n.c);n.b&&this.e.c(n.b);this.c.m(n.a.getStoreType(),n.a.getMarketplaceID())},l:function(n,t){for(var s=CommandUI.AddInCommands.g.a(t),e=this.c.b.$$lge(),i,u,f,o,r;e.$$mn();)if(i=e.$$cu(),i.a.getStoreType()===s){for(u=!0,f=n.$$lge();f.$$mn();)if(o=f.$$cu(),r=o,r&&i.e(r.currentStoreType,r.id)){u=!1;break}u&&(this.i(i),i.a.purge(!1))}},p:function(n){return!!n&&!!n.currentStoreType&&!!n.storeId&&!!n.id&&!!n.appVersion}};CommandUI.AddInCommands.a=function(){};CommandUI.AddInCommands.a.e=function(){return CommandUI.AddInCommands.a.b||(CommandUI.AddInCommands.a.b=Common.Utils.a.a().d(Common.Utils.h))};CommandUI.AddInCommands.a.d=function(n,t,i,r,u,f){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();CommandUI.AddInCommands.a.a=CommonUI.i.a(t,n,n,u,null);CommandUI.AddInCommands.a.a.f(i);CommandUI.a.b(r)||(CommandUI.AddInCommands.a.a.l(r),CommandUI.AddInCommands.a.a.g(!0));var e=new Sys.UI.Bounds(0,0,Common.i.f(),Common.i.m());CommandUI.AddInCommands.a.a.e(CommandUI.AddInCommands.a.h(e,t,CommandUI.AddInCommands.a.a.c(),f));CommandUI.AddInCommands.a.a.h();CommandUI.AddInCommands.a.e()&&CommandUI.AddInCommands.a.e().a(i.innerText,!0)};CommandUI.AddInCommands.a.c=function(n,t){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();var i=new CommonUI.d;i.w=!1;i.g(0);i.e(27,$a.h,CommandUI.a.b(n)?CommandUI.AddInCommands.a.f():n,t)};CommandUI.AddInCommands.a.i=function(n){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();Diag.a.a(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",n.d));var r=CommandUI.a.b(n.e)?CommandUI.AddInCommands.a.f():n.e,t=new CommonUI.d,i=null;n.b?(t.g(1),t.k(1,n.g),t.G=1):t.g(0);i=function(t){t===1?n.b():n.c&&n.c()};t.w=!1;n.f===OSF.InfoType.Error?t.e(n.d,n.a?n.a:$a.h,r,i):n.f===OSF.InfoType.Warning?t.cj(n.a?n.a:$a.F,r,i):t.S(n.a?n.a:$a.C,r,i)};CommandUI.AddInCommands.a.h=function(n,t,i,r){var u=r?4:0,f=t.x-n.x,e=n.x+n.width-t.x-t.width;return f+t.width/2<=i/2?u=r?5:2:e+t.width/2<=i/2&&(u=r?6:3),u};CommandUI.AddInCommands.a.k=function(n,t,i,r,u){var f;if(!r||!r.b().e.length){Diag.a.a(17326355,220,50,"There is no tab or group added to ribbon !");return}var e=r.b().a(0),o=e.a().Id,s=e.i().a(0).a().Id;n.E(o,!1)&&(f=e.c?n.v(o,s):n.w(o),f&&(f.x+f.width/2>Common.i.f()&&(f=new Sys.UI.Bounds(Common.i.f(),f.y+f.height,0,0)),CommandUI.AddInCommands.a.d(t,f,CommandUI.AddInCommands.a.g(i),u,2,0)))};CommandUI.AddInCommands.a.l=function(n,t,i,r){CommandUI.AddInCommands.a.k(n,t,r.a()?r.a().description:String.format($a.cV,i),r,r.a()?r.a().title:String.format($a.cW,i))};CommandUI.AddInCommands.a.j=function(n,t,i,r){var o=$a.cy.split("{0}"),s=document.createElement("span"),f,e,u;s.innerText=o[0];f=document.createElement("span");f.innerText=String.format($a.cx,i,r,$a.cI);f.className="UIFontBold";e=document.createElement("span");e.innerText=o[1];u=document.createElement("div");Sys.UI.DomElement.addCssClass(u,"ModalCalloutControl");u.appendChild(s);u.appendChild(f);u.appendChild(e);CommandUI.AddInCommands.a.d(n,t,u,$a.e,3,1)};CommandUI.AddInCommands.a.g=function(n){var t=document.createElement("div");return Sys.UI.DomElement.addCssClass(t,"ModalCalloutControl"),t.innerText=n,t};CommandUI.AddInCommands.a.f=function(){return $a.p+" "+$a.q};CommandUI.AddInCommands.t=function(n,t,i){this.ribbonBuilder=n;this.eventBuilder=t;this.contextMenuBuilder=i};CommandUI.AddInCommands.t.prototype={commandSurface:null,actionBuilder:null,ribbonBuilder:null,contextMenuBuilder:null,eventBuilder:null,a:null,c:function(n){return new CommandUI.AddInCommands.u(n)},b:function(n,t){return OfficeExt.DefaultControlActionBinder.createActionBuilder(n,t.entitlement,t.manifest)},startApplyAddin:function(n){this.a=n;var t=this.c(n);this.actionBuilder=this.b(t,n)},endApplyAddin:function(){},f:function(n,t){return this.ribbonBuilder.b()&&this.ribbonBuilder.b().e.length>0||this.ribbonBuilder.a()&&this.ribbonBuilder.a().e.length>0?new CommandUI.AddInCommands.S(this.ribbonBuilder.b(),this.e(n,t),this.a.startedNode,this.ribbonBuilder.c().e()):null},d:function(n){var t,i,r;if(this.contextMenuBuilder.a()&&this.contextMenuBuilder.a().e.length>0){for(n||(n=this.a.entitlement.assetId),t=new CommandUI.AddInCommands.C(n),i=this.contextMenuBuilder.a().$$lge();i.$$mn();)r=i.$$cu(),t.b().b(r);return t}return null},e:function(n,t){return this.ribbonBuilder.a()&&this.ribbonBuilder.a().e.length>0?new CommandUI.AddInCommands.P(this.ribbonBuilder.a(),n,t):null}};CommandUI.AddInCommands.u=function(n){this.a=n.entitlement};CommandUI.AddInCommands.u.prototype={a:null,createActionContext:function(n,t){var i={};return i.ownerAddinInfo=this.a,i.action=t,i}};CommandUI.AddInCommands.W=function(){};CommandUI.AddInCommands.v=function(n){CommandUI.AddInCommands.v.initializeBase(this);this.g(5);this.K=695;this.e=438;this.d="100%";this.a="408px";this.b="15px";this.c="0";this.P=n};CommandUI.AddInCommands.v.prototype={K:0,e:0,d:null,a:null,b:null,c:null,P:null,v:function(){CommonUI.b.prototype.v.call(this);this.u.style.width=this.d;this.u.style.height=this.a;this.u.style.marginTop=this.b;this.u.style.padding=this.c},w:function(){CommonUI.b.prototype.w.call(this);this.f.style.width=String.format("{0}px",this.K);this.f.style.height=String.format("{0}px",this.e)},dispose:function(){CommonUI.b.prototype.dispose.call(this);this.P()}};CommandUI.AddInCommands.E=function(n,t,i){this.g=n;this.f=t;this.e=i;this.d=new($$sc.r.$$(CommandUI.AddInCommands.h))};CommandUI.AddInCommands.E.prototype={c:null,b:null,g:null,f:null,e:null,addButton:function(n){Diag.a.a(17085952,220,50,"ContextMenu button actiontype: {0}.",n.actionType);this.b=new CommandUI.AddInCommands.e(this.h(n.id),"Button");this.b.a().LabelText=n.label;this.b.a().Alt=n.label;this.b.a().Image16by16=n.icon["16"];this.j(this.b.a().Id,n.action);this.i(this.b.a());this.c.a().b(this.b);this.b=null},startBuildMenu:function(n){if(CommandUI.a.a(this.c))this.c=new CommandUI.AddInCommands.q(n.id);else{var t=this.h(n.id);this.b=new CommandUI.AddInCommands.e(t,"FlyoutAnchor");this.k(this.b.a(),n);this.b.a().Image16by16=n.icon["16"];this.b.a().Command=798637440}},addMenuItem:function(n){Diag.a.a(17085953,220,50,"ContextMenu menu item actiontype: {0}.",n.actionType);var t=new CommandUI.AddInCommands.p(this.h(n.id));this.k(t.a(),n);n.icon&&(t.a().Image16by16=n.icon["16"]);this.j(t.a().Id,n.action);this.i(t.a());this.b.b().b(t)},endBuildMenu:function(){CommandUI.a.a(this.b)?(this.d.b(this.c),this.c=null):(this.c.a().b(this.b),this.b=null)},d:null,a:function(){return this.d},j:function(n,t){this.e.a(n,t)},i:function(n){this.f.a(n)},h:function(n){return this.g.a(n)},k:function(n,t){n.LabelText=t.label;n.Alt=t.label}};CommandUI.AddInCommands.X=function(){this.d=new($$sc.r.$$(CommandUI.AddInCommands.h))};CommandUI.AddInCommands.X.prototype={b:null,c:null,d:null,a:function(){return this.d},addButton:function(){},addMenuItem:function(){},startBuildMenu:function(n){CommandUI.a.a(this.b)?this.b=new CommandUI.AddInCommands.q(n.id):this.c=new CommandUI.AddInCommands.e(n.id,"Button")},endBuildMenu:function(){CommandUI.a.a(this.c)?(this.d.b(this.b),this.b=null):this.c=null}};CommandUI.AddInCommands.F=function(n){this.b=n};CommandUI.AddInCommands.F.prototype={b:null,a:function(n){return this.b+n}};CommandUI.AddInCommands.z=function(){this.e=new Common.K;this.b=new($$sc.r.$$(CommandUI.AddInCommands.k))};CommandUI.AddInCommands.z.prototype={a:null,c:0,f:!1,j:function(n){this.e.o("AddinCommandsLoadingMessageChanged",n)},l:function(n){this.e.r("AddinCommandsLoadingMessageChanged",n)},d:function(n){var t=n;return t!==this.a&&(this.a=t,this.e.m("AddinCommandsLoadingMessageChanged",null,null)),n},n:function(){this.c++;this.a||this.d($a.T)},g:function(){this.c--;this.c<=0&&(this.f?this.a!==$a.e&&this.d($a.e):this.d(null))},o:function(n){this.f=!0;n&&this.d($a.e)},i:function(){this.f=!1;this.c<=0?this.d(null):this.d($a.T)},b:null,h:function(n,t){for(var r=this.b.$$lge(),i;r.$$mn();)if(i=r.$$cu(),i.e(n,t))return i;return null},k:function(n,t,i,r){var u=new CommandUI.AddInCommands.k;u.a=n;u.c=t;u.b=i;u.d=r;this.b.b(u)},m:function(n,t){for(var r=0,u=this.b.$$lge(),i;u.$$mn();)i=u.$$cu(),i.a.getStoreType()===n&&i.a.getMarketplaceID()===t?this.b.h(r):r++}};CommandUI.AddInCommands.m=function(n,t,i){this.g=n;Common.a.b.a("AddInCommandsMissingTabIsEnabled")?(this.j=i.g(),this.i=i.e(),this.h=i.d()):(this.j=i.f(),this.i=null,this.h=null);this.k=t};CommandUI.AddInCommands.m.prototype={g:null,j:null,k:null,i:null,h:null,a:function(n){return this.g+this.k+n},f:function(n){return this.g+this.k+n},d:function(n){return n.toLowerCase()in this.j?(Diag.a.a(17306646,220,50,"Tab id: {0}.",n.toLowerCase()),this.g+this.j[n.toLowerCase()]):null},e:function(){var n,r;if(!this.i)return null;n=[];for(var i=this.i,u=i.length,t=0;t<u;++t)r=i[t],n.push(this.g+r);return n},c:function(n){var t=this.l(n);return null===t?null:t[1]},b:function(n){var t=this.l(n);return null===t?null:t[2]},l:function(n){if(this.h&&n.toLowerCase()in this.h){Diag.a.a(21017039,220,50,"Get attributes for Tab id: {0}.",n.toLowerCase());return this.h[n.toLowerCase()]}return null}};CommandUI.AddInCommands.G=function(n,t){this.d=n;this.c=t};CommandUI.AddInCommands.G.prototype={d:null,c:null,a:function(n,t){return this.c+t},b:function(){return this.d}};CommandUI.AddInCommands.H=function(n,t){this.b=new CommandUI.AddInCommands.G(n,t)};CommandUI.AddInCommands.H.prototype={b:null,a:function(){return this.b}};CommandUI.AddInCommands.J=function(n){this.c=n};CommandUI.AddInCommands.J.prototype={c:null,b:function(){return this.c},a:function(n){n.Command=this.c}};CommandUI.AddInCommands.I=function(){};CommandUI.AddInCommands.I.prototype={a:function(n,t){OfficeExt.DefaultControlActionBinder.bindAction(n,t)}};CommandUI.AddInCommands.Q=function(n,t,i,r,u,f){this.m=new($$sc.r.$$(Common.AddInTab));this.h=n;this.k=t;this.g=i;this.n=r;this.l=u;this.i=f};CommandUI.AddInCommands.Q.prototype={f:null,d:null,e:null,n:null,l:null,i:null,h:null,c:function(){return this.h},a:function(){return this.m},b:function(){return null},k:null,g:null,startBuildTab:function(n){var i=n.id,r=n.isOfficeTab?null:n.label,t;this.f=(t=new Common.AddInTab,t.id=i,t.title=r,t.isOfficeTab=n.isOfficeTab,t.groups=[],t)},startBuildGroup:function(n){var i=this.j(n.id),t;this.d=(t=new Common.AddInGroup,t.id=i,t.title=n.label,t.controls=[],t)},addButton:function(n){var i=this.j(n.id),t,r;i&&(this.p(i,n.action),Diag.a.a(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",n.actionType),r=(t=new Common.AddInControl,t.id=i,t.title=n.label,t.iconLocation=this.o(n),t.controlType=0,t.attributes=this.q(),t),this.i.c(new Common.b(i,this.g.b().toString())),this.d.controls.push(r))},startBuildMenu:function(n){var i=this.j(n.id),t;i&&(this.e=(t=new Common.AddInControl,t.id=i,t.title=n.label,t.iconLocation=this.o(n),t.controlType=1,t.attributes={},t.menuItems=[],t))},addMenuItem:function(n){var i=this.j(n.id),t,r;i&&(this.p(i,n.action),Diag.a.a(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",n.actionType),r=(t=new Common.AddInMenuItem,t.id=i,t.title=n.label,t.iconLocation=this.o(n),t.attributes=this.q(),t),this.i.c(new Common.b(i,this.g.b().toString())),this.e.menuItems.push(r))},endBuildMenu:function(){CommandUI.a.a(this.e.id)||this.d.controls.push(this.e);this.e=null},endBuildGroup:function(){this.s();CommandUI.a.a(this.d.id)||this.f.groups.push(this.d);this.d=null},endBuildTab:function(){CommandUI.a.a(this.f.id)||this.m.b(this.f);this.f=null},q:function(){var n={};return this.r(n),n},o:function(n){return n.icon["80"]?n.icon["80"]:n.icon["32"]},r:function(n){this.g.a(n)},j:function(n){return this.h.a(n)},p:function(n,t){this.k.a(n,t)},s:function(){var n=this.d.controls.length;if(n>6){Diag.a.a(24786645,220,10,"Addin commands does not support {0} controls in a single group",n);this.l.setErrorMessageForAddin(this.n,$a.y);throw Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls in a single group",n));}}};CommandUI.AddInCommands.d=function(){};CommandUI.AddInCommands.d.b=function(){return CommandUI.AddInCommands.d.a||(CommandUI.AddInCommands.d.a=new CommandUI.AddInCommands.d),CommandUI.AddInCommands.d.a};CommandUI.AddInCommands.d.prototype={a:function(n,t){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(n,t.a())}};CommandUI.AddInCommands.f=function(n){this.d=n};CommandUI.AddInCommands.f.prototype={d:null,a:function(){return this.d},b:function(n){return this.d.insertOsfControl(n)},c:function(n,t){this.d.isAddinCommandsAsync(n,t)}};CommandUI.AddInCommands.bs=function(n,t){this.q=new($$sc.r.$$(CommandUI.AddInCommands.r));this.h=n;this.p=t};CommandUI.AddInCommands.bs.prototype={d:null,e:null,a:function(){return null},h:null,c:function(){return this.h},p:null,b:function(){return this.q},startBuildTab:function(n){var t=n.isOfficeTab?this.h.d(n.id):this.h.f(n.id);this.d=new CommandUI.AddInCommands.r(t)},startBuildGroup:function(n){var t=this.j(n.id);this.e=new CommandUI.AddInCommands.n(t)},addButton:function(n){var t=this.j(n.id);this.u(t,n.action)},startBuildMenu:function(){},addMenuItem:function(n){var t=this.j(n.id);this.u(t,n.action)},endBuildMenu:function(){},endBuildGroup:function(){this.d.i().b(this.e);this.e=null},endBuildTab:function(){CommandUI.a.a(this.d.b)||this.q.b(this.d);this.d=null},u:function(n,t){this.p.a(n,t)},j:function(n){return this.h.a(n)}};CommandUI.AddInCommands.T=function(n,t,i,r,u,f){CommandUI.AddInCommands.T.initializeBase(this,[n,t]);this.l=i;this.m=r;this.o=u;this.n=f};CommandUI.AddInCommands.T.prototype={i:null,f:null,g:null,o:null,n:null,m:null,l:null,startBuildTab:function(n){var t,i,r;CommandUI.AddInCommands.bs.prototype.startBuildTab.call(this,n);this.d.c=n.isOfficeTab;this.d.c?this.d.b&&(t=this.h.c(n.id),t&&(this.d.a().Title=t),i=this.h.b(n.id),i&&(this.d.a().Keytip=i)):this.d.a().Title=this.k(n.label);r=this.d.b;this.d.e=r+".Scaling";this.d.d=r+".Groups"},startBuildGroup:function(n){CommandUI.AddInCommands.bs.prototype.startBuildGroup.call(this,n);this.e.a().Title=this.k(n.label)},addButton:function(n){CommandUI.AddInCommands.bs.prototype.addButton.call(this,n);Diag.a.a(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",n.actionType);var t=this.t(n,"Button");this.r(t.a());this.e.b().b(t)},startBuildMenu:function(n){this.i=this.t(n,"FlyoutAnchor")},addMenuItem:function(n){CommandUI.AddInCommands.bs.prototype.addMenuItem.call(this,n);Diag.a.a(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",n.actionType);var i=this.j(n.id),t=new CommandUI.AddInCommands.p(i);this.s(t.a(),n);this.r(t.a());this.i.b().b(t)},endBuildMenu:function(){this.e.b().b(this.i);this.i=null},endBuildGroup:function(){this.v();this.d.j().b(this.f);this.g&&(this.d.j().b(this.g),this.g=null);this.f=null;CommandUI.AddInCommands.bs.prototype.endBuildGroup.call(this)},r:function(n){this.l.a(n)},t:function(n,t){var r=this.j(n.id),i=new CommandUI.AddInCommands.e(r,t);return this.s(i.a(),n),i},s:function(n,t){n.LabelText=this.k(t.label);n.Alt=this.k(t.label);n.Image16by16=t.icon["16"];n.Image32by32=t.icon["32"]},v:function(){var i=this.m.a(this.e),n,t;this.e.g(i.b());n=this.e.b().e.length;Diag.a.a(17085956,220,50,"Control count: {0}.",n);t=this.e.a().Id;this.f=new CommandUI.AddInCommands.i("MaxSize");this.f.a().Id=t+".Scaling.MaxSize";this.f.a().GroupId=this.e.a().Id;n>2&&(this.g=new CommandUI.AddInCommands.i("Scale"),this.g.a().Id=t+".Scaling.Scale",this.g.a().GroupId=this.e.a().Id);this.w(n,i)},w:function(n,t){var u=1,i,r;switch(n){case 1:case 2:this.f.a().Size="Large";break;case 3:this.f.a().Size="Large";this.g.a().Size="Medium";break;case 4:this.f.a().Size="MediumTwoRow";this.g.a().Size="SmallTwoRow";break;case 5:case 6:this.f.a().Size="Medium";this.g.a().Size="Small";break;default:Diag.a.a(9041819,220,10,"Addin commands does not support {0} controls.",n);this.n.setErrorMessageForAddin(this.o,$a.y);throw Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",n));}for(i=this.e.b().$$lge();i.$$mn();)r=i.$$cu(),r.a().TemplateAlias=t.a(r,u),u+=n!==3?1:2},k:function(n){return n?(n=Common.d.i(n,"&","&amp;"),n=Common.d.i(n,"'","&apos;"),n=Common.d.i(n,'"',"&quot;"),n=Common.d.i(n,">","&gt;"),Common.d.i(n,"<","&lt;")):null}};CommandUI.AddInCommands.V=function(n,t){this.f=n;this.d=new CommandUI.AddInCommands.I;this.e=new CommandUI.AddInCommands.J(t)};CommandUI.AddInCommands.V.prototype={f:null,d:null,e:null,a:function(n){var t=new CommandUI.AddInCommands.F(n);return new CommandUI.AddInCommands.E(t,this.e,this.d)},c:function(n,t,i){var r=new CommandUI.AddInCommands.m(this.f,n,i),u=new CommandUI.AddInCommands.H(this.f+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new CommandUI.AddInCommands.T(r,this.d,this.e,u,n,t)},b:function(n,t,i,r){var u=new CommandUI.AddInCommands.m(this.f,n,i);return new CommandUI.AddInCommands.Q(u,this.d,this.e,n,t,r)}};CommandUI.AddInCommands.O.b.registerClass("CommandUI.AddInCommands.O.b",null,CommandUI.AddInCommands.bk);CommandUI.AddInCommands.N.registerClass("CommandUI.AddInCommands.N",Sys.EventArgs);CommandUI.AddInCommands.y.registerClass("CommandUI.AddInCommands.y");CommandUI.AddInCommands.k.registerClass("CommandUI.AddInCommands.k");CommandUI.AddInCommands.AddinCommandsUILessDialog.registerClass("CommandUI.AddInCommands.AddinCommandsUILessDialog",CommonUI.b);CommandUI.AddInCommands.r.registerClass("CommandUI.AddInCommands.r");CommandUI.AddInCommands.n.registerClass("CommandUI.AddInCommands.n");CommandUI.AddInCommands.i.registerClass("CommandUI.AddInCommands.i");CommandUI.AddInCommands.P.registerClass("CommandUI.AddInCommands.P");CommandUI.AddInCommands.x.registerClass("CommandUI.AddInCommands.x");CommandUI.AddInCommands.x.a.registerClass("CommandUI.AddInCommands.x.a",Sys.EventArgs);CommandUI.AddInCommands.W.registerClass("CommandUI.AddInCommands.W");CommandUI.AddInCommands.v.registerClass("CommandUI.AddInCommands.v",CommonUI.b);CommandUI.AddInCommands.z.registerClass("CommandUI.AddInCommands.z");CommandUI.AddInCommands.bs.registerClass("CommandUI.AddInCommands.bs");CommandUI.AddInCommands.T.registerClass("CommandUI.AddInCommands.T",CommandUI.AddInCommands.bs);CommandUI.AddInCommands.b.a=["PrimaryCommandSurface","ContextMenu"];CommandUI.AddInCommands.b.d=null;CommandUI.AddInCommands.b.b=null;CommandUI.AddInCommands.b.c=null;CommandUI.AddInCommands.c.a=null;CommandUI.AddInCommands.a.a=null;CommandUI.AddInCommands.a.b=null;CommandUI.AddInCommands.d.a=null;Type.registerNamespace("_Ewa");_Ewa.BH=function(){};_Ewa.BH.a=function(){Common.z.a("")};_Ewa.BH.a();Type.registerNamespace("_Ewa");_Ewa.BN=function(){};_Ewa.BN.a=function(){Common.z.a(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}")};_Ewa.BN.a();Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.j=function(){};Common.App.AppsForOfficeCommon.n=function(){};Common.App.AppsForOfficeCommon.n.registerInterface("Common.App.AppsForOfficeCommon.n");Common.App.AppsForOfficeCommon.o=function(){};Common.App.AppsForOfficeCommon.q=function(){};Common.App.AppsForOfficeCommon.q.registerInterface("Common.App.AppsForOfficeCommon.q");Common.App.AppsForOfficeCommon.r=function(){};Common.App.AppsForOfficeCommon.t=function(){};Common.App.AppsForOfficeCommon.m=function(){};Common.App.AppsForOfficeCommon.m.prototype={c:null,a:function(n){if(this.c){n&&n(this.c);return}this.f(n)}};Common.App.AppsForOfficeCommon.a=function(){};Common.App.AppsForOfficeCommon.a.prototype={a:0,b:function(n){var t={},i;t.callback=n;t.refresh=Common.App.AppsForOfficeCommon.b.b().b("refreshRequired")==="true";i=Common.a.c().b(860152194,2,t)}};Common.App.AppsForOfficeCommon.i=function(n){this.l=Function.createDelegate(this,this.q);this.k=Function.createDelegate(this,this.o);this.m=Function.createDelegate(this,this.r);this.h=n;this.i=!1};Common.App.AppsForOfficeCommon.i.prototype={e:null,g:null,f:null,h:null,j:null,i:!1,a:function(){return this.e},b:function(){return this.g},c:function(n){this.i||(this.i=!0,this.j=n,this.s())},d:function(){Common.App.AppsForOfficeCommon.a.a.a&&Common.App.AppsForOfficeCommon.a.a.a!==4||(Common.App.AppsForOfficeCommon.a.a.a=1,Common.App.AppsForOfficeCommon.a.a.b(this.m));this.h&&!this.e&&this.h.a(this.k)},s:function(){var n={},t;n.callback=this.l;t=Common.a.c().b(741381681,2,n)},q:function(n,t){var i,r;if(Object.getType(t)===String&&(i=t.toString().split("|"),i.length>=5)){var u=i[0],f=i[1],e=i[2],o=i[3],s=i[4];u&&this.e&&u in this.e&&(r=this.e[u],r.installed=!0,r.ver=f,r.cm=e,r.currentStoreType=o,r.appst=s)}},r:function(n){if(n){var t=n;if(t.errorCode||(this.f=t.value,this.e&&this.n(this.f)),!t.errorCode||t.errorCode===-1){Common.App.AppsForOfficeCommon.a.a.a=2;return}if(t.errorCode===-2147208619){Common.App.AppsForOfficeCommon.a.a.a=4;return}}Common.App.AppsForOfficeCommon.a.a.a=3},o:function(n){n&&(this.p(n),this.f&&this.n(this.f));this.j&&this.j()},p:function(n){var t,i,r;if(this.e={},this.g=[],n&&n.length>0)for(t=0;t<n.length;t++)i=n[t],i.installed=!1,r=i.assetId,this.e[r]=i,Array.add(this.g,r)},n:function(n){var t,u,i;if(this.e&&n)for(var f=n,e=f.length,r=0;r<e;++r)t=f[r],u=t[1],u in this.e&&(i=this.e[u],i.installed=!0,i.title=t[0],i.desc=t[2],i.appst=t[3],i.ver=t[4],i.currentStoreType=t[6],i.icon96=t[9],i.cm=t[11],i.assetStoreId=t[12])}};Common.App.AppsForOfficeCommon.k=function(n,t,i,r){this.h=Function.createDelegate(this,this.l);this.d=n;this.g=t;this.f=i;this.e=r};Common.App.AppsForOfficeCommon.k.prototype={f:null,d:null,g:null,b:null,c:null,e:null,l:function(n,t){var r,o,s,i,f,l,h,a,e,c;if(n||!t){if(this.c){for(r=0;r<this.c.c();r++)o=this.c.d(r),o(null),o=null;this.c=null}return}if(t.c===200&&t.b){var u=t.b,v=u.lastChild,y=Common.App.AppsForOfficeCommon.d.c(v);for(this.b=new Common.Collections.a(null),s=[],i=u.getElementsByTagName("app"),i&&i.length||(i=u.getElementsByTagName("o:app")),f=0;i&&f<i.length;f++)l=i[f],h=Common.App.AppsForOfficeCommon.d.a(l),this.b.b(h),Array.add(s,h);this.b.c()?(this.k(this.b),a=Sys.Serialization.JavaScriptSerializer.serialize(s),this.d.c(this.f,a,y)):Diag.a.a(6070471,344,50,"Response doesn't contain any preinstalled Apps: {0}",u.xml)}else t.a?Diag.a.a(6070472,344,15,"Error when requesting Apps data: {0}",t.a):Diag.a.a(6070473,344,15,"Error when requesting Apps data, status code: {0}",t.c);if(this.c){for(e=0;e<this.c.c();e++)c=this.c.d(e),c(this.b),c=null;this.c=null}},a:function(n){if(!Common.et.a()){n&&n(null);return}if(this.b){n&&n(this.b);return}try{var r=this.d.a(this.f,!0),u=Sys.Serialization.JavaScriptSerializer.deserialize(r),t,i;(i=Common.App.AppsForOfficeCommon.d.e(u,t={val:this.b}),this.b=t.val,i)||this.d.b(this.f)}catch(f){this.b=null}if(this.b){this.k(this.b);n&&n(this.b);return}if(!this.c){this.c=new Common.Collections.a(null);n&&this.c.b(n);this.g.a(0,this.h);return}if(this.c){n&&this.c.b(n);return}},i:function(n,t){var i,r,f,e,u;return t?(e=this,r=function(){n.iconLoaded32=!0},i=this.e(n.icon32)):(f=this,r=function(){n.iconLoaded16=!0},i=this.e(n.icon16)),i&&(u=this,i.e(function(t,i){u.m(t,i,n,r)})),i},m:function(n,t,i,r){t.a&&i&&r()},k:function(n){for(var t,r=n.a,i=0;i<r.length;i++)t=r[i],this.e&&(!t.iconLoaded16&&t.icon16&&(t.icon16=this.j(t.icon16),this.i(t,0)),!t.iconLoaded32&&t.icon32&&(t.icon32=this.j(t.icon32),this.i(t,1)))},j:function(n){return document.URL.toLowerCase().startsWith("https://")||n.toLowerCase().startsWith("https://")&&(n="http"+n.substring(5,n.length)),n}};Common.App.AppsForOfficeCommon.e=function(){};Common.App.AppsForOfficeCommon.e.prototype={a:null};Common.App.AppsForOfficeCommon.l=function(n,t,i){this.h=Function.createDelegate(this,this.j);this.i=Function.createDelegate(this,this.l);this.b=n;this.c=t;this.f=i};Common.App.AppsForOfficeCommon.l.prototype={b:null,c:null,d:null,e:0,f:null,a:function(n,t){t&&(this.d=t,this.e=n,this.k(n,this.f,this.i,this.h))},g:function(n){this.d(this.e,n)},j:function(n){n&&n.b&&n.b.b?(Diag.a.a(6070474,344,15,"Failure request."),this.g(new Common.App.AppsForOfficeCommon.f(n.b.c,n.b.b,null))):(Diag.a.a(6070475,344,15,"Failure request."),this.g(null))},l:function(n){this.g(new Common.App.AppsForOfficeCommon.f(n.b.c,n.b.b,n.b.h))},k:function(n,t,i,r){if(n)Diag.a.a(6070477,344,15,"The request datatype is not supported.  {0}",{dataType:n});else if(this.b&&this.c&&t){var u=this.b.d.WebServiceBase;this.c.a(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",u,Common.a.j,t),1,"",null,!0,2,i,r,null,null,!1,null,null,null,null,!1)}else Diag.a.a(6070476,344,10,"The request objects are not available")}};Common.App.AppsForOfficeCommon.f=function(n,t,i){this.c=n;this.a=t;this.b=i};Common.App.AppsForOfficeCommon.f.prototype={c:0,a:null,b:null};Common.App.AppsForOfficeCommon.d=function(){};Common.App.AppsForOfficeCommon.d.b=function(n,t){var r=n.prefix+":",i=n.attributes.getNamedItem(r+t);return i?i.nodeValue:""};Common.App.AppsForOfficeCommon.d.d=function(n){var t="0";switch(n){case"1":t="1";break;case"2":t="0";break;case"4":t="1";break;default:Diag.a.a(6850688,344,15,"Omex App SubType is invalid: {0}.",n)}return t};Common.App.AppsForOfficeCommon.d.c=function(n){var t=0;try{t=Number.parseInvariant(Common.App.AppsForOfficeCommon.d.b(n,"rr"))}catch(i){Diag.a.a(6070478,344,15,"Error parsing server response for a preinstalled apps node: {0}.",i.message);t=0}return t===Number.NaN?0:t};Common.App.AppsForOfficeCommon.d.a=function(n){var i=new Common.App.AppsForOfficeCommon.j,r;try{if(n.attributes&&n.attributes.length>0){for(r=0;r<n.attributes.length;r++){var t=n.attributes.item(r),f=t.localName,u=t.baseName?t.baseName:f;if(t&&u)switch(u){case"title":i.title=t.nodeValue;break;case"assetid":i.assetId=t.nodeValue;break;case"cm":i.cm=t.nodeValue;break;case"ver":i.ver=t.nodeValue;break;case"appst":i.appst=Common.App.AppsForOfficeCommon.d.d(t.nodeValue);break;case"defhei":i.defhei=t.nodeValue;break;case"defwid":i.defwid=t.nodeValue;break;case"smallicon":i.icon16=t.nodeValue;break;case"medicon":i.icon32=t.nodeValue;break;case"largeicon":i.icon64=t.nodeValue;break;case"desc":i.desc=t.nodeValue;break;case"ldesc":i.lDesc=t.nodeValue}}i.iconLoaded16=!1;i.iconLoaded32=!1}}catch(e){Diag.a.a(6070479,344,15,"Error parsing server response for a preinstalled app node: {0}.",e.message)}return i};Common.App.AppsForOfficeCommon.d.e=function(n,t){var r,i;if(t.val=null,!n)return!1;for(t.val=new Common.Collections.a(null),r=0;r<n.length;r++){if(i=n[r],!i.assetId||!i.ver||!i.cm||!i.appst)return t.val=null,!1;t.val.b(i)}return!0};Common.App.AppsForOfficeCommon.c=function(n){this.g=Function.createDelegate(this,this.h);Common.App.AppsForOfficeCommon.c.initializeBase(this);this.d=n};Common.App.AppsForOfficeCommon.c.b=function(){return Common.App.AppsForOfficeCommon.c.a||(Common.App.AppsForOfficeCommon.c.a=new Common.App.AppsForOfficeCommon.c(Common.App.AppsForOfficeCommon.e.a.a)),Common.App.AppsForOfficeCommon.c.a};Common.App.AppsForOfficeCommon.c.prototype={d:null,b:null,e:0,f:function(n){this.d&&this.i(n)},i:function(n){this.b||(this.b=[]);n&&Array.add(this.b,n);this.e||(this.e=1,this.d.a(this.g))},h:function(n){var t,i;for(this.e=n?2:3,this.c=n?n.a:null,t=0;t<this.b.length;t++)i=this.b[t],i(this.c);this.b=null}};Common.App.AppsForOfficeCommon.j.registerClass("Common.App.AppsForOfficeCommon.j");Common.App.AppsForOfficeCommon.m.registerClass("Common.App.AppsForOfficeCommon.m",null,Common.App.AppsForOfficeCommon.n);Common.App.AppsForOfficeCommon.c.registerClass("Common.App.AppsForOfficeCommon.c",Common.App.AppsForOfficeCommon.m);Common.App.AppsForOfficeCommon.a.a=new Common.App.AppsForOfficeCommon.a;Common.App.AppsForOfficeCommon.e.a=new Common.App.AppsForOfficeCommon.e;Common.App.AppsForOfficeCommon.c.a=null;Type.registerNamespace("_Ewa");_Ewa.rr=function(n,t){this.b=n;this.c=t};_Ewa.rr.prototype={b:null,c:null,a:function(n){var t,i;if(isNullOrUndefined(n))return null;if(t=null,n==="gridMenuId")t="ContextMenuCell";else return null;return i=this.b.b(),this.e(i,t),i},e:function(n,t){for(var f=this.c.a(t),i=f.$$lge(),u;i.$$mn();)for(var e=i.$$cu(),o=e.a(),r=o.$$lge();r.$$mn();)u=r.$$cu(),this.d(n,u)},d:function(n,t){var r=t.a().Id,o=t.a().Alt,u=t.a().Image16by16,f="Image16by16",e=t.a().Command,i;CommandUI.a.a(u)&&(f="None");t.b().e.length>0?(e=798637440,i=this.b.e(r,r,o,e),i.l(f,u,null),this.f(i.b(),t),Array.add(n.a(),i)):Array.add(n.a(),this.b.f(r,o,e,u,f,null,!1))},f:function(n,t){for(var r=null,u=this.b.b(),f=t.b().$$lge();f.$$mn();){var i=f.$$cu(),s=i.a().Id,h=i.a().Alt,e=i.a().Image16by16,o="Image16by16",c=i.a().Command;CommandUI.a.a(e)&&(o="None");r=this.b.f(s,h,c,e,o,null,!1);Array.add(u.a(),r)}Array.add(n.a(),u)}};_Ewa.lx=function(){};_Ewa.lx.a=function(n,t,i,r,u){var f=n.a(9,null);return f.sharedInfo=t,_Ewa.f.a(n,"InsertAgaveTaskpane",f,i,r,u,0,null)};_Ewa.rs=function(n,t){var i,r;this.i=Function.createDelegate(this,this.n);this.j=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.p);_Ewa.rs.initializeBase(this,[!1]);this.a=t;this.b=n;this.l=n.n()+"OfficeAddinLabel-Medium14";i=this;this.b.a().c(_Ewa.bA,28,function(n){i.d=n;n.g(i)});this.b.c().f(this.k);this.a.j(this.j);r=this;this.b.a().c(_Ewa.lF,201,function(n){r.e=n;n.a(r.i)})};_Ewa.rs.prototype={a:null,b:null,l:null,d:null,e:null,h:function(n){this.cG("LAC",n)},g:function(n){this.cH("LAC",n)},c:function(n,t){var i,r;return n!=="QueryAddinLabel"?!1:(t[CommandUI.Controls.b.LabelText]!==this.a.a&&(i=CommandUI.AddInCommands.l.a(this.a),t[CommandUI.Controls.b.LabelText]=i.a,t[CommandUI.Controls.b.Visible]=i.b,r=this,window.setTimeout(function(){r.m()},0)),!0)},f:function(){return!0},m:function(){CommandUI.AddInCommands.l.b(this.a,this.b.p(),this.l,_Ewa.b.a().a(170),_Ewa.b.a().a(171))},dispose:function(){this.b.c().h(this.k);this.a.l(this.j);this.e&&(this.e.b(this.i),this.e=null);this.d&&(this.d.b(this),this.d=null);this.b=null;this.a=null;_Ewa.cl.prototype.dispose.call(this)},n:function(){this.a&&this.a.i()},o:function(){this.cE("LAC",null,null)},p:function(n,t){var i=n.c();i||t&&t.a||this.d&&(this.d.b(this),this.d=null)}};_Ewa.rt=function(){this.j={tabhome:"Ribbon.Home",tabinsert:"Ribbon.Insert",tabdata:"Ribbon.Data",tabreview:"Ribbon.Review",tabview:"Ribbon.View"};this.i={tabpagelayoutexcel:["Ribbon.PageLayoutExcel",_Ewa.b.a().a(1170),_Ewa.b.a().a(1174)],tabformulas:["Ribbon.Formulas",_Ewa.b.a().a(1171),_Ewa.b.a().a(1175)],tabdeveloper:["Ribbon.Developer",_Ewa.b.a().a(1172),_Ewa.b.a().a(1176)],tabaddins:["Ribbon.AddIns",_Ewa.b.a().a(1173),_Ewa.b.a().a(1177)]};this.k=["Ribbon.Home","Ribbon.Insert","Ribbon.PageLayoutExcel","Ribbon.Formulas","Ribbon.Data","Ribbon.Review","Ribbon.View","Ribbon.Developer","Ribbon.AddIns"]};_Ewa.rt.prototype={h:null,b:function(){return"SourceControlId"},a:function(){return"Workbook"},c:function(){return"DesktopFormFactor"},f:function(){return this.j},g:function(){var t,r,e;if(this.h)return this.h;this.h={};for(var u=Object.keys(this.j),o=u.length,n=0;n<o;++n)t=u[n],this.h[t]=this.j[t];for(var f=Object.keys(this.i),s=f.length,i=0;i<s;++i)r=f[i],e=this.i[r],this.h[r]=e[0];return this.h},e:function(){return this.k},d:function(){return this.i}};_Ewa.ru=function(n,t,i,r,u,f,e){this.i=Function.createDelegate(this,this.t);this.a=n;isNullOrUndefined(t)&&Diag.a.a(34936844,220,10,String.format("AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",_Ewa.bz.a(!0,null)));this.b=t;this.g=i;this.d=r;this.c=u;this.f=new _Ewa.rt;this.e=f;this.h=e;Common.cz.a="WAC_Excel"};_Ewa.ru.prototype={g:null,c:null,f:null,d:null,e:null,h:null,a:null,b:null,dispose:function(){Diag.a.a(34936845,220,50,String.format("AddinUICommandHandler Dispose. Stack: {0}",_Ewa.bz.a(!0,null)));this.e.dispose();this.e=null;this.a=null;this.b=null},r:function(){return!1},p:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u=t.a,f,e;switch(u){case 843847158:break;case-2025863019:f=i.ak1.toString();e=this;CommandUI.AddInCommands.a.c(f,function(){_Ewa.c.a(e.a).m()});break;case-1777565636:_Ewa.dl.d(i.OsfcontrolId.toString());break;case 1592314317:_Ewa.dl.c(i.OsfcontrolId.toString());break;case 1402209562:r=this.s(i);break;case 407117407:this.k(i);break;case 1782110672:this.l(i);break;case 516359383:this.e.m();break;case 543799107:this.u();break;default:r=_Ewa.E.a(u)}return r},o:function(n,t){var i=!1;switch(t.a){case 843847158:case-2025863019:case-1777565636:case 1592314317:case 1402209562:case 407117407:case 1782110672:case 516359383:case 543799107:i=!0}return i},q:function(){return!1},u:function(){var n,t,i,r;if(this.c.c<=0&&(this.c.i(),n=this.n(),n&&n.e.length>0))for(t=n.$$lge();t.$$mn();)i=t.$$cu(),r={ack1:i,ack0:4,ak0:(new Date).getTime()},this.l(r)},l:function(n){Diag.a.a(17408928,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",n.ack0,n.ack1);this.c.n();var t=this;window.setTimeout(function(){var i=new CommandUI.AddInCommands.x(new CommandUI.AddInCommands.f(t.b.a()),CommandUI.AddInCommands.d.b(),CommandUI.AddInCommands.c.b());i&&(i.g(function(n,i){t.k(i.a)}),i.i(n))},0)},k:function(n){var t,i,r,u;Diag.a.a(17306637,220,50,"LaunchOperationType {0}.",n.ack0);try{if(isNullOrUndefined(this.b)){Diag.a.a(34936846,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",_Ewa.bz.a(!0,null)));return}t=new CommandUI.AddInCommands.O(this.f,this.g,new CommandUI.AddInCommands.f(this.b.a()),new CommandUI.AddInCommands.V(this.a.n(),1402209562),this.c,CommandUI.AddInCommands.d.b(),new CommandUI.AddInCommands.w);t.a(this.i);i=this.a.a().a(_Ewa.fd,53);i.a()&&(_Ewa.s.a().a()?(r=this,Common.App.AppLifecycleManager.get_instance().a(5,null,3).CW(function(){_Ewa.n.c(54,4,!1).CW(function(){t.c(r.h,r.a.p(),n)})})):(u=$$as(CommandUI.g,i.a().a()),t.b(u,this.a.p(),n)))}catch(f){Diag.a.a(17651478,220,10,String.format("LaunchAddinCommands error message : {0}.",f.message))}},s:function(n){var t=$$sc.a.a(Boolean,!0),i=n[this.f.b()],r=this.d.a()(i),u=new _Ewa.dl(this.a,this.b,r.ownerAddinInfo,t,null);return this.j(t,i,r,u)},j:function(n,t,i,r){var o=this,u=function(){n=r.g()},f=this,e=function(){_Ewa.c.a(f.a).m()};return this.d.c(t,this.c,r,new CommandUI.AddInCommands.f(this.b.a()),i,u,e),n},m:function(n){var r=$$sc.a.a(Boolean,!0),u=this.d.b(),i=n.assetId in u?u[n.assetId]:null,o;if(i){var f=this.d.a()(i),e=new _Ewa.dl(this.a,this.b,f.ownerAddinInfo,r,null),t={};t.appVersion=n.appVersion;t.assetId=n.assetId+"Office.AutoShowTaskpaneWithDocument";t.storeId=n.storeId;t.storeType=OSF.StoreType.InMemory;t.targetType=OSF.OsfControlTarget.TaskPane;o=this;e.h(t,function(n){for(var s,h,t={},c=n,l=c.length,u=0;u<l;++u)s=c[u],t[s[0]]=s[1];h="Office.AutoShowTaskpaneWithDocument"in t?t["Office.AutoShowTaskpaneWithDocument"]:null;h&&h.toLowerCase()==="true"&&o.j(r,i,f,e)})}},t:function(n,t){if(this.a.J(),this.a.b(185)&&t){var i=t;i.a&&this.m(i.a)}},n:function(){var n=new($$sc.r.$$(Common.ca));return this.a.b(91)&&(this.a.c().b().a(27)&&n.b(0),this.a.c().b().a(33)&&n.b(1),n.b(8)),n}};_Ewa.ly=function(n){_Ewa.ly.initializeBase(this,[n])};_Ewa.ly.a=function(n){_Ewa.Q.a(194,new _Ewa.ly(n))};_Ewa.ly.prototype={m:null,k:function(){var n=this,t=this,i=this;_Ewa.de.a(this.h).a(new _Ewa.ly.b(function(){return n.h.c().k()&&!!(n.h.s()&16384)&&n.h.q()},function(){return t.o()},function(){i.p()}))},o:function(){var t=new($$sc.A.$$(_Ewa.fd)),s=this;this.h.a().c(_Ewa.fd,53,function(n){t.b(n)});var u=t.a,i=new CommandUI.AddInCommands.D,r=new CommandUI.AddInCommands.z,f=new _Ewa.rs(this.h,r),e=_Ewa.k.a(Sys.IDisposable,this.h.a(),198,this.cF()),o=this.r(i),n=this;return _Ewa.d.cw(_Ewa.d.ws([u,e,o],this.cF(),3),function(){_Ewa.d.cw(_Ewa.k.a(_Ewa.bn,n.h.a(),102,n.cF()),function(t){var u=t.a();n.m=new _Ewa.ru(n.h,u,i,new CommandUI.AddInCommands.s,r,f,Common.Utils.a.a().d(Common.dl));n.l([n.m],null);n.h.a().b(_Ewa.gJ,193,n.m)},n.cF(),3)},this.cF(),3)},p:function(){this.h.f().e(this.m);this.m.dispose();this.m=null;this.h.a().e(_Ewa.jY,199);this.h.a().e(_Ewa.gJ,193);_Ewa.D.b(_Ewa.Gv.$$(_Ewa.gJ),_Ewa.oH.$$(_Ewa.gJ),21,this.h.a(),193)},r:function(n){var t=_Ewa.k.a(_Ewa.dY,this.h.a(),98,this.cF()),i=this;return _Ewa.d.cw(t,function(){var r=t.a();i.h.a().b(_Ewa.jY,199,new _Ewa.rr(r,n))},this.cF(),3)}};_Ewa.ly.b=function(n,t,i){this.g=n;this.e=t;this.f=i};_Ewa.ly.b.prototype={g:null,e:null,f:null,a:function(){return 1},b:function(){return this.g()},c:function(){return this.e()},d:function(){this.f()},dispose:function(){this.g=null;this.e=null;this.f=null}};_Ewa.dl=function(n,t,i,r,u){_Ewa.dl.initializeBase(this);this.c=n;this.a=t;this.d=i;this.e=u;this.b=r||$$sc.a.a(Boolean,!0)};_Ewa.dl.d=function(n){_Ewa.dl.a.b(n)&&_Ewa.dl.a.a(n).c()};_Ewa.dl.c=function(n){_Ewa.dl.a.b(n)&&_Ewa.dl.a.a(n).b()};_Ewa.dl.b=function(n,t){var i={};return i.AppVersion=n.appVersion,i.StoreId=n.storeId,i.AssetId=n.assetId,i.CurrentStoreType=t.storeType,i.TargetType=1,i.AssetStoreId="omex",i.Width=350,i.OwnerAddinAssetId=t.assetId,i.Id=i.AssetId,i};_Ewa.dl.prototype={a:null,c:null,d:null,e:null,b:null,g:function(){var n=this.b;return this.b=$$sc.a.a(Boolean,!0),n},disposeHost:function(n){this.a.A(n)},setOwnerAddinEToken:function(n){this.d.eToken=n},showTaskpane:function(n,t,i){if(Diag.a.a(17306639,220,50,"ShowTaskpane action called."),!this.a.i(n.assetId,null)){var r=this;this.b=this.f(n,function(n,t){if(!n){Diag.a.a(17306640,220,10,"ShowTaskpane: instance id is null.");i(null,t);return}n.WebExtensionOsfControlType=3;r.a.j(n);i(n.InstanceId,t)})}},h:function(n,t){var i=this.a.l(n.assetId),r;i?t(this.a.e(i).OsfPropertyBag):(r=this,this.b=this.f(n,function(n){n?t(n.OsfPropertyBag):Diag.a.a(21594332,220,10,"GetSettings: insertData is null.")}))},showDialog:function(n,t,i){Diag.a.a(17306641,220,50,"ShowDialog action called.");var u=this.c.d().a(),r=this,f=function(n){var u=n.Result,t=u?u.AgaveData:null,f;t?(f=function(){var i=function(){r.disposeHost(t.InstanceId)},n=new CommandUI.AddInCommands.v(i);return n.t("",null,null),n.u},r.a.k(t,f),i(t.InstanceId,0)):(Diag.a.a(17306642,220,10,"ShowDialog: instance id is null."),i(null,n.Errors?n.Errors[0].ErrorCause:5001))},e=_Ewa.dl.b(n,this.d),s=this,o=function(n,t){return _Ewa.lx.a(u,e,_Ewa.m.a(n,f),t,null)},h=this;this.b=_Ewa.W.a(this.c.h(),o,function(n){return new _Ewa.bg(0,n,0)},this.e)},createUILessSandbox:function(n,t,i){var r,u;if(Diag.a.a(17306643,220,50,"UILess action called."),r=this.a.l(n.assetId),r){i(r,0);return}u=this;this.b=this.f(n,function(n,t){if(!n){Diag.a.a(17306644,220,10,"UILess: instance id is null.");i(null,t);return}var r=function(){return _Ewa.dl.a.c(n.InstanceId,new CommandUI.AddInCommands.AddinCommandsUILessDialog),_Ewa.dl.a.a(n.InstanceId).a()};n.WebExtensionOsfControlType=4;u.a.k(n,r);i(n.InstanceId,t)})},f:function(n,t){var i=null,r=this.c.d().a(),h=this,f=function(n){var r=n.Result;i=r?r.AgaveData:null;i||t(null,n.Errors?n.Errors[0].ErrorCause:5001)},e=_Ewa.dl.b(n,this.d),c=this,o=function(n,t){return _Ewa.lx.a(r,e,_Ewa.m.a(n,f),t,null)},l=this,s=_Ewa.W.a(this.c.h(),o,function(n){return new _Ewa.bg(0,n,0)},this.e),u=this;return _Ewa.d.ts(s,function(){if(!i)return $$sc.a.a(Boolean,!1);var f=function(r,f){var e,o;if(r){for(i.PrimaryMarketplace.MarketplaceType=n.storeType,i.OwnerAddinAssetId=u.d.assetId,i.OsfPropertyBag=[],e=0;e<r.Settings.length;e++)o=[],o[0]=r.Settings[e].Name,o[1]=r.Settings[e].Value,i.OsfPropertyBag[e]=o;t(i,0)}else t(null,f.Errors?f.Errors[0].ErrorCause:5001)};return u.i(r,i.InstanceId,f)},$$sc.e.a,3,$$sc.c.a)},i:function(n,t,i){var f=this,r=function(n){var t=n.Result;i(t,n)},e=this,u=function(i,u){return _Ewa.cx.a(n,t,_Ewa.m.a(i,r),u,null)},o=this;return _Ewa.W.a(this.c.h(),u,function(n){return new _Ewa.bg(0,n,0)},this.e)}};_Ewa.rs.registerClass("_Ewa.rs",_Ewa.cl,_Ewa.op,Common.IRootUser);_Ewa.ly.registerClass("_Ewa.ly",_Ewa.Q);_Ewa.ly.b.registerClass("_Ewa.ly.b",null,_Ewa.iN,Sys.IDisposable);_Ewa.dl.registerClass("_Ewa.dl",CommandUI.AddInCommands.W);_Ewa.dl.a=new($$sc.s.$$(CommandUI.AddInCommands.K));Type.registerNamespace("_Ewa");_Ewa.BF=function(){};_Ewa.BF.a=function(){_Ewa.e.a(function(n){n.b(91)&&_Ewa.ly.a(n)})};_Ewa.BF.a();Type.registerNamespace("_Ewa");_Ewa.hc=function(){};_Ewa.hc.registerInterface("_Ewa.hc");_Ewa.eU=function(){};_Ewa.eU.prototype={none:0,testEvent:1,test1Event:2,worksheetDataChangedEvent:10,worksheetActivatedEvent:11,worksheetDeactivatedEvent:12,worksheetAddedEvent:13,worksheetSelectionChangedEvent:14,worksheetDeletedEvent:15,worksheetCalculatedEvent:16,chartAddedEvent:50,chartActivatedEvent:51,chartDeactivatedEvent:52,chartDeletedEvent:53,tableSelectionChangedEvent:100,tableDataChangedEvent:101,customFunctionExecutionBeginEvent:200,customFunctionExecutionEndEvent:201,invocationMessage:1e3,cancellationMessage:1001};_Ewa.eU.registerEnum("_Ewa.eU",!1);_Ewa.BK=function(){};_Ewa.BK.a=function(){_Ewa.e.a(_Ewa.nv.a);_Ewa.e.a(_Ewa.lD.a)};_Ewa.lD=function(n,t){this.m=Function.createDelegate(this,this.p);_Ewa.lD.initializeBase(this);this.h=n;this.k=t;this.k.a()&&this.k.c(this.m);n.a().b(_Ewa.Gv.$$(_Ewa.bn),102,this);this.j()};_Ewa.lD.a=function(n){new _Ewa.lD(n,Common.S.a())};_Ewa.lD.prototype={l:null,n:null,k:null,o:function(){return this.l||(this.l=new _Ewa.bF(this.h,this.n))},h:null,b:function(){if(!this.k.b()){var i=this.h.a(),t=_Ewa.k.b(_Ewa.ij,i,218,219),r=_Ewa.n.c(35,4,!1),n=this;_Ewa.d.cw(_Ewa.d.ws([t,r],this.h.k(),3),function(){n.h.b(131)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Common.App.AppsForOffice.f);n.h.c().b().a(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Common.App.AppsForOffice.f,new Common.App.AppsForOffice.k(Common.a.b.d.WebServiceBase,Common.a.h),n.h.b(149));n.n=t.a();n.i(n.o())},this.cF(),3)}},dispose:function(){System.a.a(this.l);this.l=null;this.h=null;this.k.a()&&this.k.d(this.m);this.k=null;_Ewa.cl.prototype.dispose.call(this)},p:function(){this.b()}};_Ewa.gc=function(){};_Ewa.gc.c=function(){return _Ewa.gc.a||(_Ewa.gc.a={"394":1e3,"395":1001,"396":1002,"397":1003,"398":1004,"399":1005,"400":1008,"401":2e3,"402":2001,"403":2002,"404":2003,"405":2004,"406":2005,"407":2007,"408":2008,"409":2009,"410":2002,"411":2014,"412":3002,"413":3004,"414":3005,"415":3006,"416":3007,"417":3008,"418":3009,"419":3002,"420":3010,"424":8e3,"425":8001,"426":8010,"427":8011,"428":8012,"429":8020,"430":8021,"431":8022,"432":8023,"421":4002,"423":5002,"-1000":5012,"-992":5012,"-999":5006,"-997":5012,"-996":5012,"-995":5006,"-993":5006,"75":5102,"76":5102,"77":5102,"78":5102,"79":5102,"80":5102,"81":5102})};_Ewa.gc.b=function(n){return _Ewa.p.c(_Ewa.gc.c(),n.toString(),5001)};_Ewa.jB=function(n){this.k=Function.createDelegate(this,this.n);this.i={};this.j={};this.c={};this.g={};this.b=n;this.h=this.k};_Ewa.jB.a=function(n,t){var i=new Array(6);return i[0]=n.Category,i[1]=n.Type,i[2]=n.Target,i[3]=n.Message,i[4]=n.Id,i[5]=t,i};_Ewa.jB.prototype={a:null,h:null,m:function(n){n&&(this.a||(this.a=[],this.b.bJ(this.h),this.b.bo(!0)),Array.add(this.a,n))},o:function(n){this.a&&(Array.remove(this.a,n),this.a.length||(this.b.bo(!1),this.b.cw(this.h),this.a=null))},b:null,n:function(n,t){for(var u,f,l,i,h,o,c,s,a,v,e=t.a,r=0;r<e.length;r++)switch(e[r].EventType){case 2:u=e[r];f={};f.Name=u.Name;f.BindingType=u.BindingType;f.ColCount=u.ColCount;f.RowCount=u.RowCount;this.e(u.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,f,null);break;case 4:l=e[r];this.e(l.InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(i=e[r],i.InstanceId){for(o=null,c=new Array(i.Entries.length),s=0;s<i.Entries.length;s++)c[s]=_Ewa.jB.a(i.Entries[s],i.IsRemoteOverride);i.Entries.length>0&&i.Entries[0].Category===1?(a=i.InstanceId,v=$$as(_Ewa.bF,_Ewa.cE.a(this.b)),o=v.bk(a,c)):o=i.InstanceId;o&&this.e(o,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,c)}else{for(this.c={},this.g={},h=0;h<i.Entries.length;h++)this.l(i.Entries[h],i.IsRemoteOverride);Diag.a.a(36444194,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",this.c,this.g,this.i,this.j)}}},l:function(n,t){var s=!1,i=parseInt(n.Type),c=n.Target,h=$$as(_Ewa.bF,_Ewa.cE.a(this.b)),r=h.H.i(i,c),u,f,e,o;if(r&&Object.keys(r).length>0){u=new Array(1);u[0]=_Ewa.jB.a(n,t);s=!0;f=r;for(e in f)o={key:e,value:f[e]},h.H.c(o.key)&&this.e(o.key,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}s?(this.f(_Ewa.eU.toString(i),this.c),this.f(_Ewa.eU.toString(i),this.i)):(this.f(_Ewa.eU.toString(i),this.g),this.f(_Ewa.eU.toString(i),this.j))},f:function(n,t){n in t||(t[n]=0);t[n]=t[n]+1},d:function(n,t,i){var r={};r.Target=t;r.Category=65536;r.Type=n;r.Message=i;r.Id=-1;this.l(r,!1)},e:function(n,t,i,r){var f,o,u,s,e;if(this.a&&(f=$$as(_Ewa.bF,_Ewa.cE.a(this.b)),!f||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||f.H.c(n)))for(o=new _Ewa.jx(t,n,i,r),u=0,s=this.a.length;u<s;u++)e=this.a[u],e&&e(o)}};_Ewa.lC=function(n,t){this.a=n;this.c=t};_Ewa.lC.prototype={b:null,e:function(n){n&&(this.b||(this.b=[]),Array.add(this.b,n))},f:function(n){this.b&&Array.remove(this.b,n)},a:0,c:null,g:function(n){return this.a!==n.dispid?!1:this.a===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.a===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.c===n.ddaBinding.Name:!0},d:function(n){if(this.b){var i=this,t=function(t){var i=t;i(n)};Array.forEach(this.b,t)}}};_Ewa.bF=function(n,t){this.be=Function.createDelegate(this,this.bo);this.bh=Function.createDelegate(this,this.bF);this.X=Function.createDelegate(this,this.bG);this.W=Function.createDelegate(this,this.bD);this.Y=Function.createDelegate(this,this.bH);this.bg=Function.createDelegate(this,this.C);this.bf=Function.createDelegate(this,this.bC);this.E=[];this.U=[];this.bj=[];this.P=[];_Ewa.bF.initializeBase(this,[!1]);this.D=n;this.S=t;this.bz();_Ewa.lE.a(this)};_Ewa.bF.h=function(n){if(n.getStatus()===OSF.OsfControlStatus.NotActivated&&_Ewa.bF.g(n.getStoreType())){var t=n.getManifest(),i=t.containsCustomFunctions("Workbook");if(i)return!0}return!1};_Ewa.bF.d=function(n){var t=n.getMarketplaceID(),i=n.getMarketplaceVersion(),r=_Ewa.bF.a(n.getStoreType()).toString(),u=n.getStoreLocator();return String.format("{0}!{1}!{2}!{3}!{4}!!!","1",t,i,r,u)};_Ewa.bF.f=function(n){var i=n.split("!");if(i.length<7||i[0]!=="1")return null;var r=i[1],u=i[2],f=_Ewa.bF.e(i[3]),e=i[4],o=i[5];r&&r.length||(r=o);var s=["customFunctionAddinId",n],h=[s],t={};return t.InstanceId=String.format("{{{0}}}",Common.V.a().a),t.WebExtensionOsfControlType=4,t.WebExtensionType=1,t.PrimaryMarketplace={},t.PrimaryMarketplace.SolutionId=r,t.PrimaryMarketplace.SolutionVersion=u,t.PrimaryMarketplace.MarketplaceRef=e,t.PrimaryMarketplace.MarketplaceType=f,t.OsfPropertyBag=h,t};_Ewa.bF.e=function(n){var t=parseInt(n);switch(t){case 0:return OSF.StoreType.OMEX;case 1:return OSF.StoreType.SPCatalog;case 2:return OSF.StoreType.SPApp;case 3:return OSF.StoreType.Exchange;case 4:return OSF.StoreType.FileSystem;case 5:return OSF.StoreType.Registry;default:return null}};_Ewa.bF.a=function(n){return n===OSF.StoreType.OMEX?0:n===OSF.StoreType.SPCatalog?1:n===OSF.StoreType.SPApp?2:n===OSF.StoreType.Exchange?3:n===OSF.StoreType.FileSystem?4:n===OSF.StoreType.Registry?5:-1};_Ewa.bF.g=function(n){return _Ewa.bF.a(n)>=0};_Ewa.bF.c=function(n){var t={};return t.AppVersion=n.appVersion,t.AssetId=n.assetId,t.AssetStoreId=n.assetStoreId.toString(),t.CurrentStoreType=n.currentStoreType,t.Height=n.height,t.Id=n.id,t.StoreId=n.storeId,t.TargetType=n.targetType,t.Width=t.TargetType===1?0:n.width,t};_Ewa.bF.b=function(n){return n===OSF.DDA.EventDispId.dispidSettingsChangedEvent||n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||n===OSF.DDA.EventDispId.dispidRichApiMessageEvent||n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};_Ewa.bF.prototype={I:null,J:null,K:null,Q:null,S:null,bb:!1,V:!1,bd:!1,bc:!1,M:null,o:function(n){this.cG("cd",n)},y:function(n){this.cH("cd",n)},g:function(n){this.cG("csc",n)},b:function(n){this.cH("csc",n)},n:function(n){this.cG("ca",n)},x:function(n){this.cH("ca",n)},p:function(n){this.cG("ci",n)},q:function(n){this.cG("ekros",n)},z:function(n){this.cH("ekros",n)},L:function(){if(!this.J){var n={},r=!(this.D.s()&1),t=_Ewa.n.b.a,u=this.D.j(),i=Common.y.c+Common.y.e;n.pageBaseUrl=t.LayoutsContentUrlPrefix;n.appName=OSF.AppName.ExcelWebApp;n.appVersion="16";n.clientMode=r?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;n.appUILocale=this.D.g().UICultureTag;n.dataLocale=this.D.g().DataCultureTag;n.docUrl=u.ClientUrl;n.hostControl=this;n.formFactor=OSF.FormFactor.Default;n.lcid=this.D.N().toString();n.localizedScriptsUrl=Common.y.c+Common.y.f;n.localizedImagesUrl=i;n.localizedStylesUrl=Common.y.c+Common.y.g;n.localizedResourcesUrl=i;n.osfOmexBaseUrl=t.OsfOmexBaseUrl;n.firstPartyManifestCDNUrl=t.FirstPartyAddInManifestCDN;n.devCatalogUrl=t.DevCatalogUrl;n.oneDriveCatalogBaseApiUrl=t.OneDriveCatalogBaseApiUrl;n.controlStatusChanged=this.bf;n.notifyHost=this.bg;n.allowExternalMarketplace=this.D.c().b().a(27);n.trustAgaves=this.D.b(7);n.enableAddinCommands=this.D.b(91);n.enableBlackForestRedirect=this.D.b(186);n.enableMyOrg=this.D.c().b().a(33);n.enableMyApps=this.D.c().b().a(34);n.enableDevCatalog=this.D.b(84);n.enableOneDriveCatalog=this.D.b(85);n.enablePrivateCatalog=this.bJ();n.enableTaskpaneUpgradeToAppCommand=this.D.b(202);n.showSignOutFromPrivateCatalogMessage=this.D.c().b().a(36);n.enableUploadFileDevCatalog=this.D.b(91);n.userNameHashCode=Common.d.d(Common.a.p);n.envCode=this.D.g().OfficeAddinTelemetryDataSourceCode.toString();n.enableSingleSignOnForAddin=this.D.b(174)&&Common.a.bv;n.enableServiceDeliveredExperience=this.D.b(175);n.enableSkipNewWindowNotification=this.D.b(196);n.hideAppsExtensionUrl=Common.a.cd;n.enableAnonymousUseLegacyCatalogService=this.D.b(416);this.J=new OSF.ContextActivationManager(n);this.J.setIframeAttributeBag({frameborder:0,marginheight:0,marginwidth:0});this.J.setWSA(Common.a.i)}return this.J},T:!1,H:null,R:null,ba:null,Z:null,D:null,d:function(n){var t={};return t.Name=n.Name,t.BindingType=n.BindingType,t.HasHeaders=n.HasHeaders,n.IsValidRef&&(t.ColCount=n.Reference.LastColumn-n.Reference.FirstColumn+1,t.RowCount=n.Reference.LastRow-n.Reference.FirstRow+1),t},v:function(n,t){var i=this.bt(t);this.J.launchInsertDialog(n,null,i)},w:function(n,t){var i={};i.callbackFunc=n;i.storeType=OSF.StoreTypeEnum.MarketPlace;i.fromInsertDialog=!1;i.refresh=t;this.J.queryEntitlementDetails(i)},invokeDdaMethod:function(n,t){var i=this.G(n.DdaMethod.ControlId);if(!i){this.F(5001,t);return}i.U(n,t)},registerDdaEventAsync:function(n,t,i,r,u){var f=this.G(t);if(!f){this.F(5001,u);return}if(!_Ewa.bF.b(n)){this.F(5e3,u);return}f.Y(n,i,r,u)},unregisterDdaEventAsync:function(n,t,i,r,u){var f=this.G(t);if(!f){this.F(5001,u);return}if(!_Ewa.bF.b(n)){this.F(5e3,u);return}f.bf(n,i,r,u)},dispose:function(){this.bc||(this.D.D(this.Y),this.I.h(this.W),this.I.D(this.X),this.D.e().l(this.H.f),this.S.b(this),this.D=null,this.S=null,this.K=null,this.E=null,this.U=null,this.Q&&(this.Q.dispose(),this.Q=null),System.a.a(this.R),_Ewa.cl.prototype.dispose.call(this),this.bc=!0)},m:function(n){var t=this.G(n);return t?t.Q():null},B:function(n){var t,r,i;if(this.bb!==n){for(this.bb=n,t=0,r=this.E.length;t<r;t++)i=this.E[t],n?i.D(!1):i.O();this.R.p(n)}},u:function(n){var t=this.G(n);return t?t.P():null},bG:function(){var n,u,t,f,i,r;for(this.M=this.I.I().WebExtensions,n=this.E.length-1;n>=0;--n)u=this.by(this.E[n].b.InstanceId),u||(this.E[n].L(),Array.removeAt(this.E,n));if(this.M)for(t=0,f=this.M.length;t<f;t++)i=this.M[t],r=this.G(i.WebExtensionId),r&&(r.f=i)},bC:function(n){if(_Ewa.bF.h(n)){var t=_Ewa.bF.d(n);this.bk(t,null)}else this.cE("csc",n.getID(),null)},C:function(n,t,i){var s,h,g,v,nt,u,r,tt,c,f,y,l,e,p,it,w,o,b,a,k,d;if(t===OSF.AgaveHostAction.Select)_Ewa.c.a(this.D).r(!0),this.bl(!0);else if(t===OSF.AgaveHostAction.UnSelect)this.bl(!1);else if(t===OSF.AgaveHostAction.CancelDialog)this.O(-684355545,null);else if(t===OSF.AgaveHostAction.InsertAgave)s={},h=i,h&&(s.ack5=h,s.CommandValueId=_Ewa.bF.c(h),this.O(-741808261,s));else if(t===OSF.AgaveHostAction.NotifyHostError)g={ak1:this.J.getManifestInvaildErrorString()},this.O(-2025863019,g);else if(t===OSF.AgaveHostAction.RefreshAddinCommands)this.D.b(91)&&this.D.b(98)&&this.O(543799107,null);else if(t===OSF.AgaveHostAction.CtrlF6Exit||t===OSF.AgaveHostAction.CtrlF6ExitShift){if(v=this.D.a().a(_Ewa.eH,15),!v)return;nt=this.G(n);u=nt.i;u&&u.bi();r={};r.keyCode=117;r.type="keydown";r.ctrlKey=!0;r.shiftKey=t===OSF.AgaveHostAction.CtrlF6ExitShift;r.srcElement=_Ewa.dw.isInstanceOfType(u)?u.d():_Ewa.c.a(this.D).w();tt=new Sys.UI.DomEvent(r);v.a(tt)}else if(t===OSF.AgaveHostAction.TabExit)if(c=this.G(n),f=c.i,f){if(f.s()===OSF.OsfControlTarget.InContent)f.bD();else if(f.s()===OSF.OsfControlTarget.TaskPane){if(y=this.D.a().a(_Ewa.cD,178),!y)return;y.x()}}else c&&c.l===4&&this.J.notifyAgave(n,OSF.AgaveHostAction.TabIn);else if(t===OSF.AgaveHostAction.TabExitShift)if(l=this.G(n),e=l.i,e){if(e.s()===OSF.OsfControlTarget.InContent)e.bE();else if(e.s()===OSF.OsfControlTarget.TaskPane){if(p=this.D.a().a(_Ewa.cD,178),!p)return;p.z()}}else l&&l.l===4&&this.J.notifyAgave(n,OSF.AgaveHostAction.TabIn);else if(t===OSF.AgaveHostAction.EscExit||t===OSF.AgaveHostAction.ExitNoFocusable||t===OSF.AgaveHostAction.ExitNoFocusableShift)if(it=this.G(n),w=it.i,w)w.bi();else{for(o=null,b=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.$$ge();b.$$mn();)if(a=b.$$cu(),a.a.b===n){a.a.a.i();o=a.b;break}o&&(k=this.G(o),k&&k.l!==4&&this.L().notifyAgave(o,OSF.AgaveHostAction.TabIn))}else t===OSF.AgaveHostAction.PageIsReady&&(d=this.G(n),d&&d.Z())},F:function(n,t){var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.O(-567383662,i)},N:function(n){var t={};t.DdaMethodCallback=n;this.O(-524856679,t)},O:function(n,t){var u=new _Ewa.Z(n,0,this.D.o()?2:1,0,null),r=t?t.DdaMethodCallback:null,e=this.D.f().k(n),f=this.D.f().b(u,t,null),i=this;_Ewa.d.cw(f,function(n){var t=n;_Ewa.bR.b(t)?i.F(5001,r):t.a()||(_Ewa.c.a(i.D).s()?i.F(5004,r):i.F(5001,r))},this.cF(),8)},G:function(n){if(!this.E)return null;for(var t=0,i=this.E.length;t<i;t++)if(this.E[t].b.InstanceId.startsWith(n))return this.E[t];return null},bx:function(n){if(!this.E)return null;for(var t=0,i=this.E.length;t<i;t++)if(this.E[t].z===n)return this.E[t];return null},bs:function(n,t){var i=this.G(n);i&&(i.C(t),i.u(!0))},bK:function(n,t){var i=this.G(n);i&&i.u(t)},j:function(n){var t,i;(n.WebExtensionType!==1||this.D.s()&8388608&&n.TaskpaneVisible)&&(t=new _Ewa.ex(this,this.K,n,!1).K(),Array.add(this.E,t),this.bm(n.InstanceId)||(i=String.format("{0}|{1}|{2}|{3}|{4}",n.PrimaryMarketplace.SolutionId,n.PrimaryMarketplace.SolutionVersion,n.PrimaryMarketplace.MarketplaceRef,n.PrimaryMarketplace.MarketplaceType,n.WebExtensionType),this.cE("ci",i,null)))},k:function(n,t){if(!this.G(n.InstanceId)){var i=t(),r=new _Ewa.ex(this,this.K,n,!1).J(i);Array.add(this.E,r)}},bk:function(n,t){var u=null,f=this.bx(n),r,i,e;return f?u=f.b.InstanceId:(r=_Ewa.bF.f(n),r&&(i=document.createElement("div"),i.style.display="none",e=Common.a.a().p()||document.body,e.appendChild(i),this.bw(r,i,n,t))),u},br:function(n){if(!this.G(n.InstanceId)){var t=new _Ewa.ex(this,this.K,n,!1);Array.add(this.E,t)}},A:function(n){var t,r,i,u;if(!this.E)return!1;for(t=0,r=this.E.length;t<r;t++)if(this.E[t].b.InstanceId===n)return i=this.E[t],u=i.e,Array.removeAt(this.E,t),this.bo(i),_Ewa.a.h(u),!0;return!1},r:function(n){n.bL()&&(this.G(n.a().p.InstanceId)||this.j(n.a().p),this.I.a()&&this.bs(n.a().p.InstanceId,n.i()))},l:function(n){if(this.E)for(var t=0,i=this.E.length;t<i;t++)if(this.E[t].b.WebExtensionType===1&&_Ewa.g.a(this.E[t].G(),n,!0))return this.E[t].b.InstanceId;return null},t:function(n,t){return n?t?String.format("{0}.{1}",n,t):n:""},i:function(n,t){var r=t,u=!1,i,f;if(!r&&this.E)for(i=0,f=this.E.length;i<f;i++)if(this.E[i].b.WebExtensionType===1&&_Ewa.g.a(this.E[i].G(),n,!0)){r=this.E[i].b.InstanceId;u=!0;break}return!r||this.cE("ca",r,null),u},s:function(n,t){var i=this.G(n);return i?i.A(t):null},bm:function(n){return this.bu(this.U,n)},h:function(n){Array.add(this.bj,n)},c:function(){return this.E},e:function(n){var t=this.G(n);return t?t.b:null},a:function(){return this.L()},f:function(n){this.cE("ekros",n,this)},bE:function(n){var i,t;n&&(i=this.G(n.InstanceId),i&&(this.A(i.b.InstanceId),this.L().purgeOsfControl(i.b.InstanceId,!1),t={},t.Id=n.PrimaryMarketplace.SolutionId,t.TargetType=n.WebExtensionType,t.AppVersion=n.PrimaryMarketplace.SolutionVersion,t.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType,t.StoreId=n.PrimaryMarketplace.MarketplaceRef,t.AssetId=n.PrimaryMarketplace.SolutionId,t.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,t.Width=n.TaskpaneWidth,this.bp(t)))},bw:function(n,t,i,r){if(!this.G(n.InstanceId)){var u=new _Ewa.ex(this,this.K,n,!1).J(t);u.z=i;u.m=r;Array.add(this.E,u)}},bJ:function(){return this.D.c().b().a(35)},bz:function(){this.bd||(_Ewa.lH.a(this.D),this.I=this.D.c(),this.K=new _Ewa.jB(this.D),this.D.A(this.Y),this.I.f(this.W),this.I.A(this.X),this.bn(),this.bB(),this.bA(),this.D.a().b(_Ewa.bn,34,this),this.S.a(this),this.H=new _Ewa.ik,this.ba=new _Ewa.rD(this.D,this.H,this.K),this.D.e().j(this.H.f),this.R=new _Ewa.rC(this.D,this.H,this.K),this.Z=new _Ewa.rB(this.D,this.H,this.K),this.bd=!0)},by:function(n){if(!this.M)return null;for(var t=0,i=this.M.length;t<i;t++)if(n.startsWith(this.M[t].WebExtensionId))return this.M[t];return null},bn:function(){var i=this.I,n,t;if(i.c()&&!this.V){if(i.j()){if(this.T=this.D.c().b().a(22),i.j().WebExtensions&&i.j().WebExtensions.length){if(n=i.j().WebExtensions,!this.I.a())for(t=n.length-1;t>=0;t--)Array.add(this.U,n[t].InstanceId),n[t].WebExtensionType!==1&&Array.removeAt(n,t);this.bv(n)}}else this.T=!1;this.V=!0}},bl:function(n){var t=_Ewa.c.a(this.D),i=t.a().c();i&&n&&t.a().v(i,!0)},bB:function(){var n=this.L();n&&this.I.a()&&this.D.i()&&_Ewa.w.h(this.D.i())&&(_Ewa.gY.a(this.D).F()?_Ewa.gY.a(this.D).a():_Ewa.gY.a(this.D).q(this.bh))},bF:function(){this.D.i()&&_Ewa.w.h(this.D.i())&&_Ewa.gY.a(this.D).a()},bv:function(n){for(var u=null,e=100,r=this,i,f,u=function(n){var f=n.WebExtensionData,h=n.IsTaskPane,o=n.RecordHandler,s=function(){if(r.P.shift(),r.P.length>0){var n=r.P[0];u(n)}},t,i;if(r.l(f.PrimaryMarketplace.SolutionId)){s();return}t=new _Ewa.ex(r,r.K,f,!h);t.K();Array.add(r.E,t);i=null;i=_Ewa.t.a().b(function(){t.e&&(System.a.a(i),i=null,o&&o(n,t),s())},e,!0,!1)},t=0;t<n.length;t++)n[t].WebExtensionType!==1?this.j(n[t]):this.D.b(91)?(this.D.s()&8388608||n[t].TaskpaneVisible)&&(i={},i.marketplaceId=n[t].PrimaryMarketplace.SolutionId,i.marketplaceVersion=n[t].PrimaryMarketplace.SolutionVersion,i.storeType=n[t].PrimaryMarketplace.MarketplaceType,i.storeId=n[t].PrimaryMarketplace.MarketplaceRef,i.targetData=n[t],f=this,this.L().isAddinCommandsAsync(i,function(n,t,r){var e,o,s;if(!n){Diag.a.a(17367836,220,10,"Judging AddinCommands failed for {0} from {1} during document loading",r.targetData.PrimaryMarketplace.SolutionId,r.targetData.PrimaryMarketplace.MarketplaceType);return}if(e=r.targetData,t){if(!f.D.b(185))return;if(i.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())return;o=!1;s=function(n){var s=n,l,a,t,i;if(!s.errorCode){if(s.value)for(var c=s.value,v=c.length,h=0;h<v;++h){if(l=c[h],o)break;a=l[1];o=a.toUpperCase()===e.PrimaryMarketplace.SolutionId.toUpperCase()}o||(t={},i=r,t.Id=i.marketplaceId,t.TargetType=e.WebExtensionType,t.AppVersion=i.marketplaceVersion,t.CurrentStoreType=e.PrimaryMarketplace.MarketplaceType,t.StoreId=i.storeId,t.AssetId=i.marketplaceId,t.AssetStoreId=i.storeId,t.Width=e.TaskpaneWidth,f.bq(t,e,u))}};f.w(s,!0)}else f.bi(e,u)})):this.bi(n[t],u)},bi:function(n,t){var i={};i.WebExtensionData=n;i.IsTaskPane=!0;this.P.push(i);this.P.length===1&&t(i)},bq:function(n,t,i){var r={},u;r.ActivationInfo=n;r.WebExtensionData=t;r.IsTaskPane=!1;u=this;r.RecordHandler=function(n,t){var i=n.ActivationInfo,f=n.WebExtensionData,r=function(){u.A(t.b.InstanceId);u.L().purgeOsfControl(t.b.InstanceId,!1);u.bp(i)};u.a().insertBlankControlWithErrorUX(u.bI(t,i),r)};this.P.push(r);this.P.length===1&&i(r)},bp:function(n){var t={},r,i,u;t.id=n.Id;t.targetType=n.TargetType;t.currentStoreType=n.CurrentStoreType;t.assetId=n.AssetId;t.appVersion=n.AppVersion;t.storeId=n.StoreId;t.assetStoreId=n.AssetStoreId;r=new($$sc.r.$$(Object));r.b(t);i={};i.ack2=r;i.ack0=3;u=new _Ewa.Z(407117407,0,this.D.o()?2:1,0,null);this.D.f().b(u,i,null)},bI:function(n,t){var i={};return i.div=n.e,i.id=n.b.InstanceId,i.marketplaceID=t.Id,i.marketplaceVersion=t.AppVersion,i.store=t.StoreId,i.storeType=t.CurrentStoreType,i.osfControlType=OSF.OsfControlTarget.TaskPane,i},bH:function(){this.bn()},bD:function(n,t){!this.I.c()&&_Ewa.hR.a(t)&&(Array.forEach(this.E,this.be),Array.clear(this.E),this.V=!1)},bo:function(n){var t=n;t.L();this.cE("cd",t.b.InstanceId,null)},bu:function(n,t){if(n)for(var i=0;i<n.length;i++)if(_Ewa.g.a(n[i],t,!0))return!0;return!1},bt:function(n){var t={},i;return(t.navigationMode=OSF.OsfNavigationMode.DefaultMode,t.assetId=null,t.category=null,!n||n.length<3)?t:(!n[0]||(i=parseInt(n[0]),isNaN(parseInt(i))||(t.navigationMode=i)),!n[1]||(t.assetId=n[1]),!n[2]||(t.category=n[2]),t)},bA:function(){var n,t;this.D.b(123)&&(n=this.D.j().FullDocumentInfo.EmbeddingPageOrigin,n&&n.trim()!=="*")&&(this.Q=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new _Ewa.rA(this),n,this.D.j().FullDocumentInfo.EmbeddingPageSessionInfo,this.D.H().a(2)),this.Q.init(),t={},t.a=this.D.g().UserSessionId,_Ewa.y.a().a(37,t,!1))}};_Ewa.lE=function(n){this.h=Function.createDelegate(this,this.k);this.e=new($$sc.s.$$(Function));this.d=n;this.b().a(this.h)};_Ewa.lE.a=function(n){if(!n.D.a().a(_Ewa.hc,226)){var t=new _Ewa.lE(n);n.D.a().b(_Ewa.hc,226,t)}};_Ewa.lE.prototype={e:null,f:null,g:null,d:null,b:function(){return this.f||(this.f=Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance(this.j())),this.f},j:function(){if(!this.g&&this.d){var n=this.d.L();this.g=n}return this.g},a:function(n,t,i,r){if(this.d.D.b(116)){Diag.a.a(19931726,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var u=this,f=function(r){r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(u.e.c(n,t),u.d.N(i)):(Diag.a.a(19931727,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),u.d.F(r,i))};this.e.b(n)?f(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.l(n,r,f)}else this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,i)},c:function(n,t){if(this.d.D.b(116))if(this.e.b(n)){Diag.a.a(19931728,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");var i=this,r=function(r){i.e.d(n);r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?i.d.N(t):(Diag.a.a(19931729,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),i.d.F(r,t))};this.b().b(n,r)}else this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,t);else this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t)},l:function(n,t,i){try{var r=this,u=function(n){r.d.br(r.i(n))};this.b().d(t,n,i,u)}catch(f){Diag.a.a(19690967,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",f.message);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},i:function(n){var t={};return t.InstanceId=n.id,t.WebExtensionType=n.osfControlType===OSF.OsfControlTarget.InContent?0:1,t.PrimaryMarketplace={},t.PrimaryMarketplace.SolutionId=n.marketplaceID,t.PrimaryMarketplace.SolutionVersion=n.marketplaceVersion,t.PrimaryMarketplace.MarketplaceRef=n.store,t.PrimaryMarketplace.MarketplaceType=n.storeType,t},k:function(n,t){if(this.e.b(t.a)){var i=new _Ewa.Bb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,t.a,null,t.b,t.c);this.e.a(t.a)(i);t.b===OSF.DialogMessageType.DialogClosed&&this.e.d(t.a)}}};_Ewa.rA=function(n){this.d=Function.createDelegate(this,this.g);this.a=n};_Ewa.rA.prototype={a:null,b:null,c:!1,invokeDdaMethod:function(n,t){var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.a.O(678398266,i)},registerDdaEventAsync:function(n,t,i,r,u){if(!(n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)){this.a.F(-1,u);return}n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&this.f();this.b||(this.b=[]);var f=this.e(n,i);f||(f=new _Ewa.lC(n,i),Array.add(this.b,f));f.e(r);this.a.N(u)},unregisterDdaEventAsync:function(n,t,i,r,u){if(!(n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)){this.a.F(-1,u);return}var f=this.e(n,i);f&&f.f(r);this.a.N(u)},f:function(){if(!this.c){var n=_Ewa.c.a(this.a.D).a();n.f(this.d);this.c=!0}},g:function(){var t=this,n=function(n){var t=n;t.a===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&t.d(new _Ewa.jx(t.a,"",null,null))};Array.forEach(this.b,n)},e:function(n,t){var i,r;if(!this.b)return null;for(i=0;i<this.b.length;i++)if(r=this.b[i],r.a===n&&r.c===t)return r;return null}};_Ewa.ex=function(n,t,i,r){this.y=Function.createDelegate(this,this.M);this.v=Function.createDelegate(this,this.R);this.x=Function.createDelegate(this,this.X);this.w=Function.createDelegate(this,this.W);_Ewa.ex.initializeBase(this);this.c=n.D;this.d=n;this.b=i;this.b.InstanceId=i.SrcLocationOverrideResourceId?n.t(i.InstanceId,i.SrcLocationOverrideResourceId):i.InstanceId;this.p=t;this.f={};this.f.WebExtensionId=i.InstanceId;this.r="osfControl_"+i.InstanceId;this.n="disabled_"+i.InstanceId;this.f.BindingData=i.BindingData;this.q=this.d.bm(i.InstanceId);this.l=i.WebExtensionOsfControlType;this.s=r};_Ewa.ex.b=function(n){return n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};_Ewa.ex.a=function(n){return n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||n===OSF.DDA.EventDispId.dispidSettingsChangedEvent||n===OSF.DDA.EventDispId.dispidRichApiMessageEvent};_Ewa.ex.c=function(n){return n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};_Ewa.ex.prototype={b:null,j:0,p:null,g:null,r:null,f:null,k:!1,o:null,h:0,n:null,d:null,q:!0,i:null,l:0,z:null,m:null,s:!1,a:function(){return this.b.InstanceId},c:null,e:null,G:function(){return this.b.SrcLocationOverrideResourceId?this.d.t(this.b.PrimaryMarketplace.SolutionId,this.b.SrcLocationOverrideResourceId):this.b.PrimaryMarketplace.SolutionId},K:function(){var r,t,i,n;return this.b.WebExtensionType===1?(r=this,_Ewa.d.cw(_Ewa.ct.a(this.c),function(n){n.a().f(_Ewa.dw,r.c.a(),73,7,r.w)},this.cF(),3)):(t=this.E(),i=_Ewa.T.a(this.c),t||(n={},n.Type=3,n.Id=this.f.WebExtensionId,n.WebExtensionData=this.b,n.ContentHtml="<div/>",n.Version=0,n.AbsoluteLeft=0,n.AbsoluteTop=0,n.AbsoluteRight=0,n.AbsoluteBottom=0,n.Width=0,n.Height=0,n.ZOrder=0,n.OriginDeltaX=0,n.OriginDeltaY=0,i.q(n,null),t=i.b(n.Type+"_"+n.Id)),t?(this.t(t.i().firstChild),this.i=$$as(_Ewa.gd,t)):i.e(this.x)),this},J:function(n){return this.t(n),this},L:function(){this.s||this.d.L().purgeOsfControl(this.b.InstanceId,!1);this.B(!0);var n=this.E();n&&_Ewa.T.a(this.c).c(n,14);this.d.H.h(this.b.InstanceId);this.d.H.g(this.b.InstanceId,!0);this.e=null},U:function(n,t){if(!!this.h){this.d.F(5004,t);return}var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.d.O(678398266,i)},Y:function(n,t,i,r){var f,u,e;if(!!this.h){this.d.F(-1,r);return}if(_Ewa.ex.b(n)&&(isNullOrUndefined(t)||isNullOrUndefined(this.A(t)))){this.d.F(3002,r);return}if(Diag.a.a(36444195,0,50,"eventId: {0}, targetId: {1}",n,t),_Ewa.ex.a(n)&&this.S(),_Ewa.ex.c(n)&&this.T(),n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent){if(this.c.b(116)){f=this.d.D.a().a(_Ewa.hc,226);f.a(this.b.InstanceId,i,r,t);return}this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r);return}n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent&&this.I(-1777565636,r);this.g||(this.g=[]);u=this.F(n,t);u||(u=new _Ewa.lC(n,t),Array.add(this.g,u));u.e(i);this.d.N(r);n===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.m&&(e=new _Ewa.jx(n,this.b.InstanceId,null,this.m),i(e),this.m=null)},bf:function(n,t,i,r){var f,u;if(n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent){if(this.c.b(116)){f=this.d.D.a().a(_Ewa.hc,226);f.c(this.b.InstanceId,r);return}this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r);return}if(n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent&&this.I(1592314317,r),u=this.F(n,t),!!this.h){this.d.F(-1,r);return}if(!u){this.d.N(r);return}u.f(i);u.b.length>0||Array.remove(this.g,u);this.g.length?_Ewa.ex.a(n)&&this.N(!1):this.B(!1);this.d.N(r)},C:function(n){var t=_Ewa.a.a(n,this.r);t||n.appendChild(_Ewa.a.h(this.e))},u:function(n){_Ewa.a.b(this.e,n)},ba:function(n,t){_Ewa.a.m(this.e,n,!1);_Ewa.a.r(this.e,t,!1)},D:function(n){if(!this.h&&!_Ewa.a.a(this.e,this.n)&&this.e){var t=document.createElement("div");t.id=this.n;t.className="ewa-wx-disabled-div";t.style.backgroundImage="url("+_Ewa.n.b.b(64)+")";t.style.opacity=n?"1":"0";t.style.backgroundRepeat="no-repeat";t.style.backgroundPosition="center";this.e.insertBefore(t,this.e.firstChild)}this.h++},O:function(){this.h>0&&this.h--;this.h||(_Ewa.a.h(_Ewa.a.a(this.e,this.n)),this.k&&this.o!==_Ewa.c.a(this.c).a().a()&&this.M(null,null))},A:function(n){if(!this.f||!this.f.BindingData)return null;for(var t=0;t<this.f.BindingData.length;t++)if(this.f.BindingData[t].Name===n)return this.f.BindingData[t];return null},Q:function(){var n=this.H();return n?n.getDefaultIconUrl():null},P:function(){var n=this.H();return n?n.getDefaultDisplayName():null},Z:function(){this.g=null;this.B(!0);this.d.H.h(this.b.InstanceId);this.d.H.g(this.b.InstanceId,!0)},bd:function(){var i,n,t;this.c.c().a()&&this.V()&&(i=_Ewa.gY.a(this.c),i.c(this.e),this.u(!1));this.d.T?(this.s||(n={},n.div=this.e,n.id=this.b.InstanceId,n.marketplaceID=this.b.PrimaryMarketplace.SolutionId,n.marketplaceVersion=this.b.PrimaryMarketplace.SolutionVersion,n.store=this.b.PrimaryMarketplace.MarketplaceRef,n.storeType=this.b.PrimaryMarketplace.MarketplaceType,n.ownerAddinAssetId=this.b.OwnerAddinAssetId,this.b.AssetMarketplace&&(n.alternateReference={},n.alternateReference.marketplaceID=this.b.AssetMarketplace.SolutionId,n.alternateReference.marketplaceVersion=this.b.AssetMarketplace.SolutionVersion,n.alternateReference.store=this.b.AssetMarketplace.MarketplaceRef,n.alternateReference.storeType=this.b.AssetMarketplace.MarketplaceType),n.settings=this.b.OsfPropertyBag,n.reason=this.q?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted,n.osfControlType=this.b.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent,(this.c.b(196)||this.c.b(174))&&(n.isForUILessAction=this.b.WebExtensionOsfControlType===4),n.sourceLocationOverrideResourceId=this.b.SrcLocationOverrideResourceId,this.c.b(91)&&this.c.b(202)&&(t=this,n.virtualOsfControlActivationCallback=function(){t.d.bE(t.b)}),this.d.L().insertOsfControl(n)),this.h=0):this.D(!0)},B:function(n){this.N(n);this.be()},S:function(){this.j||this.p.m(this.v);this.j++},N:function(n){this.j>0&&(n?this.j=0:this.j--,this.j||this.p.o(this.v))},T:function(){if(!this.k){var n=_Ewa.c.a(this.c).a();this.o=n.a();n.f(this.y);this.k=!0}},be:function(){this.k&&(_Ewa.c.a(this.c).a().h(this.y),this.k=!1)},bb:function(n){var t=new _Ewa.o(n.Reference.FirstRow+1,n.Reference.FirstColumn+1,n.Reference.LastRow+1,n.Reference.LastColumn+1,!1,!1),i,r;return(n.BindingType===1&&(n.HasHeaders&&(t.a=t.a-1),n.HasTotals&&(t.d=t.d+1)),i=_Ewa.c.a(this.c).a().a().k(t),r=this.o.k(t),!r&&i||r&&i&&!i.f(r))?i:null},bc:function(){var n=this,t=function(t){var i=t,r,u;(i.a!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&i.a!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n.d.H.c(n.b.InstanceId))&&(i.a===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent?i.d(new _Ewa.jx(i.a,n.b.InstanceId,null,null)):i.a===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent&&(r=n.A(i.c),r&&r.IsValidRef&&(n.c.c().a()?n.c.l().a().d():n.c.e().a().a)===r.Reference.SheetName&&(u=n.bb(r),u&&i.d(new _Ewa.AZ(i.a,n.b.InstanceId,n.d.d(r),r,u.a-1,u.b-1,u.i(),u.j())))))};Array.forEach(this.g,t)},M:function(){this.h||(this.bc(),this.o=_Ewa.c.a(this.c).a().a())},F:function(n,t){var i,r;if(!this.g)return null;for(i=0;i<this.g.length;i++)if(r=this.g[i],r.a===n&&r.c===t)return r;return null},R:function(n){if(n.controlId===this.b.InstanceId){var i=this,t=function(t){var i=t;i.g(n)&&i.d(n)};Array.forEach(this.g,t)}},E:function(){for(var n,i=_Ewa.T.a(this.c).a(),t=i.length-1;t>=0;--t)if(n=i[t],n.a().a===3&&n.a().p.InstanceId===this.f.WebExtensionId)return n;return null},V:function(){for(var t,n=0;n<this.c.l().d();n++)if(t=this.c.l().f(n),t.j===this.f.WebExtensionId)return!0;return!1},W:function(n){var t=$$as(_Ewa.dw,n),i;t&&!t.g()&&(t.k(this.b),t.m(this.d),this.t(t.d()),t.i(),this.q||_Ewa.ct.a(this.c).a().d(t,!0),i=this.c.a().a(_Ewa.Gv.$$(_Ewa.dw),73),i.g(this.w),this.i=$$as(_Ewa.gd,t))},t:function(n){this.e=n;this.e.id=this.r;this.e.className="ewa-wx-container-div";this.e.dir=this.c.u()?"rtl":"ltr";this.bd()},X:function(n,t){t.a.a().a===3&&t.a.a().p.InstanceId===this.f.WebExtensionId&&(this.i=$$as(_Ewa.gd,t.a),this.t(t.a.i().firstChild),_Ewa.T.a(this.c).m(this.x))},H:function(){return!this.h?OSF.OsfManifestManager.getCachedManifest(this.b.PrimaryMarketplace.SolutionId,this.b.PrimaryMarketplace.SolutionVersion):null},I:function(n,t){var i,r;if(!this.c.b(116)){this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t);return}try{if(Diag.a.a(19931730,0,50,"HandleDialogNotificationShownInAddinEvent called!"),this.l!==4){this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,t);return}i={};i.OsfcontrolId=this.b.InstanceId;r=new _Ewa.Z(n,0,this.c.o()?2:1,0,null);this.c.f().b(r,i,null);this.d.N(t)}catch(u){Diag.a.a(19931731,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",u.message);this.d.F(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,t)}}};_Ewa.rB=function(n,t,i){this.m=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.p);this.a=n;this.k=t;this.f=i};_Ewa.rB.prototype={k:null,f:null,a:null,i:0,j:0,b:null,c:null,o:function(n){var t,i;n.messageType===51?(this.n(n.actionType,t={val:this.i},this.l),this.i=t.val):n.messageType===52&&(this.n(n.actionType,i={val:this.j},this.m),this.j=i.val)},n:function(n,t,i){if(n===1)t.val||_Ewa.c.a(this.a).a().V(i),t.val++,this.r();else if(n===2){if(t.val<1)return;t.val===1&&_Ewa.c.a(this.a).a().bk(i);t.val--}},p:function(){var i,n,t,r;this.a.b(12)&&(i=_Ewa.c.a(this.a).a().c(),this.h(i))&&(n=this.g(i),n)&&(t={},t.chartId=n,t.worksheetId=this.e(),r=_Ewa.v.a(t),this.d(51,n,r),this.d(51,this.e(),r))},q:function(){var n,t,i;if(this.a.b(12)){if(this.b&&(n={},n.chartId=this.b,n.worksheetId=this.c,t=_Ewa.v.a(n),this.d(52,this.b,t),this.d(52,this.c,t)),i=_Ewa.c.a(this.a).a().c(),!this.h(i)){this.b=null;this.c=null;return}this.b=this.g(i);this.c=this.e()}},d:function(n,t,i){t&&this.k.d(n,t)&&this.f.d(n,t,i)},g:function(n){if(!n||!n.a())return null;var i=n.a().b,t=i.match(new RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));return t&&t.length===1?t[0]:null},e:function(){var n=this.a.e().a();return!n||n.p?null:n.f},r:function(){var n=_Ewa.c.a(this.a).a().c();this.h(n)&&(this.b=this.g(n),this.c=this.e())},h:function(n){return!!n&&!!n.a()&&!n.a().a}};_Ewa.ik=function(){this.f=Function.createDelegate(this,this.m);this.a={};this.b={}};_Ewa.ik.a=function(n,t){return String.format("{0}#{1}",n,t)};_Ewa.ik.prototype={e:0,i:function(n,t){return this.a[_Ewa.ik.a(n,t)]},g:function(n,t){if(!t&&isNullOrUndefined(this.b[n])){this.b[n]=1;return}t&&!isNullOrUndefined(this.b[n])&&delete this.b[n]},c:function(n){return isNullOrUndefined(this.b[n])},j:function(n){var t=_Ewa.ik.a(n.messageType,n.targetId);n.actionType===1?this.k(n.controlId,n.messageType,t):n.actionType===2&&this.l(n.controlId,n.messageType,t)},h:function(n){var t,u,i;if(n&&(t=Object.keys(this.a),!isNullOrUndefined(t)&&!(t.length<=0)))for(var f=t,e=f.length,r=0;r<e;++r)u=f[r],i=this.a[u],i[n]&&(delete i[n],Object.keys(i).length||delete this.a[u])},d:function(n,t){var r=_Ewa.ik.a(n,t),i=this.a[r];return!!i&&Object.keys(i).length>0},n:function(n){var t,r;if(n&&(t=Object.keys(this.a),!isNullOrUndefined(t)&&!(t.length<=0)))for(var u=t,f=u.length,i=0;i<f;++i)r=u[i],r.endsWith(String.format("#{0}",n))&&delete this.a[r]},m:function(n,t){if(t){var i=$$as(_Ewa.z,t.a);i&&this.n(i.f)}},k:function(n,t,i){var u,r,f;this.a[i]?(r=this.a[i],r[n]?(f=r[n],r[n]=f+1):r[n]=1):(u={},u[n]=1,this.a[i]=u);t===100&&this.e++},l:function(n,t,i){var r,u;this.a[i]?(r=this.a[i],n?(u=r[n],u===1?(delete r[n],Object.keys(r).length||delete this.a[i]):r[n]=u-1,t===100&&this.e--):Diag.a.a(23941468,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",n,i)):Diag.a.a(23941467,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",i)}};_Ewa.rC=function(n,t,i){this.j=Function.createDelegate(this,this.k);this.d={};this.i={};_Ewa.rC.initializeBase(this,[!1]);this.c=n;this.f=t;this.g=i;this.a=_Ewa.c.a(n)};_Ewa.rC.prototype={c:null,f:null,g:null,a:null,b:0,e:0,n:function(){return!this.e&&this.b>0},m:function(n){if(n.actionType===1)this.b||this.a.g().f(this.j),this.b++,n.messageType===14?this.l(n.targetId):n.messageType===100&&this.l(n.message);else if(n.actionType===2){if(this.b<1)return;this.b===1&&this.a.g().d(this.j);this.b--}},p:function(n){n?this.e++:(this.e>0&&this.e--,this.e||this.k(null,null))},k:function(n,t){var i,r,u,f;if(this.n()&&this.c.b(10)&&(!t||t.a===1&&t.c)&&(i=this.c.e().a(),i&&!i.p)){if(r=t&&t.b?t.b:this.a.a().a(),!r){this.d[i.f]=null;return}this.d[i.f]&&this.d[i.f].toString()===r.toString()||(u=this.i[i.f],f=this,_Ewa.d.c($$sc.a.a(Boolean,!0),function(){f.o(r,i,u)},this.cF()),this.d[i.f]=r,this.i[i.f]=i.n())}},o:function(n,t,i){var s;if(this.f.d(14,t.f)&&(s={},s.address=n.toString(),this.g.d(14,t.f,_Ewa.v.a(s))),this.f.e>0){var e=this.a.a().m(i,!1),r=this.a.a().m(t.n(),!1),u=null,o="",f="";this.c.b(14)?(e&&(o=e.i),r&&(f=r.i)):(e&&(o=e.y.toString()),r&&(f=r.y.toString()));e?r?o===f?(u=r.b.k(n),this.h(f,u.toString(),t.f)):(this.h(o,"",t.f),u=r.b.k(n),this.h(f,u.toString(),t.f)):this.h(o,"",t.f):r&&(u=r.b.k(n),this.h(f,u.toString(),t.f))}},l:function(n){for(var t,r=this.c.e(),i=0;i<r.d();i++)if(t=r.f(i),t.f===n){this.d[n]=t.o();this.i[n]=t.n();break}},h:function(n,t,i){if(this.f.d(100,n)){var r={};r.address=t;r.worksheetId=i;this.g.d(100,n,_Ewa.v.a(r))}},dispose:function(){this.b>0&&this.a.g().d(this.j);this.b=0;this.d=null;this.i=null;this.a=null;this.c=null;this.f=null;this.g=null}};_Ewa.rD=function(n,t,i){this.m=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.y);this.k=Function.createDelegate(this,this.v);this.a=n;this.j=t;this.e=i};_Ewa.rD.prototype={j:null,e:null,a:null,f:0,i:0,g:0,h:0,p:function(n){n.messageType===11?n.targetId==="Workbook"?this.r(n.actionType):this.q(n.actionType):n.messageType===12&&(n.targetId==="Workbook"?this.s(n.actionType):this.t(n.actionType))},q:function(n){var t;this.b(n,t={val:this.f},this.k);this.f=t.val},t:function(n){var t;this.b(n,t={val:this.i},this.n);this.i=t.val},r:function(n){var t;this.b(n,t={val:this.g},this.l);this.g=t.val},s:function(n){var t;this.b(n,t={val:this.h},this.m);this.h=t.val},b:function(n,t,i){n===1?this.o(t,i):n===2&&this.u(t,i)},o:function(n,t){n.val||this.a.e().b(t);n.val++},u:function(n,t){n.val<1||(n.val===1&&this.a.e().c(t),n.val--)},v:function(n,t){var i,r,u;this.a.b(10)&&(i=$$as(_Ewa.z,t.a),this.d(i))&&(r={},r.worksheetId=i.f,u=_Ewa.v.a(r),this.c(11,i.f,u,!1))},y:function(n,t){var i,r,u;this.a.b(10)&&(i=$$as(_Ewa.z,t.b),this.d(i))&&(r={},r.worksheetId=i.f,u=_Ewa.v.a(r),this.c(12,i.f,u,!1))},w:function(n,t){var i,r,u;this.a.b(10)&&(i=$$as(_Ewa.z,t.a),this.d(i))&&(r={},r.worksheetId=i.f,u=_Ewa.v.a(r),this.c(11,null,u,!0))},x:function(n,t){var i,r,u;this.a.b(10)&&(i=$$as(_Ewa.z,t.b),this.d(i))&&(r={},r.worksheetId=i.f,u=_Ewa.v.a(r),this.c(12,null,u,!0))},d:function(n){return!!n&&!n.p},c:function(n,t,i,r){var u=r?"Workbook":t;this.j.d(n,u)&&this.e.d(n,u,i)}};_Ewa.lH=function(n,t,i){this.k=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.w);this.g=Function.createDelegate(this,this.s);this.i=Function.createDelegate(this,this.u);this.o=Function.createDelegate(this,this.y);_Ewa.lH.resolveInheritance();this.h=this.ip;this.m=this.dA;_Ewa.lH.initializeBase(this,[i,n,!0]);this.d=t;Sys.UI.DomElement.addCssClass(this.cD,"ewr-chrtcontarea");Sys.UI.DomElement.addCssClass(this.cD,"ewa-scrollbars");i.tabIndex=0;this.r(this.cI.i(),!1);this.cK().a("mousedown",this.o);var r=this;this.cK().a("contextmenu",function(n){_Ewa.u.a(n,!0)});this.cI.e().i(this.i);this.cI.l().i(this.i);this.cI.l().b(this.g);this.cI.e().b(this.g);this.d.b(this.l);this.d.d(this.n);this.d.c(this.k)};_Ewa.lH.a=function(n){if(!_Ewa.gY.a(n)){var t=n.bf();n.a().b(_Ewa.lG,33,new _Ewa.lH(n,new _Ewa.cZ(n,n.c(),n.d().c(),3,0),t.appendChild(t.ownerDocument.createElement("div"))))}};_Ewa.lH.prototype={d:null,f:null,e:null,j:!1,b:function(){return this.d},dispose:function(){this.cI&&(this.cI.e().h(this.i),this.cI.l().h(this.i),this.cI.l().c(this.g),this.cI.e().c(this.g));this.d&&(this.d.a(this.l),this.d.g(this.n),this.d.f(this.k));this.p();System.a.a(this.d);this.d=null;_Ewa.a.h(this.cD);_Ewa.AL.prototype.dispose.call(this)},c:function(n){_Ewa.a.h(_Ewa.a.a(this.cD,n.id));this.cD.appendChild(n)},a:function(){if(this.e&&!this.j){var t=$$as(_Ewa.bF,_Ewa.cE.a(this.cI)),n=t.G(this.e.InstanceId);n&&(n.ba(this.e.Width,this.e.Height),n.C(this.cD),n.u(!0),this.j=!0)}},x:function(n,t){if(t.a.b===this.f&&this.e){var i=$$as(_Ewa.bF,this.cI.a().a(_Ewa.bn,34));i.bK(this.e.InstanceId,!1)}},w:function(n,t){var i=t.a.a;switch(i.b){case 1:case 3:case 5:this.z(t)}},v:function(){this.eP(!0)},z:function(n){this.e=n.a.a.a;this.j=!1;this.a()},A:function(n){this.cI.c().B()&&n&&(n.h||(n.h=new _Ewa.jt),n.h.b=new _Ewa.B(this.cD.scrollLeft,this.cD.scrollTop),n.h.c=20)},p:function(){this.d.k(this.f);this.f=null;this.e=null;this.j=!1},u:function(n,t){this.cP()&&this.A(t.b);this.p()},s:function(n,t){this.r(t.a,!!t.b)},r:function(n,t){var r=this.cV(!!n&&_Ewa.w.h(n)),i;r&&(this.d.l(n,_Ewa.cZ.a(),i={val:this.f}),this.f=i.val,this.fB(t))},y:function(){this.cI.c().u()}};_Ewa.uZ=function(n,t){this.f=Function.createDelegate(this,this.k);this.g=n;this.h=t;this.e=!1;this.h.a().b(_Ewa.ij,218,this)};_Ewa.uZ.prototype={h:null,g:null,d:null,c:null,e:!1,a:function(n){if(this.e){Diag.a.a(19718340,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times.");return}if(this.e=!0,this.c={},this.d={},!n){Diag.a.a(19273180,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object.");return}n.q(this.f)},b:function(n){var t,i,r;if(!n){Diag.a.a(19273181,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.");return}n.z(this.f);t=this.c;for(i in t)r={key:i,value:t[i]},System.a.a(r.value);this.c=null;this.d=null;this.e=!1},k:function(n,t){var u=null,f=null,i=null,e,o,r;if(t)_Ewa.dw.isInstanceOfType(t)?(e=t,u=e.d(),i=e.bh()):_Ewa.cS.isInstanceOfType(t)&&(o=t,u=o.W(),i=o.bh());else{Diag.a.a(19718341,0,10,"Invalid parameter for ReadoutSelection");return}if(!u){Diag.a.a(19273183,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter.");return}if(f=$$as(_Ewa.bn,n),!f){Diag.a.a(19273182,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object.");return}this.i(i,u,f)||i in this.c||(this.d[i]=0,r=this,this.c[i]=_Ewa.t.a().b(function(){r.d[i]>=10||r.i(i,u,f)?(delete r.d[i],r.c[i].dispose(),delete r.c[i]):r.d[i]=r.d[i]+1},500,!0,!1))},i:function(n,t,i){var f=this.j(i,n),u,r;return f?!1:(u=t.querySelector("iframe"),!u)?(Diag.a.a(20022086,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0):(r=u.title,!r||!r.length)?(Diag.a.a(19273185,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0):(this.g.a(r),!0)},j:function(n,t){var i=n.a().getOsfControl(t);return i?i.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};_Ewa.nv=function(n){_Ewa.nv.initializeBase(this);this.h=n;this.j()};_Ewa.nv.a=function(n){n.a().b(_Ewa.Gv.$$(_Ewa.ij),219,new _Ewa.nv(n))};_Ewa.nv.prototype={h:null,b:function(){var n=this.h.a(),t=this;_Ewa.d.cw(_Ewa.k.b(_Ewa.cw,n,206,207),function(i){var r=n.a(_Ewa.ij,218)||new _Ewa.uZ(i.a(),t.h);t.i(r)},this.cF(),3)}};_Ewa.lD.registerClass("_Ewa.lD",_Ewa.kZ.$$(_Ewa.bn));_Ewa.lC.registerClass("_Ewa.lC");_Ewa.bF.registerClass("_Ewa.bF",_Ewa.cl,_Ewa.fl,_Ewa.bn,_Ewa.BM,Sys.IDisposable);_Ewa.ex.registerClass("_Ewa.ex",_Ewa.EO,_Ewa.Gn);_Ewa.rC.registerClass("_Ewa.rC",_Ewa.DW);_Ewa.lH.registerClass("_Ewa.lH",_Ewa.AL,_Ewa.lG,_Ewa.fp,Sys.IDisposable);_Ewa.nv.registerClass("_Ewa.nv",_Ewa.kZ.$$(_Ewa.ij));_Ewa.gc.a=null;_Ewa.BK.a();Type.registerNamespace("_Ewa");_Ewa.ew=function(){this.c=Function.createDelegate(this,this.g);this.b=Function.createDelegate(this,this.e)};_Ewa.ew.c=function(){return _Ewa.ew.a||(_Ewa.ew.a=new _Ewa.ew),_Ewa.ew.a};_Ewa.ew.prototype={a:null,d:function(n){_Ewa.ew.b||(this.a=n,this.f(),_Ewa.ew.b=!0)},f:function(){Common.a.c().a(860152194,2147483648,this.b);Common.a.c().a(741381681,2147483648,this.c)},e:function(n,t,i,r,u){if(i===2){var f=u?u:{},e=f.callback,o=f.refresh?f.refresh:!1;if(!e)return 16;this.a.w(e,o)}return 32},g:function(n,t,i,r,u){if(i===2){var f=u?u.callback:null;f&&this.a.p(f)}return 32}};_Ewa.BI=function(){};_Ewa.BI.a=function(){_Ewa.e.a(_Ewa.lz.a)};_Ewa.rv=function(n,t,i,r,u){this.k=Function.createDelegate(this,this.B);this.l=Function.createDelegate(this,this.C);this.m=Function.createDelegate(this,this.H);this.j={};_Ewa.rv.initializeBase(this,[!1]);this.c=n;this.i=t;this.d=i;this.g=r;this.f=u;this.f.c(this.m)};_Ewa.rv.prototype={i:null,d:null,c:null,g:null,f:null,e:null,a:function(n){this.cG("IDS",n)},b:function(n){this.cH("IDS",n)},h:null,dispose:function(){System.a.a(this.e);this.e=null;_Ewa.cl.prototype.dispose.call(this)},q:function(n,t,i){var r;if(t==="PopulateChartAddInMenuSection"){this.h=i.MenuId;this.f.d();this.f.a()&&(r=this.F(),i.PopulationXML=r);var u=this.c.g().UserSessionId,f=this.c.g().UICultureTag,e=this.c.g().UICultureTagLcid,o=this.c.g().WacHostId;return this.A("Control",this.h,u,f,e,o),!0}return!1},r:function(){return!1},o:function(n,t,i,r){var u=!1;switch(t.a){case-684355545:u=!0;break;case-741808261:u=!!i;break;case-859308420:u=n===1&&!!r&&r.a===1;break;case 1296389134:u=n===1&&!!r&&r.a===1}return u},p:function(n,t,i){var r=$$sc.a.a(Boolean,!0),e=t.a,u,f;switch(t.a){case 1296389134:u=i.SourceControlId;f=i.LabelText;this.I(u,f);break;case-684355545:this.t();break;case-741808261:r=this.w(i,t);break;case-859308420:r=this.v(i,t);break;default:r=_Ewa.E.a(e)}return r},E:function(n,t){var r,u,i,f,e,o;if(!n)return null;for(r=this.g.b(),r.b("Menu32"),r.c(_Ewa.b.a().a(172)),u=0;u<t.length;u++)i=n[t[u]],i.installed?(f=-741808261,e=this.u(i.ver,i.assetId,i.defhei,i.defwid,i.cm,i.appst,"omex","omex")):(f=1296389134,e=this.s(!0,i.assetId,"","ChartAddin","Control")),o=this.n(e,Common.d.c(i.title),"",f,i.icon32,"Image32by32",i.assetId,!1),Array.add(r.a(),o);return this.g.d(r)},F:function(){var r=this.G(),n=[r],t=this.E(this.f.a(),this.f.b()),i;return!t||n.push(t),i=this.D(),n.push(i),Common.r.b(n)},G:function(){var n=Common.r.l("InsertOther.Radar",_Ewa.b.a().b(299),"Radar","699602235","true","QueryChartGalleryIcon",_Ewa.n.a(5).toString(),"ewachart_radarChart48"),t=Common.r.l("InsertOther.RadarMarkers",_Ewa.b.a().b(298),"RadarMarkers","699602235","true","QueryChartGalleryIcon",_Ewa.n.a(5).toString(),"ewachart_radarChartMarker48"),i=Common.r.l("InsertOther.RadarFilled",_Ewa.b.a().b(297),"RadarFilled","699602235","true","QueryChartGalleryIcon",_Ewa.n.a(5).toString(),"ewachart_radarChartFilled48"),r=Common.r.f("InsertOther.Radar.Gallery","Size48by48","3",[n,t,i]);return Common.r.c(null,r,null,_Ewa.b.a().a(175),null)},D:function(){var n=this.g.b(),t;return n.b("Menu32"),t=this.n(this.s(!1,"","Data Visualization + BI","ChartAddin","Control"),_Ewa.b.a().a(174),"",1296389134,null,"None","MoreAddIn",!1),Array.add(n.a(),t),this.g.d(n)},H:function(){Diag.a.a(17342682,0,50,"Callback of app list request.");this.f.a()?(Diag.a.a(17339337,0,50,"App data is returned successfully from AppDataSource."),this.c.C().y(this.h)):Diag.a.a(17339338,0,10,"App data is not returned from AppDataSource.")},n:function(n,t,i,r,u,f,e,o){var s=this.g.f(n,t,r,u,f,e,o);return s.b(i),s},s:function(n,t,i,r,u){return n?String.format("{0}|{1}|{2}|{3}|{4}","2",t,"",r,u):String.format("{0}|{1}|{2}|{3}|{4}","1","",i,r,u)},u:function(n,t,i,r,u,f,e,o){return String.format("{0}|{1}|{2}|{3}|{4}|{5}|{6}|{7}",n,t,i,r,u,f,e,o)},t:function(){this.e.i()},v:function(){return $$sc.a.a(Boolean,!0)},w:function(n,t){var e=$$sc.a.a(Boolean,!0),f=this.c,r,u=n.ack5,y,i,a,v;if("SourceControlId"in n){if((r={},y=n.SourceControlId,i=y.split("|"),i.length!==8)||!i[0]||!i[1]||!i[2]||isNaN(parseInt(i[2]))||!i[3]||isNaN(parseInt(i[3]))||!i[4]||!i[5]||isNaN(parseInt(i[5]))||!i[6]||!i[7])return _Ewa.d.a();u={};u.appVersion=r.AppVersion=i[0];u.assetId=r.AssetId=i[1];u.id=r.Id=i[1];u.height=r.Height=parseInt(i[2]);u.width=r.Width=parseInt(i[3]);u.storeId=r.StoreId=i[4];u.targetType=r.TargetType=parseInt(i[5]);u.assetStoreId=r.AssetStoreId=i[6];u.currentStoreType=r.CurrentStoreType=i[7]}else r=n.CommandValueId;if(this.e&&this.e.i(),!f.T(null))return e;if(!r||!u)return Diag.a.a(17367833,220,10,"Inserting addin needs inserted agave parameters"),e;if(r.TargetType===1)e=this.x(r,u,t);else{var p=_Ewa.c.a(f),o=this.i.e(p),w=f.c().a()?f.i().f:f.i().a,s,h,c,l;o?(a=o.b,s=a.b().a,h=a.b().b,c=o.a.x,l=o.a.y):(s=h=1,v=this.i.d(p),c=v.a,l=v.b);var b=this.c.d().a().b(),k=this,d=function(n,t){return _Ewa.lA.b(f.d().a(),r,w,s,h,c,l,_Ewa.m.a(n,k.l),t,null,b)},g=this;e=_Ewa.W.a(this.c.h(),d,function(n){return new _Ewa.bg(0,n,0)},t)}return e},x:function(n,t,i){var u=this,e=function(n,t){var i=n.Id,r,f;return(n.CurrentStoreType===OSF.StoreType.FirstParty&&n.SourceLocationOverrideResourceId&&(i=u.d.t(n.Id,n.SourceLocationOverrideResourceId)),!u.d.i(i,null))?(r=u.c.d().a().b(),f=function(t,i){return _Ewa.lA.a(u.c.d().a(),n,_Ewa.m.a(t,u.k),i,null,r)},_Ewa.W.a(u.c.h(),f,function(n){return new _Ewa.bg(0,n,0)},t)):_Ewa.d.a()},o=this,s=function(n){var t,i,r;return Diag.a.a(17367834,220,50,"Insert addincommands for {0} from {1}.",n.assetId,n.currentStoreType),t={},i=new($$sc.r.$$(Object)),i.b(n),t.ack2=i,t.ack0=3,r=new _Ewa.Z(407117407,0,o.c.o()?2:1,0,null),o.c.f().b(r,t,null)},f,r,h,c;return!this.c.b(91)||n.StoreId===OSF.StoreType.FirstParty?e(n,i):t.isAddinCommands?s(t):(f=new($$sc.A.$$(Boolean)),r={},r.marketplaceId=n.Id,r.marketplaceVersion=n.AppVersion,r.storeType=n.CurrentStoreType,r.storeId=n.StoreId,r.targetData=n,this.c.b(202)&&(r.clearCache=!0),h=this,this.d.a().isAddinCommandsAsync(r,function(n,t,i){f.b(t);n||Diag.a.a(17367835,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",i.targetData.Id,i.targetData.CurrentStoreType)}),c=this,_Ewa.d.tc(f.a,function(r){var u=r.a();return u?s(t):e(n,i)},this.c.k()))},I:function(n,t){if(n){this.cE("IDS",null,null);var i=n.split("|");this.y(n,t,i);this.e=new Common.App.AppsForOffice.j;this.e.t("",null,null);this.d.v(this.e.a,i)}},B:function(n){var e=n.Result,t=e?e.AgaveData:null,u,f,r,i,s;if(Diag.a.b(8949913,0,t.TaskpaneWidth===350,"Taskpane width is {0}, assetId is {1}.",t.TaskpaneWidth,t.AssetMarketplace.SolutionId),this.j[t.PrimaryMarketplace.SolutionId]){if(u=0,f=this.j[t.PrimaryMarketplace.SolutionId],u=Object.keys(f).length,t.OsfPropertyBag&&t.OsfPropertyBag.length>0&&(u+=t.OsfPropertyBag.length),r=new Array(u),i=0,t.OsfPropertyBag&&t.OsfPropertyBag.length>0)for(i=0;i<t.OsfPropertyBag.length;i++)r[i]=new Array(2),r[i][0]=t.OsfPropertyBag[i][0],r[i][1]=t.OsfPropertyBag[i][1];for(var h=Object.keys(f),c=h.length,o=0;o<c;++o)s=h[o],r[i]=new Array(2),r[i][0]=s,r[i][1]=f[s].toString(),i++;t.OsfPropertyBag=r}t&&(this.d.h(e.SolutionId),this.d.j(t))},C:function(n){var i=n.Result,t=null===i?null:i.SolutionId;!t||(this.d.h(t),_Ewa.T.a(this.c).d(3,t,!1))},A:function(n,t,i,r,u,f){var e={};e.a=i;e.b=t;e.c=n;e.d=r;e.e=u;e.f=f;_Ewa.y.a().a(34,e,!1)},y:function(n,t,i){var f=this.c.g().UserSessionId,e=this.c.g().UICultureTag,o=this.c.g().UICultureTagLcid,s=this.c.g().WacHostId,r="",u="";i.length>=5&&(r=i[3],u=i[4]);this.z(r,u,n,t,e,o,f,s)},z:function(n,t,i,r,u,f,e,o){var s={};s.a=e;s.b=i;s.c=r;s.d=n;s.e=t;s.f=u;s.g=f;s.h=o;_Ewa.y.a().a(33,s,!1)}};_Ewa.lz=function(n){_Ewa.lz.initializeBase(this,[n])};_Ewa.lz.a=function(n){_Ewa.Q.a(72,new _Ewa.lz(n))};_Ewa.lz.prototype={m:null,o:null,p:null,dispose:function(){this.o=null;this.m=null;_Ewa.Q.prototype.dispose.call(this)},k:function(){var t,n,i;this.o&&this.m||(t=this.h.a(),this.o=_Ewa.k.a(_Ewa.eK,t,100,this.cF()),this.m=_Ewa.k.a(_Ewa.bn,t,102,this.cF()),this.p=_Ewa.k.a(_Ewa.dY,t,98,this.cF()),n=this,_Ewa.d.cw(_Ewa.d.ws([this.o,this.m,this.p],this.cF(),3),function(){var r=new Common.App.AppsForOfficeCommon.g(Common.App.AppsForOfficeCommon.b.b()),u=new Common.App.AppsForOfficeCommon.l(Common.a.b,Common.a.d,"WAC_Excel"),f=new Common.App.AppsForOfficeCommon.k(r,u,"PreinstalledAppsData_Excel",null),i,t;Common.App.AppsForOfficeCommon.e.a.a=f;i=new Common.App.AppsForOfficeCommon.i(Common.App.AppsForOfficeCommon.c.b());_Ewa.ew.c().d(n.m.a());t=new _Ewa.rv(n.h,n.o.a(),n.m.a(),n.p.a(),i);n.h.a().b(_Ewa.lF,201,t);n.o=null;n.m=null;n.p=null;n.l([t],null)},this.cF(),3));i=this;Common.Utils.a.a().b(Common.Utils.c).c(Common.Utils.h).a().b(function(){return new Common.Utils.c(i.h.bM())})}};_Ewa.lA=function(){};_Ewa.lA.a=function(n,t,i,r,u,f){var e=n.a(9,f);return e.sharedInfo=t,_Ewa.f.a(n,"InsertAgaveTaskpane",e,i,r,u,0,null)};_Ewa.lA.b=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(9,c);return l.sharedInfo=t,l.sheetName=i,l.positionRow=r,l.positionCol=u,l.positionOffsetX=f,l.positionOffsetY=e,_Ewa.f.a(n,"InsertWebExtension",l,o,s,h,0,null)};_Ewa.rv.registerClass("_Ewa.rv",_Ewa.cl,_Ewa.gJ,Sys.IDisposable,_Ewa.lF);_Ewa.lz.registerClass("_Ewa.lz",_Ewa.Q);_Ewa.ew.a=null;_Ewa.ew.b=!1;_Ewa.BI.a();Type.registerNamespace("_Ewa");_Ewa.BL=function(){};_Ewa.BL.a=function(){_Ewa.e.a(_Ewa.lB.a)};_Ewa.lB=function(n){_Ewa.lB.initializeBase(this,[n])};_Ewa.lB.a=function(n){_Ewa.Q.a(78,new _Ewa.lB(n))};_Ewa.lB.prototype={k:function(){var t=_Ewa.k.a(_Ewa.bn,this.h.a(),102,this.cF()),i=_Ewa.k.a(Sys.IDisposable,this.h.a(),160,this.cF()),n=this;_Ewa.d.cw(_Ewa.d.ws([t,i],this.cF(),3),function(){var i=t.a(),r=n.h.b(83)?Common.Utils.a.a().a(Common.App.NewAndOpen.UX.c):null;n.l([new _Ewa.Y(n.h,i,r)],null)},this.cF(),3)}};_Ewa.cx=function(){};_Ewa.cx.j=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(1,null);return c.controlId=t,c.coerceType=i,c.valueFormat=r,c.filterType=u,c.currentSheetName=f,c.formula=e,_Ewa.f.a(n,"DdaGetSelectedData",c,o,s,h,0,null)};_Ewa.cx.o=function(n,t,i,r,u,f,e,o){var s=n.a(9,null);return s.controlId=t,s.currentSheetName=i,s.formula=r,s.bindingData=u,_Ewa.f.a(n,"DdaSetSelectedData",s,f,e,o,0,null)};_Ewa.cx.b=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,null);return c.controlId=t,c.bindingId=i,c.bindingType=r,c.currentSheetName=u,c.formula=f,c.options=e,_Ewa.f.a(n,"DdaAddBinding",c,o,s,h,0,null)};_Ewa.cx.h=function(n,t,i,r,u,f){var e=n.a(1,null);return e.controlId=t,e.bindingId=i,_Ewa.f.a(n,"DdaGetBinding",e,r,u,f,0,null)};_Ewa.cx.k=function(n,t,i,r,u,f){var e=n.a(9,null);return e.controlId=t,e.bindingId=i,_Ewa.f.a(n,"DdaReleaseBinding",e,r,u,f,0,null)};_Ewa.cx.i=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=n.a(1,null);return y.controlId=t,y.bindingId=i,y.coerceType=r,y.valueFormat=u,y.filterType=f,y.startRow=e,y.startCol=o,y.rowCount=s,y.colCount=h,y.currentSheetName=c,_Ewa.f.a(n,"DdaGetBindingData",y,l,a,v,0,null)};_Ewa.cx.m=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,null);return c.controlId=t,c.bindingId=i,c.startRow=r,c.startCol=u,c.currentSheetName=f,c.bindingData=e,_Ewa.f.a(n,"DdaSetBindingData",c,o,s,h,0,null)};_Ewa.cx.g=function(n,t,i,r,u){var f=n.a(1,null);return f.controlId=t,_Ewa.f.a(n,"DdaGetAllBindings",f,i,r,u,0,null)};_Ewa.cx.a=function(n,t,i,r,u){var f=n.a(1,null);return f.controlId=t,_Ewa.f.a(n,"DdaLoadSettings",f,i,r,u,0,null)};_Ewa.cx.l=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.settings=i,o.overwriteIfStale=r,_Ewa.f.a(n,"DdaSaveSettings",o,u,f,e,0,null)};_Ewa.cx.c=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,null);return h.controlId=t,h.bindingId=i,h.isRow=r,h.currentSheetName=u,h.bindingData=f,_Ewa.f.a(n,"DdaAddRowsColumns",h,e,o,s,0,null)};_Ewa.cx.e=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.bindingId=i,o.currentSheetName=r,_Ewa.f.a(n,"DdaDeleteAllDataValues",o,u,f,e,0,null)};_Ewa.cx.d=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.bindingId=i,o.currentSheetName=r,_Ewa.f.a(n,"DdaClearBindingFormats",o,u,f,e,0,null)};_Ewa.cx.n=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,null);return h.controlId=t,h.bindingId=i,h.currentSheetName=r,h.bindingData=u,h.isSetFormats=f,_Ewa.f.a(n,"DdaSetBindingFormats",h,e,o,s,0,null)};_Ewa.cx.f=function(n,t,i,r,u){var f=n.a(1,null);return f.request=t,_Ewa.f.a(n,"ExecuteRichApiRequest",f,i,r,u,0,null)};_Ewa.rw=function(n,t,i,r){_Ewa.rw.initializeBase(this,[n,"Select Data",3,null,""]);this.x=n;this.G=t;this.w=i;this.y=r};_Ewa.rw.prototype={G:null,w:null,b:null,y:null,e:function(){return"DdaBindingPrompt"},x:null,O:function(n,t){var r="<div class='ewa-dlg-ddaprompt-body-sectionlabel ewa-scrollbars'><label for='{1}'>{0}<\/label><\/div>\r\n<div><input type='text' id='{1}' maxlength='388' class='ewa-dlg-body-fullLine' /><\/div>",i,u;r=String.format(r,Common.d.b(this.w.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.A.innerHTML=r;this.b=_Ewa.a.a(this.A,"bindingText");_Ewa.a.g(this.b,"input","type","text");i=!t?null:n.s(t,this.w.DdaBindingsMethod.BindingId);i&&i.IsValidRef?(u=new _Ewa.o(i.Reference.FirstRow+1,i.Reference.FirstColumn+1,i.Reference.LastRow+1,i.Reference.LastColumn+1,!1,!1),this.b.value=i.Reference.SheetName+"!"+u):this.b.value=_Ewa.w.a(this.x.i())?"":_Ewa.c.a(this.x).a().p();this.B();this.v(!1)},E:function(){this.bY();this.F(0,0,!1,!1);this.F(1,0,!1,!1);_Ewa.gs.prototype.E.call(this)},C:function(){_Ewa.a.d(this.b,!1)},bl:function(){return!0},N:function(){var n=this.b.value.trim(),t=n.indexOf("!");return t!==-1&&(n=this.I(n.substring(0,t))+n.substr(t)),this.G.h(this.w,n,0,this.y),!0},bu:function(){this.G.a.a(5001,this.y);_Ewa.gs.prototype.bu.call(this)},I:function(n){var t=_Ewa.g.k(n.trim(),"=");return t.length?t.startsWith("'")&&t.endsWith("'")?t:_Ewa.l.l(t,!1):""}};_Ewa.rx=function(n){this.e=n};_Ewa.rx.prototype={e:null,a:function(n,t){if(t){var i={};i.Error=n;i.Version=this.e.g();t(i)}},b:function(n,t,i){var r;r=_Ewa.gc.b(n.Errors[0].MessageId);this.a(r,i)},c:function(n){n&&n(this.d())},d:function(){var n={};return n.Error=0,n.Version=this.e.g(),n}};_Ewa.Y=function(n,t,i){this.b=n;this.d=t;this.a=new _Ewa.rx(n.c());this.c=new _Ewa.ry(n,this.a);this.j=i;this.e=new($$sc.m.$$(String,String))($$sc.g.c())};_Ewa.Y.l=function(){return _Ewa.Y.a||(_Ewa.Y.a={},_Ewa.Y.a[Microsoft.Office.WebExtension.CoercionType.Table]=1,_Ewa.Y.a[Microsoft.Office.WebExtension.CoercionType.Text]=2,_Ewa.Y.a[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,_Ewa.Y.a[Microsoft.Office.WebExtension.CoercionType.Html]=4,_Ewa.Y.a[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5),_Ewa.Y.a};_Ewa.Y.m=function(){return _Ewa.Y.b||(_Ewa.Y.b={},_Ewa.Y.b[Microsoft.Office.WebExtension.FilterType.All]=1,_Ewa.Y.b[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2),_Ewa.Y.b};_Ewa.Y.n=function(){return _Ewa.Y.c||(_Ewa.Y.c={},_Ewa.Y.c[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,_Ewa.Y.c[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1),_Ewa.Y.c};_Ewa.Y.o=function(n){var i,t;if(!n||!n.length)return null;for(i=new Array(n.length/2),t=0;t<n.length/2;t++)i[t]={},i[t].Name=n[t*2],i[t].Value=n[t*2+1];return i};_Ewa.Y.q=function(n){var i,t;if(!n||!n.length)return null;for(i=new Array(n.length*2),t=0;t<n.length;t++)i[t*2]=n[t].Name,i[t*2+1]=n[t].Value;return i};_Ewa.Y.h=function(n){var r,t,f,u,i;if(!n||!n.length)return null;for(r=new Array(n.length),t=0,f=n.length;t<f;t++)if(u=n[t].length,u)for(r[t]=new Array(u),i=0;i<u;i++)r[t][i]=n[t][i]==null?null:n[t][i].toString();else return null;return r};_Ewa.Y.e=function(n){return String.isInstanceOfType(n)?_Ewa.p.c(_Ewa.Y.l(),n,0):n};_Ewa.Y.j=function(n){return String.isInstanceOfType(n)?_Ewa.p.c(_Ewa.Y.m(),n,0):n};_Ewa.Y.k=function(n){return String.isInstanceOfType(n)?_Ewa.p.c(_Ewa.Y.n(),n,0):n};_Ewa.Y.r=function(n){switch(n.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};_Ewa.Y.g=function(n,t){var i={};return i.CoerceType=n,i.CoerceType===1?(i.Data=_Ewa.Y.h(t.Rows),i.Headers=_Ewa.Y.h(t.Headers)):i.Data=_Ewa.Y.h(t),i};_Ewa.Y.i=function(n){return n.CoerceType===1?{Headers:n.Headers,Rows:n.Data}:n.Data};_Ewa.Y.f=function(n){return n.CoerceType===1?!n.Data&&!n.Headers:!n.Data};_Ewa.Y.p=function(n){var i,t,r;if(!n)return"unknown";for(i="unknown",t=0;t<n.length;t++)if(n[t].Name.toLowerCase()==="x-officeextension-source"){r=n[t].Value.toLowerCase();r==="officeJs"?i="officeJs":r==="embedded"&&(i="embedded");break}return i};_Ewa.Y.d=function(n,t,i,r){var u={};return u.Code=n,u.Message=t,u.Location=i,u.ActionIndex=r,u};_Ewa.Y.prototype={e:null,d:null,a:null,c:null,j:null,b:null,dispose:function(){this.e=null;this.b=null},r:function(){return!1},q:function(){return!1},p:function(n,t,i){var r=t.a;switch(r){case-567383662:this.a.a(i.CommandValueId,i.DdaMethodCallback);break;case 678398266:this.D(i.CommandValueId,i.DdaMethodCallback);break;case-524856679:this.a.c(i.DdaMethodCallback);break;default:return _Ewa.E.a(r)}return $$sc.a.a(Boolean,!0)},o:function(n,t,i){var r=!!i;if(r)switch(t.a){case 678398266:case-524856679:case-567383662:break;default:r=!1}return r},D:function(n,t){var i=n.DdaMethod,r,u;if(typeof i.DispatchId=="undefined"){this.a.a(5001,t);return}if(!_Ewa.Y.r(n)&&!(this.b.s()&1)){this.a.a(5002,t);return}i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(r=new _Ewa.rw(this.b,this,n,t),r.O(this.d,n.DdaMethod.ControlId)):i.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.C(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.P(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.h(n,this.i(n.DdaMethod.ControlId),0,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.y(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.O(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.x(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.L(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.w(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.F(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.N(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(n.DdaAddRowsColumns.IsRow=!0,this.l(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(n.DdaAddRowsColumns.IsRow=!1,this.l(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.t(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.n(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(n.DdaSetBindingFormats.IsSetFormats=!0,this.m(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(n.DdaSetBindingFormats.IsSetFormats=!1,this.m(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?(u=n.DdaBindingsMethod.FailOnCollision?2:1,this.h(n,n.DdaBindingsMethod.ItemName,u,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.B(t):i.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.H(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.u(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.z(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.A(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.M(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(n.DdaMethod.ControlId,n),this.a.c(t)):i.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.b.b(116)?this.G(n,t):this.a.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.v(n,t):this.a.a(5e3,t)},y:function(n,t){var i,r,u;(n.DdaGetBindingData.CoerceType=_Ewa.Y.e(n.DdaGetBindingData.CoerceType),n.DdaGetBindingData.FilterType=_Ewa.Y.j(n.DdaGetBindingData.FilterType),n.DdaGetBindingData.ValueFormat=_Ewa.Y.k(n.DdaGetBindingData.ValueFormat),this.f(n.DdaGetBindingData.CoerceType,t))&&(n.DdaGetBindingData&&(i=n.DdaGetBindingData,i.FilterType||(i.FilterType=2),i.StartCol=i.StartCol|0,i.StartRow=i.StartRow|0,i.ColCount=isUndefined(i.ColCount)?-1:i.ColCount,i.RowCount=isUndefined(i.RowCount)?-1:i.RowCount),r=this,u=function(n,i,u){if(_Ewa.S.a(n)||!n.Result)r.a.b(n,u,t);else{var f=r.a.d();f.Data=_Ewa.Y.i(n.Result);t(f)}},this.c.g(n.DdaMethod.ControlId,n.DdaGetBindingData.BindingId,n.DdaGetBindingData.CoerceType,n.DdaGetBindingData.ValueFormat,n.DdaGetBindingData.FilterType,n.DdaGetBindingData.StartRow,n.DdaGetBindingData.StartCol,n.DdaGetBindingData.RowCount,n.DdaGetBindingData.ColCount,u,t))},O:function(n,t){var i,r,u;if(n.DdaSetBindingData.CoerceType=_Ewa.Y.e(n.DdaSetBindingData.CoerceType),this.f(n.DdaSetBindingData.CoerceType,t)){if(i=_Ewa.Y.g(n.DdaSetBindingData.CoerceType,n.DdaSetBindingData.Data),_Ewa.Y.f(i)){this.a.a(2e3,t);return}i.CoerceType===1&&(i.CellFormat||(i.CellFormat=n.DdaSetBindingData.CellFormat),i.TableOptions||(i.TableOptions=n.DdaSetBindingData.TableOptions));n.DdaSetBindingData&&(n.DdaSetBindingData.StartCol=n.DdaSetBindingData.StartCol|0,n.DdaSetBindingData.StartRow=n.DdaSetBindingData.StartRow|0);r=this;u=function(n,i,u){_Ewa.S.a(n)?r.a.b(n,u,t):r.a.c(t)};this.c.q(n.DdaMethod.ControlId,n.DdaSetBindingData.BindingId,n.DdaSetBindingData.StartRow,n.DdaSetBindingData.StartCol,i,u,t)}},C:function(n,t){var i,r,u;if(n.DdaGetBindingData.CoerceType=_Ewa.Y.e(n.DdaGetBindingData.CoerceType),n.DdaGetBindingData.ValueFormat=_Ewa.Y.k(n.DdaGetBindingData.ValueFormat),n.DdaGetBindingData.FilterType=_Ewa.Y.j(n.DdaGetBindingData.FilterType),this.f(n.DdaGetBindingData.CoerceType,t)){if(i=this.i(n.DdaMethod.ControlId),!i){this.a.a(1001,t);return}r=this;u=function(n,i,u){if(_Ewa.S.a(n))r.a.b(n,u,t);else{var f=r.a.d();f.Data=_Ewa.Y.i(n.Result);t(f)}};this.c.m(n.DdaMethod.ControlId,n.DdaGetBindingData.CoerceType,n.DdaGetBindingData.ValueFormat,n.DdaGetBindingData.FilterType,i,u,t)}},z:function(n,t){var i;if(this.b.b(92)){if(Common.c.E()){this.a.a(5009,t);return}var o=n,s=o[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],u=o[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],h=n.DdaMethod.ControlId,c=_Ewa.ec.a(this.b);if(u<=0){Diag.a.a(8946265,344,15,"Invalid slice size. It should be greater than 0.");this.a.a(11002,t);return}if(u>4194304){Diag.a.a(8946266,344,15,"Invalid slice size. It should be not greater than 4MB.");this.a.a(1008,t);return}i=null;switch(s){case 1:i="Compressed";break;case 0:i="Text";break;case 2:i="Pdf";break;default:Diag.a.a(8946267,344,15,"Requested file type {0} is not supported.",s);this.a.a(1009,t);return}if(i==="Pdf"||i==="Text"){Diag.a.a(8946268,344,15,"Requested file type {0} is not supported.",i);this.a.a(1009,t);return}var l=_Ewa.ks.b(this.b,i),e=null,r=new XMLHttpRequest,f=this;r.onreadystatechange=function(){var l,n,a,d,v,s,g,y,nt,tt;if(r.readyState===4)if(r.status===200){if(l=r.response,!l){Diag.a.a(8946269,344,15,"Request is successful, but respone have no data for file type {0}.",i);f.a.a(5001,t);return}e=new Uint8Array(l);var p=f.a.d(),w=p,o=e.length,b=++_Ewa.ec.b,k={},it=0;for(n=0;n<o;n=n+u){for(a=[],d=n+u<o?n+u:o,v=0,s=n;s<d;v++,s++)a[v]=e[s];k[(it++).toString()]=a}if(g=new _Ewa.rz(b,o,u,k),y=c.d(h,g),y){f.a.a(y,t);return}w[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=b;w[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=o;Diag.a.a(8946270,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",i,o);t(p)}else r.status===500?(nt=parseInt(r.statusText),tt=_Ewa.gc.b(nt),f.a.a(tt,t)):(Diag.a.a(8946271,344,15,"Request failed to obtain the file for type {0}.",i),f.a.a(11001,t))};r.open("GET",l,!0);r.responseType="arraybuffer";r.setRequestHeader("If-Modified-Since","0");r.send(null)}},A:function(n,t){var u=n,h=u[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],i=u[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()],c=n.DdaMethod.ControlId,l=_Ewa.ec.a(this.b),f=l.e(c,h),r;if(!f){this.a.a(5001,t);return}if(r=f.b,i<0||i>=Object.keys(r).length){this.a.a(5008,t);return}var e=r[i.toString()],o=this.a.d(),s=o;s[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=e;s[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=e.length;t(o)},M:function(n,t){var r=n,u=r[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],f=n.DdaMethod.ControlId,e=_Ewa.ec.a(this.b),i=e.g(f,u);i?this.a.a(i,t):this.a.c(t)},P:function(n,t){var u,i,r,f,e;if(n.DdaSetBindingData.CoerceType=_Ewa.Y.e(n.DdaSetBindingData.CoerceType),this.f(n.DdaSetBindingData.CoerceType,t)){if(u=this.i(n.DdaMethod.ControlId),!u){this.a.a(2001,t);return}if(i=_Ewa.Y.g(n.DdaSetBindingData.CoerceType,n.DdaSetBindingData.Data),r=_Ewa.c.a(this.b).a(),i.CoerceType===1&&(!i.Data&&r.a().n()&&(i.Headers||(i.Headers=[]),i.Headers.length||Array.add(i.Headers,[]),i.Headers[0].length||Array.add(i.Headers[0],"")),_Ewa.Y.f(i)||(i.CellFormat||(i.CellFormat=n.DdaSetBindingData.CellFormat),i.TableOptions||(i.TableOptions=n.DdaSetBindingData.TableOptions))),_Ewa.Y.f(i)){this.a.a(2e3,t);return}f=this;e=function(n,u,e){if(_Ewa.S.a(n))f.a.b(n,e,t);else{var h=r.a(),o=h.e(),s=i.Headers?i.Headers[0].length:i.Data[0].length;i.CoerceType!==1||i.Data?i.CoerceType===1&&i.TableOptions&&i.TableOptions.length&&i.TableOptions[0]==!1?(o.a=o.a+1,o.d=o.a+i.Data.length-1,o.c=o.b+s-1):(o.d=o.a+i.Data.length-(i.CoerceType===1?0:1),o.c=o.b+s-1):(o.d=o.a+1,o.c=o.b+s-1);r.e(o,h,0,!0);f.a.c(t)}};this.c.s(n.DdaMethod.ControlId,u,i,e,t)}},h:function(n,t,i,r){if(!t){this.a.a(3e3,r);return}var u=this,f=function(n,t,i){if(_Ewa.S.a(n))u.a.b(n,i,r);else{var f=u.a.d();f.Bindings=new Array(1);f.Bindings[0]=u.d.d(n.Result);r(f)}};this.c.h(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,n.DdaBindingsMethod.BindingType,t,i,f,r)},x:function(n,t){var i=this,r=function(n,r,u){if(_Ewa.S.a(n)||!n.Result)i.a.b(n,u,t);else{var f=i.a.d();f.Bindings=new Array(1);f.Bindings[0]=i.d.d(n.Result);t(f)}};this.c.f(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},B:function(n){var t=this.a.d(),r=t,i={};i[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.b.j().ClientUrl;r[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=i;n(t)},L:function(n,t){var i=this,r=function(n,r,u){_Ewa.S.a(n)?i.a.b(n,u,t):i.a.c(t)};this.c.o(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},w:function(n,t){var i=this,r=function(n,r,u){var f,o,e;if(_Ewa.S.a(n))i.a.b(n,u,t);else{if(f=i.a.d(),n.Result)for(o=n.Result,f.Bindings=new Array(o.length),e=0;e<o.length;e++)f.Bindings[e]=i.d.d(o[e]);else f.Bindings=null;t(f)}};this.c.l(n.DdaMethod.ControlId,r,t)},F:function(n,t){var i=this,r=function(n,r,u){if(_Ewa.S.a(n))i.a.b(n,u,t);else{var f=i.a.d();f.Properties=n.Result;t(f)}};this.c.n(n.DdaMethod.ControlId,r,t)},N:function(n,t){var f=this,e=function(n,i,r){_Ewa.S.a(n)?f.a.b(n,r,t):f.a.c(t)},u={},i,r;for(u.Settings=[],i=0;i<n.DdaSettingsMethod.Properties.length;i++)r={},r.Name=n.DdaSettingsMethod.Properties[i][0],r.Value=n.DdaSettingsMethod.Properties[i][1],u.Settings[i]=r;this.c.p(n.DdaMethod.ControlId,u,n.DdaSettingsMethod.OverwriteIfStale,e,t)},l:function(n,t){var r=_Ewa.Y.g(1,n.DdaAddRowsColumns.Data),i,u;if(_Ewa.Y.f(r)){this.a.a(2e3,t);return}i=this;u=function(n,r,u){_Ewa.S.a(n)?i.a.b(n,u,t):i.a.c(t)};this.c.i(n.DdaMethod.ControlId,n.DdaAddRowsColumns.BindingId,n.DdaAddRowsColumns.IsRow,r,u,t)},t:function(n,t){var i=this,r=function(n,r,u){_Ewa.S.a(n)?i.a.b(n,u,t):i.a.c(t)};this.c.k(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},n:function(n,t){var i=this,r=function(n,r,u){_Ewa.S.a(n)?i.a.b(n,u,t):i.a.c(t)};this.c.j(n.DdaMethod.ControlId,n.DdaClearBindingFormats.BindingId,r,t)},m:function(n,t){var i={},u=n.DdaSetBindingFormats.IsSetFormats,r,f;u?i.CellFormat=n.DdaSetBindingFormats.CellFormat:i.TableOptions=n.DdaSetBindingFormats.TableOptions;r=this;f=function(n,i,u){_Ewa.S.a(n)?r.a.b(n,u,t):r.a.c(t)};this.c.r(n.DdaMethod.ControlId,n.DdaSetBindingFormats.BindingId,i,u,f,t)},u:function(n,t){var f,i,v,e,h,y,p,u,c,o,l,a;if(!this.b.b(82)){this.a.a(5e3,t);return}if(f=n.ArrayData,i={},f){if(i.HttpMethod=f[1],i.PathAndQuery=f[2],i.RequestHeaders=_Ewa.Y.o(f[3]),i.RequestBody=f[4],i.AppPermission=f[5],v=f[6],i.RequestFlags=v,e=_Ewa.c.a(this.b).a(),h=0,_Ewa.w.b(this.b.i())&&(h=e.d()===1?2:1),y=_Ewa.j.a(e.a(),this.b),p=_Ewa.j.a(e.b(),this.b),i.SheetRange=y,i.ActiveCell=p,i.SelectionState=h,u=this.d.e(n.DdaMethod.ControlId),i.InstanceId=u?u.InstanceId:"",u&&u.PrimaryMarketplace){if(c=u.PrimaryMarketplace.SolutionId,o=u.PrimaryMarketplace.MarketplaceType,o===OSF.StoreType.InMemory){if(u.OwnerAddinAssetId)c=u.OwnerAddinAssetId;else{this.a.a(5004,t);return}if(u.AssetMarketplace)o=u.AssetMarketplace.MarketplaceType;else{this.a.a(5004,t);return}}i.SolutionId=c;i.MarketplaceType=o;i.SolutionVersion=u.PrimaryMarketplace.SolutionVersion;i.StoreLocation=u.PrimaryMarketplace.MarketplaceRef}else i.SolutionId=i.MarketplaceType="";l=$$as(_Ewa.bF,_Ewa.cE.a(this.b));a={};a.IsEventsEnabled=isNullOrUndefined(l)||l.H.c(i.InstanceId);i.CustomData=_Ewa.rE.a(a)}var s=_Ewa.Y.p(i.RequestHeaders),r=this,w=function(n,i,u){var f,e,c,o,h,l;if(_Ewa.S.a(n)||!n.Result)r.g(!1,"Server error",_Ewa.v.a(n.Errors),s),r.a.b(n,u,t);else if(f=n.Result,r.g(!0,null,f.ResponseStatusCode.toString(),s),e=f.SheetRange,c=f.SelectionState,c===3&&e?r.b.e()&&(r.b.e().g(e.SheetName)?(o=$$as(_Ewa.z,r.b.e().e(e.SheetName)),o&&!o.i&&o.e()):(h=null,h=function(){if(r.b.e().g(e.SheetName)){var n=$$as(_Ewa.z,r.b.e().e(e.SheetName));n&&!n.i&&n.e();r.b.e().p(h)}},r.b.e().n(h))):c===4&&_Ewa.c.a(r.b).o(e,null,null,null,3,!0,!0,null),!f.PostProcessActions)r.k(f,t,null);else{if(!r.b.bx()){r.g(!1,"Promise not supported","Promise is not supported on this browser.",s);r.a.a(5001,t);return}l=_Ewa.v.b(f.PostProcessActions);r.K(l).then(function(){return r.k(f,t,null),Promise.resolve(null)},function(n){return r.k(f,t,n),Promise.reject(n)})}},b=this;this.c.t(i,w,function(n){b.g(!1,"Web service error",null,s);t(n)})},k:function(n,t,i){var u=new Array(3),e,o,f,r,s;u[0]=n.ResponseStatusCode;u[1]=_Ewa.Y.q(n.ResponseHeaders);e=new Array(0);o=!1;i&&n.ResponseBody&&(f=_Ewa.v.b(n.ResponseBody.join("")),f.Error||(r={},r.Error=i,r.TraceIds=f.TraceIds,r.ProcessedResults={},r.ProcessedResults.Results=f.Results,e[0]=_Ewa.v.a(r),o=!0));u[2]=o?e:n.ResponseBody;s=this.a.d();s.Data=u;t(s)},H:function(n,t){var i=new _Ewa.ii(this.b,this.a,this.c);i.d(n,t)},G:function(n,t){Diag.a.a(19931724,0,50,"MessageParent API called!");var r=n,u=r[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],f=this.b.a().a(_Ewa.hc,226),i=f.b().c(n.DdaMethod.ControlId,u);i?(Diag.a.a(19931725,0,10,"MessageParent API Failed!"),this.a.a(i,t)):this.a.c(t)},v:function(n,t){if(!this.b.b(174)||!Common.a.bv){this.a.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t);return}Diag.a.a(22071488,0,50,"GetAccessToken API called!");var i=this,r=function(r,u){var f,o,e;r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(f=i.a.d(),o=f,o[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=u,t(f)):(e=i.d.e(n.DdaMethod.ControlId),Diag.a.a(22071489,0,10,"{0}.",{errorCode:r.toString(),appId:e.PrimaryMarketplace.SolutionId,storeType:e.PrimaryMarketplace.MarketplaceType}),i.a.a(r,t))},u=this;_Ewa.d.c(_Ewa.k.a(Common.T,this.b.a(),133,this.b.k()),function(t){var i=n,f=u.d.a(),e=Common.App.AppsForOffice.a.c(f,t.a());e.a(n.DdaMethod.ControlId,i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForceConsent]||!1,i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,r,null)},this.b.k())},E:function(n){var t=_Ewa.c.a(this.b).a();return t.d()===16&&!!t.c()&&!!t.c().a()&&_Ewa.g.a(t.c().a().b,n,!0)},i:function(n){var t=_Ewa.c.a(this.b).a();return t.d()===1||this.E(n)?t.p():null},f:function(n,t){return(n===1||n===2||n===3)?!0:(this.a.a(1e3,t),!1)},g:function(n,t,i,r){var u={};u.a=this.b.g().UserSessionId;u.b=n;u.c=t;u.d=i;u.e=r;_Ewa.y.a().a(35,u,!1)},K:function(n){for(var r=this,t=new Promise(function(n){n(null)}),i=0;i<n.length;i++)t=this.J(t,n[i]);return t},J:function(n,t){var a,i,o,s,f,r,u,e,h,c,l,v;if(!t)return Diag.a.a(34625095,0,10,"Null PostProcessAction."),a=this,n.then(function(){return Promise.reject(_Ewa.Y.d("GeneralException",_Ewa.b.a().a(1257),null,0))});switch(t.actionType){case 1:case 2:i=t;o=this;n=n.then(function(){var n=$$as(_Ewa.bF,_Ewa.cE.a(o.b));if(n.G(i.controlId)){n.H.j(i);switch(i.messageType){case 14:case 100:n.R.m(i);break;case 11:case 12:n.ba.p(i);break;case 51:case 52:n.Z.o(i)}}else Diag.a.a(23941466,0,10,"OsfControl with instanceId[{0}] doesn't exist.",i.controlId);return Promise.resolve(null)});break;case 3:s=t;f=this;n=n.then(function(){return _Ewa.d.cw(_Ewa.k.a(_Ewa.em,f.b.a(),149,f.b.k()),function(n){n.a().l(s.operationType===2)},f.b.k(),3),Promise.resolve(null)});break;case 4:r=t;u=this;n=n.then(function(){var n,t;return u.b.b(221)&&(n=_Ewa.c.a(u.b).a().b(),n.a!==r.row+1&&n.b!==r.column+1&&(t=_Ewa.j.a(_Ewa.o.a(r.row+1,r.column+1,!1),u.b),_Ewa.c.a(u.b).o(t,null,null,null,3,!0,!0,null)),_Ewa.hE.a(_Ewa.eZ,u.b,237,236,function(n){n.a(r.row+1,r.column+1,!1)})),Promise.resolve(null)});break;case 7:e=t;h=this;n=n.then(function(){var n=$$as(_Ewa.bF,_Ewa.cE.a(h.b));return n.H.g(e.controlId,e.isEnableEvents),Promise.resolve(null)});break;case 5:c=this;n=n.then(function(){return c.s(t)});break;case 6:l=this;n=n.then(function(){return l.I(t)});break;default:v=this;n=n.then(function(){return Promise.reject(_Ewa.Y.d("ApiNotFound",_Ewa.b.a().a(1258),null,0))})}return n},s:function(n){var t=n.fileBase64,i=this,r=new Promise(function(n,r){var u=new CommonUI.d;u.g(4);u.c($a.L,$a.cZ,1,function(u){u!==2&&u||r(_Ewa.Y.d("OperationCancelled",_Ewa.b.a().a(1259),"Application.CreateWorkbook",0));var f=t?"streamBase64":"streamEmpty",e=new Common.App.NewAndOpen.UX.i("blank","agave",f,t),o=i.j.a(n,r,e);o.s()})}),u=this,f=this;return r.then(function(t){return u.e.e(n.fakeFileId,t),Promise.resolve(null)},function(n){return n?Promise.reject(n):Promise.reject(_Ewa.Y.d("GeneralException",_Ewa.b.a().a(1257),"Application.CreateWorkbook",0))})},I:function(n){var t=this;return new Promise(function(i,r){var u=null,e,o,f;(o=t.e.g(n.fakeFileId,e={val:u}),u=e.val,o)?(f=new CommonUI.d,f.g(4),f.c($a.L,$a.dQ,1,function(n){n===1&&window.open(u);i(null)})):r(_Ewa.Y.d("GeneralException",_Ewa.b.a().a(1257),"Document.Open",0))})}};_Ewa.ii=function(n,t,i){this.a=n;this.b=t;this.c=i};_Ewa.ii.a=function(n,t){n.LastRow=t===2?n.FirstRow:n.LastRow;n.LastColumn=t===2?n.FirstColumn:n.LastColumn};_Ewa.ii.prototype={b:null,c:null,a:null,d:function(n,t){var r=n.DdaGoToByIdMethod.GoToType,u=n.DdaGoToByIdMethod.SelectionMode,f=n.DdaGoToByIdMethod.Id.toString().trim(),i=this,e=function(n){var r=i.a.e().e(n.SheetName);r.i?i.b.a(7001,t):(_Ewa.c.a(i.a).o(n,null,null,null,3,!0,!0,null),i.b.c(t))};r?r===1?this.f(f,u,e,t):this.b.a(5007,t):this.e(f,u,n.DdaMethod.ControlId,e,t)},e:function(n,t,i,r,u){var f=this,e=function(e){var s,o,h;if(_Ewa.S.a(e)||!e.Result||!e.Result.Reference){f.b.a(7002,u);return}if(s=e.Result,o={},o.SheetName=s.Reference.SheetName,o.FirstRow=s.Reference.FirstRow,o.FirstColumn=s.Reference.FirstColumn,o.LastRow=s.Reference.LastRow,o.LastColumn=s.Reference.LastColumn,_Ewa.ii.a(o,t),s.BindingType!==1){r(o);return}h=function(n,i,e){if(_Ewa.S.a(n)||!n.Result)f.b.b(n,e,u);else{var s=n.Result;t!==2&&(o.FirstRow-=s.Headers.length,o.FirstRow<0&&(o.FirstRow=0));r(o)}};f.c.g(i,n,1,0,2,0,0,-1,-1,h,u)};this.c.f(i,n,e,u)},f:function(n,t,i,r){var o=_Ewa.j.d(n),u,f,e;if(o){u=_Ewa.j.a(o,this.a);_Ewa.ii.a(u,t);i(u);return}if(this.a.c().a()&&this.a.l().g(n)){this.a.l().m(this.a.l().e(n));return}f=this;e=function(u){var e,o;_Ewa.S.a(u)||!u.Result?f.a.e().z(n)?(e={},e.SheetName=n,e.FirstRow=0,e.FirstColumn=0,e.LastRow=0,e.LastColumn=0,i(e)):f.b.a(7002,r):(o=u.Result,_Ewa.ii.a(o,t),i(o))};this.a.e().a()?this.c.w(n,this.a.e().a().a,e,r):this.c.v(n,e,r)}};_Ewa.ry=function(n,t){this.b=Function.createDelegate(this,this.u);this.a=n;this.e=t};_Ewa.ry.prototype={e:null,a:null,h:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h){return _Ewa.cx.b(o.a.d().a(),n,t,i,o.d(),r,u,_Ewa.m.a(s,f),_Ewa.m.b(h,o.b),e)})},o:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.cx.k(u.a.d().a(),n,t,_Ewa.m.a(f,i),_Ewa.m.b(e,u.b),r)})},f:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.cx.h(u.a.d().a(),n,t,_Ewa.m.a(f,i),_Ewa.m.b(e,u.b),r)})},l:function(n,t,i){var r=this;this.c(function(u,f){return _Ewa.cx.g(r.a.d().a(),n,_Ewa.m.a(u,t),_Ewa.m.b(f,r.b),i)})},g:function(n,t,i,r,u,f,e,o,s,h,c){var l=this;this.c(function(a,v){return _Ewa.cx.i(l.a.d().a(),n,t,i,r,u,f,e,o,s,l.d(),_Ewa.m.a(a,h),_Ewa.m.b(v,l.b),c)})},q:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h){return _Ewa.cx.m(o.a.d().a(),n,t,i,r,o.d(),u,_Ewa.m.a(s,f),_Ewa.m.b(h,o.b),e)})},m:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h){return _Ewa.cx.j(o.a.d().a(),n,t,i,r,o.d(),u,_Ewa.m.a(s,f),_Ewa.m.b(h,o.b),e)})},s:function(n,t,i,r,u){var f=this;this.c(function(e,o){return _Ewa.cx.o(f.a.d().a(),n,f.d(),t,i,_Ewa.m.a(e,r),_Ewa.m.b(o,f.b),u)})},n:function(n,t,i){var r=this;this.c(function(u,f){return _Ewa.cx.a(r.a.d().a(),n,_Ewa.m.a(u,t),_Ewa.m.b(f,r.b),i)})},p:function(n,t,i,r,u){var f=this;this.c(function(e,o){return _Ewa.cx.l(f.a.d().a(),n,t,i,_Ewa.m.a(e,r),_Ewa.m.b(o,f.b),u)})},i:function(n,t,i,r,u,f){var e=this;this.c(function(o,s){return _Ewa.cx.c(e.a.d().a(),n,t,i,e.d(),r,_Ewa.m.a(o,u),_Ewa.m.b(s,e.b),f)})},k:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.cx.e(u.a.d().a(),n,t,u.d(),_Ewa.m.a(f,i),_Ewa.m.b(e,u.b),r)})},j:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.cx.d(u.a.d().a(),n,t,u.d(),_Ewa.m.a(f,i),_Ewa.m.b(e,u.b),r)})},r:function(n,t,i,r,u,f){var e=this;this.c(function(o,s){return _Ewa.cx.n(e.a.d().a(),n,t,e.d(),i,r,_Ewa.m.a(o,u),_Ewa.m.b(s,e.b),f)})},v:function(n,t,i){var r=this;this.c(function(u,f){var e=r.a.d().a().b();return _Ewa.f.e(r.a.d().a(),n,-1,_Ewa.m.a(u,t),_Ewa.m.b(f,r.b),i,e)})},w:function(n,t,i,r){var u=this;this.c(function(f,e){var o=u.a.d().a().b();return _Ewa.f.r(u.a.d().a(),n,t,_Ewa.m.a(f,i),_Ewa.m.b(e,u.b),r,o)})},t:function(n,t,i){var r=this;this.c(function(u,f){return _Ewa.cx.f(r.a.d().a(),n,_Ewa.m.a(u,t),_Ewa.m.b(f,r.b),i)})},d:function(){return this.a.c().a()?this.a.i().f:this.a.bb()},u:function(n,t){this.e.a(5001,t)},c:function(n){this.a.h().c(new _Ewa.bg(0,n,0))}};_Ewa.rz=function(n,t,i,r){this.a=n;this.c=t;this.d=i;this.b=r};_Ewa.rz.prototype={a:0,c:0,d:0,b:null};_Ewa.ec=function(n){this.a={};this.c=n};_Ewa.ec.a=function(n){return n.a().a(_Ewa.ec,195)||n.a().b(_Ewa.ec,195,new _Ewa.ec(_Ewa.ec.c))};_Ewa.ec.prototype={c:0,a:null,d:function(n,t){return(this.b(n)||(this.a[n]={}),this.f(n))?(Diag.a.a(8946273,344,50,"App {0} has reach the limit of number of cached files.",n),11e3):(this.a[n][t.a.toString()]=t,0)},e:function(n,t){var i=null;return this.b(n)&&(i=this.a[n][t.toString()]),i||Diag.a.a(8946274,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",n,t),i},b:function(n){return n in this.a},g:function(n,t){if(this.b(n)){var i=this.a[n];return delete i[t.toString()],Object.keys(i).length<1&&delete this.a[n],t.toString()in i?5001:0}return 5001},f:function(n){if(!this.b(n))return!1;var t=this.a[n];return Object.keys(t).length>=this.c}};_Ewa.rE=function(){};_Ewa.rE.a=function(n){return n?JSON.stringify(n):""};_Ewa.lB.registerClass("_Ewa.lB",_Ewa.Q);_Ewa.rw.registerClass("_Ewa.rw",_Ewa.gs);_Ewa.rz.registerClass("_Ewa.rz");_Ewa.ec.registerClass("_Ewa.ec");_Ewa.Y.a=null;_Ewa.Y.b=null;_Ewa.Y.c=null;_Ewa.ec.c=1;_Ewa.ec.b=0;_Ewa.BL.a();