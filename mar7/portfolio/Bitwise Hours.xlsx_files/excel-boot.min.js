var Microsoft=Microsoft||{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var t={};return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},i.p="/dist/",i(i.s=19)}([function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return Object.defineProperty(e,"BUILD_NUMBER",{get:function(){return "16.0.9128.5050"},enumerable:!0,configurable:!0}),e}();i.BuildVersionConfig=o},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return e.getApplicationBaseUrl=function(e){var i=e.indexOf("/",8);if(i<0)throw new Error("URL should contain a / after domain");var t=e.indexOf("/",i+1);if(t>=0)return e.substr(0,t+1);throw new Error("URL should contain a / after domain and folder")},e.getParameterValue=function(e,i){var t=e.indexOf("&"+i+"=");if(-1===t&&(t=e.indexOf("?"+i+"=")),-1===t)return"";var o=t+(i.length+2),n=e.indexOf("&",o);return-1===n?e.substr(o):e.substring(o,n)},e.getOrigin=function(e){return e.replace(/^(.*\/\/[^\/?#]*).*$/,"$1")},e.addQueryParam=function(e,i,t){var o=e,n=o.indexOf("?"),a="&";return n===o.length-1||"&"===o.slice(-1)?a="":-1===n&&(a="?"),"&"===a&&o.indexOf(i+"=",n)>=0?o:o.concat(a,i,"=",t)},e}();i.UrlUtils=o},function(e,i,t){"use strict";function o(e,i){var t=new l.bUlsCache(e,i);return{ULS:{trace:function(e,i,o){return n(t,0,e,i,o)},traceTag:function(e,i,o,a){return n(t,e,i,o,a)},flush:t.flush,flushOnClose:t.flushOnClose}}}function n(e,i,t,o,n){if(!(o>c)){var a={timestamp:Date.now(),category:t,tag:i,level:o,type:s.logType.Trace,message:n};e.handleTrace(a)}}Object.defineProperty(i,"__esModule",{value:!0});var a=t(5);i.logCategory=a.logCategory;var r=t(6);i.logLevel=r.logLevel;var s=t(23),l=t(20);i.ULS={getLogger:o};var c=r.logLevel.Info},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return Object.defineProperty(e,"Unknown",{get:function(){return"Unknown"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AppInitError",{get:function(){return"AppInitError"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CannotLoadFirstPage",{get:function(){return"CannotLoadFirstPage"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CannotLoadScript",{get:function(){return"CannotLoadScript"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PageChangeError",{get:function(){return"PageChangeError"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ZoomChangeError",{get:function(){return"ZoomChangeError"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CannotLoadBundleItem",{get:function(){return"CannotLoadBundleItem"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"InvalidPageIndex",{get:function(){return"InvalidPageIndex"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UnsupportedBundleVersion",{get:function(){return"UnsupportedBundleVersion"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"InvalidWopiInfo",{get:function(){return"InvalidWopiInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TimeoutWacReady",{get:function(){return"TimeoutWacReady"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WacFailed",{get:function(){return"WacFailed"},enumerable:!0,configurable:!0}),e}();i.ApplicationErrors=o},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(5),n=function(){function e(e){this.sessionTraces={},this.logger=e}return e.prototype.add=function(e,i){this.sessionTraces[e]=i},e.prototype.get=function(e){return this.sessionTraces[e]},e.prototype.log=function(e){this.logger.ULS.traceTag(596459999,o.logCategory.WopiPendingApplication,e,"sessionTraces:"+JSON.stringify(this.sessionTraces))},e.prototype.stringify=function(){return JSON.stringify(this.sessionTraces)},e.wopiInitializeTime="wopiInitializeTime",e.wopiPendingInitializeTime="wopiPendingInitializeTime",e.wopiPendingCompleteTime="wopiPendingCompleteTime",e.startSessionStartTime="startSessionStartTime",e.startSessionCompleteTime="startSessionCompleteTime",e.readyMessageReceiveTime="readyMessageReceiveTime",e.completeMessageSendTime="completeMessageSendTime",e.completeMessageCreateTime="completeMessageCreateTime",e}();i.SessionTraces=n},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});!function(e){e[e.ExcelEwaJs=0]="ExcelEwaJs",e[e.WordViewer=301]="WordViewer",e[e.WopiPendingApplication=379]="WopiPendingApplication",e[e.VisioApp=700]="VisioApp",e[e.PptSession=817]="PptSession"}(i.logCategory||(i.logCategory={}))},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});!function(e){e[e.Spam=200]="Spam",e[e.Verbose=100]="Verbose",e[e.Info=50]="Info",e[e.Warning=15]="Warning",e[e.Error=10]="Error"}(i.logLevel||(i.logLevel={}))},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return e.assembleFromMessagePayload=function(e,i){if(e&&e.Diagnostics){var t=e.Diagnostics;for(var o in t)i[o]=t[o]}},e}();i.DiagnosticsHelper=o},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return e.createWacFrame=function(e){var i=e.ownerDocument.createElement("iframe");return i.name="WebApplicationFrame",i.id="WebApplicationFrame",i.src="",i.title="Office Online Frame",i.width="100%",i.height="100%",i.marginWidth="0",i.marginHeight="0",i.style.left="0",i.style.top="0",i.style.right="0",i.style.bottom="0",i.style.display="block",i.style.position="absolute",i.style.backgroundColor="transparent",i.style.border="none",i.frameBorder="0",i.allowFullscreen=!0,i.setAttribute("allowTransparency","true"),e.appendChild(i),i},e.createAndSubmitWacFrame=function(i,t,o){var n=e.createWacFrame(i),a=i.ownerDocument,r=a.createElement("form");r.id="office_form",r.name="office_form",r.action=t,r.target=n.name,r.method="POST";for(var s in o){var l=a.createElement("input");l.name=s,l.value=o[s],l.type="hidden",r.appendChild(l)}return i.appendChild(r),r.submit(),n},e.wacReadyTimeoutInMs=5e3,e.completeOrFailTimeoutInMs=5e3,e.wacAppCompleteOrFailTimeoutInMs=15e3,e.postMessageMaxRetries=3,e.wacSessionCompleteAckTimeoutInMs=1e3,e.wacFrameAccessToken="access_token",e.wacFrameAccessTokenTtl="access_token_ttl",e.wacFrameBundleSource="bundleSrc",e.wacFrameFileGetUrl="fileGetUrl",e.wacFrameFileExtension="fileExtension",e.wacFrameOwnerId="owner_id",e.wacFrameUserId="user_id",e.wacFrameHostDiagnostics="host_diagnostics",e.fromWacFrameInitReady="WacInitialize_Ready",e.fromWacFrameInitFrameLoaded="WacInitialize_FrameLoaded",e.fromWacFrameAppCompleted="Wac_AppCompleted",e.fromWacFrameAppFailed="Wac_AppFailed",e.fromWacFrameSessionCompleteAck="WopiSession_Complete_Ack",e.toWacFrameFailSession="WopiPendingSession_Fail",e.toWacFrameInitReadyAck="WacInitialize_Ready_Ack",e.toWacFramePendingSessionComplete="WopiPendingSession_Complete",e.toWacFrameStartSessionComplete="WopiStartSession_Complete",e}();i.OfficeFrameUtils=o},function(e,i,t){"use strict";function o(e,i,t,o){return new a(e,i,t,o)}Object.defineProperty(i,"__esModule",{value:!0});var n=t(0),a=function(){function e(e,i,t,o){this.sessionId=e,this.logger=i,this.innerApplicationFrame=o,this.postMessenger=t}return e.prototype.GetApplicationType=function(){throw new Error("Not implemented")},e.prototype.GetVersion=function(){return n.BuildVersionConfig.BUILD_NUMBER},e.prototype.GetSessionId=function(){return this.sessionId},e.prototype.RegisterEventHandler=function(e,i){this.postMessenger.RegisterMessagePayloadHandler(e,i)},e.prototype.RemoveEventHandler=function(e,i){this.postMessenger.RemoveMessageHandler(e)},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.Dispose=function(){this.logger&&this.logger.ULS.flushOnClose(),this.innerApplicationFrame&&this.innerApplicationFrame.parentElement&&this.innerApplicationFrame.parentElement.removeChild(this.innerApplicationFrame),delete this.innerApplicationFrame},e}();i.Application=a,i.ApplicationFactory=o},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(18),n=t(3),a=t(15),r=t(2),s=t(0),l=t(1),c=t(16),p=t(4),g=t(12),d=function(){function e(e,i){this.appFactory=e,this.bootstrapperParameters=i}return e.prototype.GetVersion=function(){return s.BuildVersionConfig.BUILD_NUMBER},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){},e.prototype.InitializeWopiPending=function(i){var t=void 0;try{e.validateParametersWopiPending(i);var d=g.getApplicationParameters(i);d.forceFallback=this.bootstrapperParameters.forceFallback,d.bundleUrlPlaceholderReplaceWith=this.bootstrapperParameters.bundleUrlPlaceholderReplaceWith,t=r.ULS.getLogger(d.sessionId,d.applicationBaseUrl+"RemoteUls.ashx"),t.ULS.traceTag(596464283,r.logCategory.WopiPendingApplication,r.logLevel.Info,"ApplicationBootstrapper - initializing session. Build version: "+this.GetVersion());var u=JSON.parse(JSON.stringify(d.sessionInformation));delete u.UserId,delete u.OwnerId,t.ULS.traceTag(596444237,r.logCategory.WopiPendingApplication,r.logLevel.Info,JSON.stringify({hostSessionInformation:u})),t.ULS.traceTag(596444238,r.logCategory.WopiPendingApplication,r.logLevel.Info,JSON.stringify({hostInitDiagnostics:d.diagnostics?d.diagnostics:"N/A"}));var f=l.UrlUtils.getOrigin(i.ApplicationUrl),m=new a.PostMessageHandler(f,t),h=new c.WindowVisibilityMetrics,y=new p.SessionTraces(t),S=g.getWopiFallbackInfo(d,t),w={officeSessionId:d.sessionId,officeBootstrapperVersion:s.BuildVersionConfig.BUILD_NUMBER},v=e.getSuccessCallback(w,d.sessionId,m,t,y,h,i.FnOnInitializeSuccess,this.appFactory),I=e.getFailureCallback(w,t,y,h,i.FnOnInitializeFailure),F=new o.WopiPendingApplicationInitializer(d,S,w,t,m,h,y,v,I);return F.Boot(),F}catch(e){return t&&(t.ULS.traceTag(596459925,r.logCategory.VisioApp,r.logLevel.Error,n.ApplicationErrors.AppInitError+": "+JSON.stringify(e)),t.ULS.flushOnClose()),void i.FnOnInitializeFailure({errorType:n.ApplicationErrors.AppInitError,errorObject:e},void 0)}},e.getSuccessCallback=function(i,t,o,n,a,s,l,c){return function(p){e.traceTabSwitchDiagnostics(i,a,s),a.log(r.logLevel.Info),n.ULS.traceTag(596448985,r.logCategory.WopiPendingApplication,r.logLevel.Info,JSON.stringify(i));var g=c(t,n,o,p);l(g,i)}},e.getFailureCallback=function(i,t,o,n,a){return function(s){e.traceTabSwitchDiagnostics(i,o,n),o.log(r.logLevel.Warning),t.ULS.traceTag(596448986,r.logCategory.WopiPendingApplication,r.logLevel.Error,JSON.stringify({error:s,appInitDiagnostics:i})),a(s,i)}},e.traceTabSwitchDiagnostics=function(e,i,t){t.Stop();var o=t.GetVisibilityChangeEvents();null!=o&&o.length>0&&(e.documentLoadedWithTabSwitch=!0,i.add("tabSwitchDiagnostics",JSON.stringify(o)))},e.validateParametersWopiPending=function(e){if(void 0===e)throw new TypeError("initParams");var i=e.Container;if(void 0===i||void 0===i.appendChild)throw new TypeError("Container");var t=e.SessionInformation;if(void 0===t||void 0===t.HostName||void 0===t.HostSessionId||void 0===t.UserId)throw new TypeError("SessionInformation");var o=e.ApplicationUrl;if(void 0===o||"string"!=typeof o)throw new TypeError("ApplicationUrl");var n=e.WopiPrecheckInfo;if(void 0===n||void 0===n.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")},e}();i.ApplicationBootstrapper=d},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(13),n=t(14),a=function(){function e(e,i){this.forceShip=e&&e.forceShip,this.appBundleUrl=this.getBaseUrl(i,e&&e.appBundleCustomUrl)}return e.prototype.getBaseUrl=function(i,t){if(void 0!==t)return t;if(void 0!==i){var n=e.getHost(i);if(n)return o.ApplicationRoot.baseUrl(n)}return o.ApplicationRoot.defaultBaseUrl},Object.defineProperty(e.prototype,"baseUrl",{get:function(){return this.appBundleUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prefetchJsPaths",{get:function(){return["app_scripts/compat"+this.getDebugSuffix()+".js","app_scripts/microsoftajax"+this.getDebugSuffix()+".js","app_scripts/wordinstantviewer"+this.getDebugSuffix()+".js","app_scripts/wordinstantviewer"+this.getDebugSuffix()+".dll1.js"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssPaths",{get:function(){return["resources/1033/wordviewer.css"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preReqJsPaths",{get:function(){return["app_scripts/compat"+this.getDebugSuffix()+".js","app_scripts/microsoftajax"+this.getDebugSuffix()+".js"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appJsPaths",{get:function(){return["app_scripts/wordinstantviewer"+this.getDebugSuffix()+".js"]},enumerable:!0,configurable:!0}),e.prototype.getDebugSuffix=function(){return n.DebugConfig.DEBUG_SUFFIX&&!this.forceShip?n.DebugConfig.DEBUG_SUFFIX:""},e.getHost=function(e){var i=e.match(/^(https?\:\/\/[^\/?#]+)(?:[\/?#]|$)/i);return i&&i[1]?i[1]:""},e}();i.ApplicationFiles=a},function(e,i,t){"use strict";function o(e){return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:e.Diagnostics,fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,applicationFiles:new r.ApplicationFiles(e.ApplicationCustomSettings&&e.ApplicationCustomSettings.appBundleParameters,e.BootstrapperUrl),sessionId:n(),applicationBaseUrl:s.UrlUtils.getApplicationBaseUrl(e.ApplicationUrl),wopiInfo:e.WopiInfo,forceFallback:!1,disableFallback:!1,bundleUrlPlaceholderReplaceWith:void 0}}function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=16*Math.random()|0;return("x"===e?i:3&i|8).toString(16)})}function a(e,i){if(e.forceFallback)return{required:!0,applicationUrl:e.applicationUrl,forceFallback:!0,reason:h};var t={required:!1,applicationUrl:"",reason:"",ignoreWacFramePostMessages:!1,forceFallback:!1,singleFlushFallback:!1};if(e.disableFallback)return t;var o=e.applicationUrl.toLowerCase(),n=o.indexOf(p),a=n>=0,r=o.indexOf(g)>=0;if(a?e.wopiPrecheckInfo.ReadOnly?i.ULS.traceTag(596444181,l.logCategory.WopiPendingApplication,c.logLevel.Warning,"Unexpected read only session requested with an action=edit application url."):e.wopiInfo&&(t.required=!0,t.singleFlushFallback=!0,t.reason=d):(t.required=!0,t.ignoreWacFramePostMessages=!0,t.reason=r?f:m),!0===e.wopiPrecheckInfo.IrmEnabled&&(t.required=!0,t.irmFallback=!0,t.ignoreWacFramePostMessages=!0,t.reason=u),t.required){t.applicationUrl=-1===n||t.singleFlushFallback?e.applicationUrl:e.applicationUrl.substr(0,n)+g+e.applicationUrl.substr(n+p.length);var s={fallbackIsRequired:!0,fallbackReason:t.reason,gotWordEditUrl:a,gotWordViewUrl:r,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly};i.ULS.traceTag(596444182,l.logCategory.WopiPendingApplication,c.logLevel.Warning,JSON.stringify(s))}else i.ULS.traceTag(596444183,l.logCategory.WopiPendingApplication,c.logLevel.Info,"Received input valid for instant boot.");return t}Object.defineProperty(i,"__esModule",{value:!0});var r=t(11),s=t(1),l=t(5),c=t(6);i.getApplicationParameters=o,i.newGuid=n;var p="we/wordeditorframe.aspx",g="wv/wordviewerframe.aspx",d="Unified_SingleFlushFallback",u="Unified_IrmEnabled",f="Unified_ViewActionUrl",m="Unified_NotEditOrViewActionUrl",h="Force_Fallback";i.getWopiFallbackInfo=a},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(0),n=function(){function e(){}return Object.defineProperty(e,"defaultBaseUrl",{get:function(){throw"BootstrapperUrl has to be provided for Instant Viewer to work from WAC CDN"},enumerable:!0,configurable:!0}),e.baseUrl=function(i){return i+"/wv/s/"+e.contentVersion+"_"},Object.defineProperty(e,"contentVersion",{get:function(){var e=o.BuildVersionConfig.BUILD_NUMBER;return e.substr(0,2)+e.substr(5,4)+e.substr(10,4)},enumerable:!0,configurable:!0}),e}();i.ApplicationRoot=n},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DebugConfig={DEBUG_SUFFIX:""}},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(2),n=function(){function e(e,i){var t=this;if(this.eventHandlers={},!e)throw new Error("Missing origin for PostMessageHandler");this.logger=i,this.origin=e.toLowerCase(),window.addEventListener("message",function(e){return t.handleWacFramePostMessage(e)},!1)}return e.prototype.RegisterMessagePayloadHandler=function(e,i){if(this.eventHandlers[e])throw new Error("Duplicate registration!");this.eventHandlers[e]=i},e.prototype.RemoveMessageHandler=function(e){delete this.eventHandlers[e]},e.prototype.SendPostMessage=function(e,i,t){this.logger.ULS.traceTag(596464334,o.logCategory.WopiPendingApplication,o.logLevel.Info,"PostMessageHandler - Sending message: "+i);var n={MessageId:i,SendTime:Date.now(),Values:t};this.sendPostMessageInternal(e,JSON.stringify(n),this.origin)},e.prototype.Dispose=function(){delete this.eventHandlers},e.prototype.handleWacFramePostMessage=function(e){if(e.origin&&e.origin.toLowerCase()===this.origin){var i;try{i=JSON.parse(e.data)}catch(e){return void this.logger.ULS.traceTag(596464282,o.logCategory.WopiPendingApplication,o.logLevel.Error,"PostMessageHandler - failed to parse event data: "+JSON.stringify(e))}var t=i.MessageId;if(t){var n=this.eventHandlers[t];if(!n)return void this.logger.ULS.traceTag(596464289,o.logCategory.WopiPendingApplication,o.logLevel.Info,"PostMessageHandler - no handler found for message id: "+t);this.logger.ULS.traceTag(596464288,o.logCategory.WopiPendingApplication,o.logLevel.Info,"PostMessageHandler - processing message: "+t),n(i.Values||{})}}},e.prototype.sendPostMessageInternal=function(e,i,t){e.postMessage(i,t)},e}();i.PostMessageHandler=n},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.VisibilityChangeEvents=[];var o=function(){function e(){this.initialize()}return e.prototype.initialize=function(){if("hidden"===document.visibilityState){var e={visibility:document.visibilityState,time:Date.now(),initialState:!0};i.VisibilityChangeEvents.push(e)}document.addEventListener("visibilitychange",this.handleVisibilityChange)},e.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},e.prototype.GetVisibilityChangeEvents=function(){return i.VisibilityChangeEvents},e.prototype.handleVisibilityChange=function(){var e={visibility:document.visibilityState,time:Date.now(),initialState:!1};i.VisibilityChangeEvents.push(e)},e}();i.WindowVisibilityMetrics=o},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(2),n=t(7),a=t(1),r=t(8),s=t(4),l=t(3),c=function(){function e(e,i,t,o,n,a,r,l,c){if(this.wacAppCompleteOrFailReceived=!1,void 0===i)throw new TypeError("wopiFallbackInfo");if(i.required&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.appParams=e,this.wopiFallbackInfo=i,this.logger=n,this.postMessenger=a,this.visibilityMetrics=r,this.fnOnWopiBootSuccess=l,this.fnOnWopiBootFailure=c,this.appInitDiagnostics=t,this.sessionTraces=o,this.sessionTraces.add(s.SessionTraces.wopiInitializeTime,Date.now())}return e.prototype.Boot=function(){this.logger.ULS.traceTag(596444241,o.logCategory.WopiPendingApplication,o.logLevel.Info,"Initializing Office frame"),this.wopiFallbackInfo.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers();var i=e.buildApplicationBootUrl(this.appParams,this.wopiFallbackInfo),t=e.buildWacFramePostData(this.appParams);return this.bootWacFrame(i,t),this.wopiFallbackInfo.ignoreWacFramePostMessages&&this.fnOnWopiBootSuccess(this.innerApplicationFrame),this.innerApplicationFrame},e.prototype.bootWacFrame=function(e,i){var t=this;window.setTimeout(function(){return t.timeoutWacAppCompleteOrFail()},r.OfficeFrameUtils.wacAppCompleteOrFailTimeoutInMs),this.appInitDiagnostics.officeFrameCreateTime=Date.now(),this.sessionTraces.add("frameCreateStartTime",this.appInitDiagnostics.officeFrameCreateTime),this.innerApplicationFrame=r.OfficeFrameUtils.createAndSubmitWacFrame(this.appParams.container,e,i)},e.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var e=this;this.postMessenger.RegisterMessagePayloadHandler(r.OfficeFrameUtils.fromWacFrameAppCompleted,function(i){e.handleWacCompleteMessage(i)}),this.postMessenger.RegisterMessagePayloadHandler(r.OfficeFrameUtils.fromWacFrameAppFailed,function(i){e.handleWacFailureMessage(i)})},e.prototype.handleWacCompleteMessage=function(e){if(this.wacAppCompleteOrFailReceived)return void this.logger.ULS.traceTag(596444234,o.logCategory.WopiPendingApplication,o.logLevel.Info,"Received multiple wac complete or failure messages");this.wacAppCompleteOrFailReceived=!0,n.DiagnosticsHelper.assembleFromMessagePayload(e,this.appInitDiagnostics),this.fnOnWopiBootSuccess(this.innerApplicationFrame)},e.prototype.handleWacFailureMessage=function(e){if(this.wacAppCompleteOrFailReceived)return void this.logger.ULS.traceTag(596444235,o.logCategory.WopiPendingApplication,o.logLevel.Info,"Received multiple wac complete or failure messages");this.wacAppCompleteOrFailReceived=!0;var i={errorType:l.ApplicationErrors.WacFailed,errorObject:{}};e&&(i.errorObject=e.Error,this.sessionTraces.add("error",i)),this.fnOnWopiBootFailure(i)},e.prototype.timeoutWacAppCompleteOrFail=function(){this.wacAppCompleteOrFailReceived||this.logger.ULS.traceTag(596444236,o.logCategory.WopiPendingApplication,o.logLevel.Warning,"WopiPendingApplication.timeoutWacAppCompleteOrFail() sessionTraces:"+JSON.stringify(this.sessionTraces))},e.transformApplicationUrl=function(e,i,t){var o=e;o=o.replace("<ui=UI_LLCC&>",i.UiLocale?"ui="+i.UiLocale+"&":""),o=o.replace("<rs=DC_LLCC&>",i.DataLocale?"rs="+i.DataLocale+"&":""),o=o.replace("<hid=HOST_SESSION_ID&>",i.HostSessionId?"hid="+i.HostSessionId+"&":""),o=o.replace("<dchat=DISABLE_CHAT&>",i.DisableChat?"dchat=true&":"");var n=new RegExp(/<.*?>/g);if(o=o.replace(n,""),i&&i.WdParams)for(var r in i.WdParams)o=a.UrlUtils.addQueryParam(o,r,i.WdParams[r]);return t&&t.WopiSrc&&(o=a.UrlUtils.addQueryParam(o,"WOPISrc",encodeURIComponent(t.WopiSrc))),o},e.buildWacFramePostData=function(i){var t={};if(i.wopiInfo&&(t[r.OfficeFrameUtils.wacFrameAccessToken]=i.wopiInfo.AccessToken,t[r.OfficeFrameUtils.wacFrameAccessTokenTtl]=e.getAccessTokenTtl(i.wopiInfo)),i.wopiPrecheckInfo.BundleInfo&&i.wopiPrecheckInfo.BundleInfo.Url&&i.wopiPrecheckInfo.BundleInfo.Url.length>0&&(t[r.OfficeFrameUtils.wacFrameBundleSource]=void 0===i.bundleUrlPlaceholderReplaceWith?i.wopiPrecheckInfo.BundleInfo.Url:decodeURI(i.wopiPrecheckInfo.BundleInfo.Url).replace("{0}",i.bundleUrlPlaceholderReplaceWith)),i.wopiPrecheckInfo.FileGetUrl&&(t[r.OfficeFrameUtils.wacFrameFileGetUrl]=i.wopiPrecheckInfo.FileGetUrl),i.wopiPrecheckInfo.FileName){var o=i.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==o){var n=i.wopiPrecheckInfo.FileName.substring(o+1);n&&(t[r.OfficeFrameUtils.wacFrameFileExtension]=n)}}return i.sessionInformation.UserId&&(t[r.OfficeFrameUtils.wacFrameUserId]=i.sessionInformation.UserId),i.sessionInformation.OwnerId&&(t[r.OfficeFrameUtils.wacFrameOwnerId]=i.sessionInformation.OwnerId),i.diagnostics&&(t[r.OfficeFrameUtils.wacFrameHostDiagnostics]=JSON.stringify(i.diagnostics)),t},e.getAccessTokenTtl=function(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"},e.buildApplicationBootUrl=function(i,t){var o=t.required?t.applicationUrl:i.applicationUrl;return o=e.transformApplicationUrl(o,i.sessionInformation,i.wopiInfo),o=a.UrlUtils.addQueryParam(o,"jsApi","1"),o=a.UrlUtils.addQueryParam(o,"usid",i.sessionId),i.applicationCustomSettings&&i.applicationCustomSettings.IsCore&&(o=a.UrlUtils.addQueryParam(o,"core","1")),i.applicationCustomSettings&&i.applicationCustomSettings.FixDiagnosticsJson&&(o=a.UrlUtils.addQueryParam(o,"fixdiag","1")),i.wopiPrecheckInfo.ReadOnly&&(o=a.UrlUtils.addQueryParam(o,"readOnly","1")),t.required?(t.singleFlushFallback&&(o=a.UrlUtils.addQueryParam(o,"instantedit","1"),o=a.UrlUtils.addQueryParam(o,"wopicomplete","1")),o=a.UrlUtils.addQueryParam(o,"wdPreviousSession",i.sessionId),o=a.UrlUtils.addQueryParam(o,"wdRedirectionReason",t.reason)):(o=a.UrlUtils.addQueryParam(o,"instantedit","1"),o=a.UrlUtils.addQueryParam(o,"fileSrc",i.sessionInformation.HostName),o=a.UrlUtils.addQueryParam(o,"pmOrigin",encodeURI(a.UrlUtils.getOrigin(window.location.href))),e.isCreateNew(i)&&(o=a.UrlUtils.addQueryParam(o,"new","1"),i.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o=a.UrlUtils.addQueryParam(o,"wdTpl","fromhost")))),o},e.isCreateNew=function(e){return e.wopiPrecheckInfo.IsNewFile||"1"===a.UrlUtils.getParameterValue(e.applicationUrl,"new")},e}();i.WopiApplicationInitializer=c},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(3),n=t(2),a=t(0),r=t(7),s=t(1),l=t(8),c=t(4),p=t(17),g=function(){function e(e,i,t,o,n,a,r,s,p){var g=this;this.wacFrameIsLoaded=!1,this.initializeCompleted=!1,this.completeOrFailCalled=!1,this.parallelizeStartSession=!0,this.wacAcceptsStartSessionComplete=!1,this.wacAppSessionCompletionMessageAck=!1,this.appParams=e,this.wopiFallbackInfo=i,this.appInitDiagnostics=t,this.logger=o,this.postMessenger=n,this.visibilityMetrics=a,this.fnOnWopiBootSuccess=s,this.fnOnWopiBootFailure=p,this.sessionTraces=r,this.sessionTraces.add(c.SessionTraces.wopiPendingInitializeTime,Date.now()),this.setTimeout(function(){return g.timeoutCompleteOrFail()},l.OfficeFrameUtils.completeOrFailTimeoutInMs)}return e.prototype.Complete=function(e,i){if(this.completeOrFailCalled)return void this.logger.ULS.traceTag(596444184,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"Complete called after Complete/Fail already called");this.logger.ULS.traceTag(596444185,n.logCategory.WopiPendingApplication,n.logLevel.Info,"WopiPendingApplication.Complete() called."),this.completeOrFailCalled=!0,this.wopiInfo=e,this.sessionTraces.add(c.SessionTraces.wopiPendingCompleteTime,Date.now());try{this.wopiFallbackInfo.required?this.completeFallbackFlow():this.completeInstantFlow(i)}catch(e){this.logger.ULS.traceTag(596444186,n.logCategory.WopiPendingApplication,n.logLevel.Error,"WopiPendingApplication.Complete() unexpected script error: "+(e?JSON.stringify(e):"N/A"))}this.logger.ULS.flush()},e.prototype.Fail=function(e){if(this.completeOrFailCalled)return void this.logger.ULS.traceTag(596444187,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"Fail called after Complete/Fail already called");this.logger.ULS.traceTag(596444188,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"WopiPendingApplication.Fail() called. Reason: "+(e?JSON.stringify(e):"N/A")),this.completeOrFailCalled=!0,this.wopiFallbackInfo.required?this.failFallbackFlow():this.failInstantFlow(e),this.logger.ULS.flush()},e.prototype.Boot=function(){this.wopiFallbackInfo.required||this.bootInstantFlow(),this.logger.ULS.flush()},e.prototype.bootInstantFlow=function(){var e=this;this.logger.ULS.traceTag(596444231,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Initializing Office frame WITHOUT WOPI info available - first step of instant boot flow."),this.setTimeout(function(){return e.timeoutWacReadyMessage()},l.OfficeFrameUtils.wacReadyTimeoutInMs),this.populateWacFrameEventHandlersForInstantBoot();var i=new p.WopiApplicationInitializer(this.appParams,this.wopiFallbackInfo,this.appInitDiagnostics,this.sessionTraces,this.logger,this.postMessenger,this.visibilityMetrics,this.fnOnWopiBootSuccess,this.fnOnWopiBootFailure);this.innerApplicationFrame=i.Boot()},e.prototype.populateWacFrameEventHandlersForInstantBoot=function(){var e=this;this.postMessenger.RegisterMessagePayloadHandler(l.OfficeFrameUtils.fromWacFrameInitReady,function(i){e.handleWacReadyMessage(i)}),this.postMessenger.RegisterMessagePayloadHandler(l.OfficeFrameUtils.fromWacFrameInitFrameLoaded,function(i){e.handleWacFrameLoadedMessage(i)}),this.postMessenger.RegisterMessagePayloadHandler(l.OfficeFrameUtils.fromWacFrameSessionCompleteAck,function(i){e.handleWacFrameSessionCompleteAckMessage(i)})},e.prototype.completeInstantFlow=function(e){var i={ParallelizeStartSession:this.parallelizeStartSession,WacFrameIsLoaded:this.wacFrameIsLoaded,WacAcceptsStartSessionComplete:this.wacAcceptsStartSessionComplete};this.logger.ULS.traceTag(596444232,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Completing the Office initialized application WITH the WOPI info - second step of instant boot flow. Current app state - "+JSON.stringify(i)),this.updateBrowserHistoryForCreateNew(e),!this.parallelizeStartSession||this.wacFrameIsLoaded&&!this.wacAcceptsStartSessionComplete?this.wacFrameIsLoaded&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},e.prototype.completeFallbackFlow=function(){this.logger.ULS.traceTag(596444233,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Initializing Office frame WITH WOPI info available - single step of WOPI boot flow."),this.appParams.wopiInfo=this.wopiInfo;var e=new p.WopiApplicationInitializer(this.appParams,this.wopiFallbackInfo,this.appInitDiagnostics,this.sessionTraces,this.logger,this.postMessenger,this.visibilityMetrics,this.fnOnWopiBootSuccess,this.fnOnWopiBootFailure);this.innerApplicationFrame=e.Boot()},e.prototype.failInstantFlow=function(e){this.logger.ULS.traceTag(596444189,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(l.OfficeFrameUtils.toWacFrameFailSession,e)},e.prototype.failFallbackFlow=function(){this.logger.ULS.traceTag(596444190,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"Fail called during Fallback Boot, calling host failure callback..."),this.fnOnWopiBootFailure({errorType:o.ApplicationErrors.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},e.prototype.setTimeout=function(e,i){window.setTimeout(function(){return e()},i)},e.prototype.timeoutWacReadyMessage=function(){this.wacFrameIsLoaded||(this.logger.ULS.traceTag(596444191,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"WopiPendingApplication.timeoutWacReadyMessage()"),this.fnOnWopiBootFailure({errorType:o.ApplicationErrors.TimeoutWacReady,errorObject:void 0}))},e.prototype.timeoutCompleteOrFail=function(){this.completeOrFailCalled||(this.logger.ULS.traceTag(596444192,n.logCategory.WopiPendingApplication,n.logLevel.Warning,"WopiPendingApplication.timeoutCompleteOrFail() sessionTraces:"+this.sessionTraces.stringify()),this.sessionTraces.add("timeoutCompleteOrFail",Date.now()))},e.prototype.timeoutWacSessionCompletionMessageAck=function(e,i,t){this.wacAppSessionCompletionMessageAck||(this.logger.ULS.traceTag(596444193,n.logCategory.WopiPendingApplication,n.logLevel.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(e,i,t+1))},e.prototype.handleWacReadyMessage=function(e){if(this.sessionTraces.add(c.SessionTraces.readyMessageReceiveTime,Date.now()),this.sendWacPostMessage(l.OfficeFrameUtils.toWacFrameInitReadyAck,{}),this.wacFrameIsLoaded)return void this.logger.ULS.traceTag(596444194,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Received multiple ready messages - frame is already loaded.");this.wacFrameIsLoaded=!0,this.wacAcceptsStartSessionComplete=e&&e.CanAcceptStartSessionComplete;var i={AcceptStartSessionComplete:this.wacAcceptsStartSessionComplete,ParallelizeStartSession:this.parallelizeStartSession,StartSessionResponse:null!=this.startSessionResponse,WopiInfo:null!=this.wopiInfo};this.logger.ULS.traceTag(596444195,n.logCategory.WopiPendingApplication,n.logLevel.Info,"HandleWacReadyMessage - "+JSON.stringify(i)),this.parallelizeStartSession&&this.wacAcceptsStartSessionComplete?this.startSessionResponse&&this.startSessionCompleted():this.wopiInfo&&this.sendWopiInfoToWacFrame(),r.DiagnosticsHelper.assembleFromMessagePayload(e,this.appInitDiagnostics)},e.prototype.handleWacFrameLoadedMessage=function(e){r.DiagnosticsHelper.assembleFromMessagePayload(e,this.appInitDiagnostics)},e.prototype.handleWacFrameSessionCompleteAckMessage=function(e){this.wacAppSessionCompletionMessageAck=!0,this.sessionTraces.add("sessionCompleteAckReceivedTime",Date.now())},e.prototype.sendWacPostMessage=function(e,i){this.postMessenger.SendPostMessage(this.innerApplicationFrame.contentWindow,e,i)},e.prototype.sendSessionCompletionMessageWithRetry=function(e,i){this.sendSessionCompletionMessageWithRetryHelper(e,i,1)},e.prototype.sendSessionCompletionMessageWithRetryHelper=function(e,i,t){var o=this;if(t>l.OfficeFrameUtils.postMessageMaxRetries)return void this.logger.ULS.traceTag(596444224,n.logCategory.WopiPendingApplication,n.logLevel.Error,"Attempted to call complete, but received no ack from the frame. Time: "+Date.now());this.logger.ULS.traceTag(596444225,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Sending completion message to frame. Attempt number: "+t+", Time: "+Date.now());var a=Date.now();1===t&&(this.startSessionResponse.Diagnostics.completeMessageCreateTime=a,this.sessionTraces.add(c.SessionTraces.completeMessageCreateTime,a)),i.Diagnostics.completeMessageSendTime=a,this.sessionTraces.add(c.SessionTraces.completeMessageSendTime,a),this.sendWacPostMessage(e,i),this.setTimeout(function(){return o.timeoutWacSessionCompletionMessageAck(e,i,t)},l.OfficeFrameUtils.wacSessionCompleteAckTimeoutInMs)},e.prototype.makeStartSessionRequest=function(){var i=this;this.logger.ULS.traceTag(596444226,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Making parallelized startSession request.");var t=this.buildStartSessionUrl(this.wopiInfo),o={};o["X-xhr"]="1",o["X-UserSessionId"]=this.appParams.sessionId,o["X-OfficeVersion"]=a.BuildVersionConfig.BUILD_NUMBER,o["Content-Type"]="application/json; charset=utf-8",o["X-AccessToken"]=this.wopiInfo.AccessToken,o["X-AccessTokenTtl"]=p.WopiApplicationInitializer.getAccessTokenTtl(this.wopiInfo),o["X-UserType"]="WOPI",o["X-Requested-With"]="XMLHttpRequest",this.sessionTraces.add(c.SessionTraces.startSessionStartTime,Date.now()),e.makeXhrRequest(t,"",o,function(e){return i.onStartSessionRequestCompleted(e)})},e.prototype.onStartSessionRequestCompleted=function(e){if(this.sessionTraces.add(c.SessionTraces.startSessionCompleteTime,Date.now()),this.sessionTraces.add("startSessionResponseStatus",e.status),this.startSessionResponse={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:this.sessionTraces.get(c.SessionTraces.wopiPendingInitializeTime),wopiPendingCompleteTime:this.sessionTraces.get(c.SessionTraces.wopiPendingCompleteTime),startSessionStartTime:this.sessionTraces.get(c.SessionTraces.startSessionStartTime),startSessionCompleteTime:this.sessionTraces.get(c.SessionTraces.startSessionCompleteTime),readyMessageReceiveTime:this.sessionTraces.get(c.SessionTraces.readyMessageReceiveTime)}},this.logger.ULS.traceTag(596444227,n.logCategory.WopiPendingApplication,n.logLevel.Info,"StartSession request completed with status code: "+this.startSessionResponse.StartSessionResponse.RequestStatus+", Time: "+Date.now()),this.wacFrameIsLoaded&&this.wacAcceptsStartSessionComplete)return void this.startSessionCompleted();var i={WacFrameIsLoaded:this.wacFrameIsLoaded,InitializeCompleted:this.initializeCompleted};this.logger.ULS.traceTag(596444228,n.logCategory.WopiPendingApplication,n.logLevel.Info,"StartSessionCompleted not called - "+JSON.stringify(i))},e.prototype.sendWopiInfoToWacFrame=function(){if(!this.initializeCompleted){this.initializeCompleted=!0,this.logger.ULS.traceTag(596444229,n.logCategory.WopiPendingApplication,n.logLevel.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:this.wopiInfo.WopiSrc,AccessToken:this.wopiInfo.AccessToken,AccessTokenTtl:p.WopiApplicationInitializer.getAccessTokenTtl(this.wopiInfo)},Diagnostics:{wopiPendingInitializeTime:this.sessionTraces.get(c.SessionTraces.wopiPendingInitializeTime),wopiPendingCompleteTime:this.sessionTraces.get(c.SessionTraces.wopiPendingCompleteTime),readyMessageReceiveTime:this.sessionTraces.get(c.SessionTraces.readyMessageReceiveTime)}};this.sendSessionCompletionMessageWithRetry(l.OfficeFrameUtils.toWacFramePendingSessionComplete,e)}},e.prototype.startSessionCompleted=function(){if(200!==this.startSessionResponse.StartSessionResponse.RequestStatus)return void this.sendWopiInfoToWacFrame();this.initializeCompleted||(this.initializeCompleted=!0,this.sendSessionCompletionMessageWithRetry(l.OfficeFrameUtils.toWacFrameStartSessionComplete,this.startSessionResponse))},e.prototype.buildStartSessionUrl=function(i){var t=this.appParams.applicationBaseUrl+e.wordEditorStartSessionName,o=p.WopiApplicationInitializer.buildApplicationBootUrl(this.appParams,this.wopiFallbackInfo);return t+="?"+o.substring(o.indexOf("?")+1),t=s.UrlUtils.addQueryParam(t,"WOPISrc",encodeURIComponent(i.WopiSrc)),this.appParams.wopiPrecheckInfo.FileGetUrl&&(t=s.UrlUtils.addQueryParam(t,"fileGetUrlPresent","1")),t},e.prototype.updateBrowserHistoryForCreateNew=function(e){if(p.WopiApplicationInitializer.isCreateNew(this.appParams)){if(!e||!e.NewFilePath)return void this.logger.ULS.traceTag(596444230,n.logCategory.WopiPendingApplication,n.logLevel.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},e.makeXhrRequest=function(e,i,t,o){var n=new XMLHttpRequest,a=i||"";n.onreadystatechange=function(){if(n&&4===n.readyState){if(void 0===n.status||0===n.status)return;try{o&&o(n)}finally{null!=n&&(n.onreadystatechange=function(){})}}},n.open("Post",e,!0);for(var r in t)n.setRequestHeader(r,t[r]);n.send(a)},e.wordEditorStartSessionName="wordeditorstartsession.ashx",e}();i.WopiPendingApplicationInitializer=g},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(10),n=t(9);i.Application=new o.ApplicationBootstrapper(n.ApplicationFactory,{forceFallback:!0,bundleUrlPlaceholderReplaceWith:void 0})},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t(6),n=t(22),a=t(21),r=function(){function e(i,t){var o=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){o.triggerUpload(!1,!1)},this.flush=function(){o.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout(function(){return o.triggerUpload(!0,!0)},0)},this.triggerUpload=function(i,t){if(window.clearTimeout(o.timeoutId),o.logCache.length>0){o.uploadId+=1;var r=a.formatForUpload(o.logCache,o.userSessionId,o.uploadId,o.timestampBase);n.uploadLogs(r,o.remoteUrlEndpoint,t),o.logCache=[],o.timestampBase=Date.now()}i&&(o.timeoutId=window.setTimeout(o.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=i,this.remoteUrlEndpoint=t+"?usid="+i,window.setTimeout(function(){return o.triggerUpload(!0,!0)},0)}return e.prototype.handleTrace=function(i){i.message.length>e.messageMaxChars&&(i.message=i.message.substr(0,e.messageMaxChars-e.trimedMessage.length)+e.trimedMessage),this.logCache.push(i),(this.logCache.length>e.uploadTriggerSize||i.level===o.logLevel.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimedMessage="... [Trimmed]",e}();i.bUlsCache=r},function(e,i,t){"use strict";function o(e,i,t,o){var r=e.map(function(e){return n(e,o)}),s=a(o,r,i,t);return JSON.stringify(s)}function n(e,i){var t={};t.G=e.tag,t.T=e.timestamp-i,t.M=e.message,t.C=e.category;var o=e.type*r+e.level;return t.D=o,t}function a(e,i,t,o){var n={};return n.T=e,n.L=i,n.S=t,n.I=o,n.V=1,n}Object.defineProperty(i,"__esModule",{value:!0}),i.formatForUpload=o;var r=1e3},function(e,i,t){"use strict";function o(e,i,t){if(""!==i){var o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",i,t),o.send(e))}}Object.defineProperty(i,"__esModule",{value:!0}),i.uploadLogs=o},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(i.logType||(i.logType={}))}]);
